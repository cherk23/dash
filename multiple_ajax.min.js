/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
$.multipleAjax=function(e,r){r=$.extend({numRetries:0,maxSimultaneous:4},r);for(var i=0,o=0,u=[],n=e.length,a=!1,f=$.Deferred(),t=r.maxSimultaneous,s=[],c=_.map(e,function(e){return _.extend(e,{numRetries:0})}),m=0;m<r.maxSimultaneous;m++)!function e(t){if(!t||a)return l();_.each(["error","complete"],function(e){var n;t[e]&&(n=t[e],t[e]=function(){a||n.apply(this,arguments)})});var n=_.uniqueId();s[n]=$.ajax(_.omit(t,"numRetries")).done(function(){i++}).fail(function(e){if(e&&e.responseText)try{var n=JSON.parse(e.responseText);u=(u=u.concat(n.error)).concat(n.errors),u=_.compact(u)}catch(e){}if(++t.numRetries>r.numRetries)return o++;c.push(t)}).always(function(){delete s[n],a||f.notify(p()),e(c.shift())})}(c.shift());function l(){0==--t&&(0===o?f.resolve(p()):f.reject(p()))}function p(){return{done:i,failed:o,remaining:n-i-o,errors:u}}return f.promise({abort:function(){a=!0;for(var e=s.shift();e;e=s.shift())e.abort()}})};