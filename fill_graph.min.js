/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(e,h){function a(t,i,a,o){var r,e,s=t.data,n=s.data,x=o.width();i.x=(i.pageX-o.offset().left-2)/x*(s.t1-s.t0)+s.t0,0!==n.length&&(n.length,s.magnetic_hover&&0<s.priority.length&&(s.fuzz=2.5*(s.t1-s.t0)/x,void 0!==(e=function(t,a,o){t=h.chain(t).map(function(t,i){return t.slice(0,2).concat([i,h.indexOf(o.priority,t[1]),Math.abs(t[0]-a)])}).filter(function(t){return t[4]<=o.fuzz}).sortBy(function(t){return t[3]}).value(),t=h.find(t,function(t){return-1!==t[3]})||h.chain(t).sortBy(function(t){return t[4]}).first().value();if(t)return t[2]}(n,i.x,s))&&(r=n[e],e++)),void 0===r&&void 0===(r=n[(e=h.sortedIndex(n,[i.x],function(t){return t[0]}))-1])||(t=r[0],i=e==n.length?s.t1:n[e][0],e<=1&&n[0][1]==s.default_state&&(t=s.t0,i=h.contains([0,1],n.length)?s.t1:n[1][0]),e=((Math.min(i,s.t1)+Math.max(t,s.t0))/2-s.t0)/(s.t1-s.t0)*x,n=o.getPlaceholder(),x=o.getPlotOffset(),(o=h.clone(n.offset())).left+=e+x.left,s.hover.call(n,{item:r,start:t,end:i,midpoint:e,offset:x,page_center:o,range_text:unparse_date(t,"%b %-d %H:%M",1)+" &ndash; "+unparse_date(i,"%b %-d %H:%M",1)})))}e(document).on("mouseout",".fill-graph",function(){e(this).hohelp()}),e.fn.fill_graph=function(r){if(0===this.length)return this;if(r.check_visibility&&!this.is(":visible"))return this;this.addClass("fill-graph"),h.defaults(r,{color_map:{0:"white",1:"green",2:"red"},default_state:0,hover:null,combine_colors:!0,combine_statuses:!0,check_visibility:!0,priority:[],magnetic_hover:!0,width:this.width(),height:this.height()}),r.combine_statuses&&(r.data=h.filter(r.data,function(t,i){return 0===i||t[1]!==r.data[i-1][1]})),this.css("position","relative"),h.each(r.color_map,function(t,i){var a=t.match(/^var\(\s*(--[a-zA-Z_][\w-]*)\s*(?:,\s*[^)]+)?\)$/);if(a){const o=getComputedStyle(document.body);a=o.getPropertyValue(a[1]).trim();r.color_map[i]=a}else r.color_map[i]=e.color.parse(t).toString()});var i,t=FillGraph.resize_careas(FillGraph.compute_careas(r),r);return r.background?(i=r,{coloredAreas:h.chain(t).filter(function(t){return h.contains(i.priority,t.status)}).map(function(t){return{color:e.color.parse(t.color).scale("a",.25).toString(),x1:t.xaxis.from,x2:t.xaxis.to}}).value()}):(r.hover&&this.on("plothover",r,a),function(t,i,a){var o=a.t0,r=a.t1,i={targetWidth:a.width,targetHeight:a.height,xaxis:h.extend({min:o,max:r,partialGrid:!0},a.xaxis),yaxis:h.extend({ticks:[],min:0,max:1},a.yaxis),grid:h.extend({markings:i,tickColor:"rgba(0,0,0,0.4)",backgroundColor:"rgba(255,255,255,1)",markingsLineWidth:1,markingsColor:"rgba(0,0,0, 0.2)",hoverable:!!a.hover,borderWidth:a.borderWidth},a.grid)};a.show_axis&&h.extend(i.xaxis,{show:!0,tickSize:mkigraph.time_ticksize(o,r,t),mode:"time",timezone:Mkiconf.tz_name||"browser",used:!0},a.xaxis);a=e(t);if(0<a.height()&&0<a.width())return e.plot(t,[],i)}(this,t,r))},window.FillGraph={},FillGraph.compute_careas=function(t){for(var i,a=t.t0,o=t.t1,r=t.data,e=[a,t.default_state],s=[],n=r.length,x=0;x<n&&r[x][0]<=a;x++)e=r[x];for(;x<n&&r[x][0]<=o;x++)i=r[x],t.combine_colors&&t.color_map[e[1]]==t.color_map[i[1]]||(s.push({xaxis:{from:e[0],to:i[0]},status:e[1],color:t.color_map[e[1]]}),e=i);return s.push({xaxis:{from:e[0],to:o},status:e[1],color:t.color_map[e[1]]}),s},FillGraph.resize_careas=function(t,i){var a,o=i.t0,r=i.t1,e=i.width,s=Math.ceil((r-o)/e),n=i.priority,x=t.length,l=[],u=[];if(h.isEmpty(n))return t;function c(t){var i,a,o=h.last(l),r=function(){var t=h.groupBy(u,function(t){return h.indexOf(n,t.status)}),i=h.chain(t).keys().without(-1).value();{if(0<i.length){var a=h.min(i),i=h.first(t[a]),a=h.last(t[a]);return{xaxis:{from:i.xaxis.from,to:a.xaxis.to},status:a.status,color:a.color}}return null}}();r&&(i=h.indexOf(n,r.status),a=h.indexOf(n,t.status),-1!==i&&(-1===a||i<a))&&t.xaxis.to-r.xaxis.from>=s&&(o.status===r.status?o.xaxis.to=Math.max(o.xaxis.from+s,r.xaxis.to):(o.xaxis.to=Math.max(o.xaxis.to,r.xaxis.from),o={xaxis:{from:o.xaxis.to,to:Math.max(r.xaxis.to,o.xaxis.to+s)},status:r.status,color:r.color},l.push(o)),u=[]),t.xaxis.to-o.xaxis.to>=2*s?(o.status===t.status?o.xaxis.to=Math.max(o.xaxis.from+s,t.xaxis.to):(o.xaxis.to=Math.max(o.xaxis.to,t.xaxis.from),o={xaxis:{from:o.xaxis.to,to:t.xaxis.to},status:t.status,color:t.color},l.push(o)),u=[]):h.contains(n,t.status)&&u.push(t)}for(l=[t[0]],a=1;a<x;a++)c(t[a]);return l}}(jQuery,_);