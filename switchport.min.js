/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(n){window.switchport={};function i(t){return"rootguard"===t?" - Root guard":"bpduguard"===t?" - BPDU guard":"loopguard"===t?" - Loop guard":""}function s(t){if("string"!=typeof t)return{port_num:String(t)};var r=t.split("/").reverse(),t={port_num:r[0]};return 0<r.length&&(t.module_type=r[1]),1<r.length?t.slot=r[2]:0<r.length&&(t.slot="1"),t}function e(t){switch(t){case switchport.STATUS_FLAGS.SPEED_10:return"10 Mbps";case switchport.STATUS_FLAGS.SPEED_100:return"100 Mbps";case switchport.STATUS_FLAGS.SPEED_1000:return"1 Gbps";case switchport.STATUS_FLAGS.SPEED_2500:return"2.5 Gbps";case switchport.STATUS_FLAGS.SPEED_5000:return"5 Gbps";case switchport.STATUS_FLAGS.SPEED_10000:return"10 Gbps";case switchport.STATUS_FLAGS.SPEED_25000:return"25 Gbps"}}function r(t){if("auto"===t)return"Auto negotiate";var r=t.match(/(\d+(?:\.\d+)?)(G|M)(fdx|hdx)/);return r?r[1]+" "+("G"===r[2]?"Gi":"Me")+"gabit "+("fdx"===r[3]?"full":"half")+" duplex":(r=t.match(/(\d+)(G|M)-auto/))[1]+" "+("G"===r[2]?"Gi":"Me")+"gabit"}function o(t){var r=e(7&t);return!r||t&switchport.STATUS_FLAGS.FULL_DUPLEX||(r+=" - half duplex"),r}function c(t,r,i){var s=t["live_"+r],e={total:0,sent:0,recv:0};if(!(s&&1<s.length))return e;var n=s[0],t=s[s.length-1];if(!n||!t)return e;r=t[0]-n[0],s=t[1]-n[1],n=t[2]-n[2];if(!s&&!n)return e;if("bps"===i&&(s*=8,n*=8),!i)return{total:parseInt((s+n)/r),sent:parseInt(s/r),recv:parseInt(n/r)};e=parseInt((s+n)/r),s=parseInt(s/r),r=parseInt(n/r);return{total:e=0<e?unparse_size(e,!0,i):"-",sent:s=0<s?unparse_size(s,!0,i):"-",recv:r=0<r?unparse_size(r,!0,i):"-"}}switchport.STATUS_FLAGS={SPEED_10:1,SPEED_100:2,SPEED_1000:3,SPEED_2500:4,SPEED_5000:5,SPEED_10000:6,SPEED_12000:7,SPEED_25000:10,FULL_DUPLEX:16,SPEED_DOWNSHIFT:256,USING_SFP:1024,POE_OVERLOAD:262144,POE_UNDERLOAD:524288,POE_DENIED:1048576,LACP_DISABLED:2097152,AP_NOAUTH:4194304,GUEST_ENABLED:8388608},switchport.STP_FLAGS={STP_STATE_LEARNING:1,STP_STATE_FORWARDING:2,STP_STATE_DISCARDING:4,STP_VERSION_LEGACY_STP:8,STP_IS_EDGE:16,STP_IS_PTP:32,STP_ROOTGUARD_ACTIVE:64,STP_BPDUGUARD_ACTIVE:128,STP_LOOPGUARD_ACTIVE:256},switchport.MODULE_TYPE_TO_NAME={"MA-MOD-4X10G":"4x10G","MA-MOD-8X10G":"8x10G","MA-MOD-2X40G":"2x40G","MA-MOD2-4X10G":"4X10G","MA-MOD2-4X1G":"4X1G","C9200-NM-2Q":"NM-2Q","C9200-NM-2Y":"NM-2Y","C9200-NM-4G":"NM-4G","C9200-NM-4X":"NM-4X","C9300-NM-2Q":"NM-2Q","C9300-NM-2Y":"NM-2Y","C9300-NM-4G":"NM-4G","C9300-NM-4M":"NM-4M","C9300-NM-8X":"NM-8X","C9300X-NM-2C":"NM-2C","C9300X-NM-4C":"NM-4C","C9300X-NM-8M":"NM-8M","C9300X-NM-8Y":"NM-8Y","C3850-NM-4-10G":"NM-4-10G","C3850-NM-2-40G":"NM-2-40G","C3850-NM-8-10G":"NM-8-10G","C9500-NM-8X":"NM-8X","C9500-NM-2Q":"NM-2Q","C9350-NM-2C":"C9350-NM-2C","C9350-NM-8Y":"C9350-NM-8Y","C9350-NM-4C":"C9350-NM-4C","IEM-3500-8T":"IEM-3500-8T","IEM-3500-8P":"IEM-3500-8P","IEM-3500-8S":"IEM-3500-8S","IEM-3500-6T2S":"IEM-3500-6T2S","IEM-3500-16T":"IEM-3500-16T","IEM-3500-16P":"IEM-3500-16P","IEM-3500-14T2S":"IEM-3500-14T2S","IEM-3500-4MU":"IEM-3500-4MU",DEFAULT:"DEFAULT"},switchport.is_lacp_disabled=function(){return!!(this.curr_status&switchport.STATUS_FLAGS.LACP_DISABLED)},switchport.is_connected=function(){return!!(15&this.curr_status)},switchport.is_below_gigabit=function(){return!!(this.is_connected()&&(7&this.curr_status)<=switchport.STATUS_FLAGS.SPEED_100)},switchport.error=function(){return!!(this.curr_status&switchport.STATUS_FLAGS.POE_OVERLOAD||this.curr_status&switchport.STATUS_FLAGS.POE_DENIED)||!!this.is_connected()&&(!!(this.stp_flags&switchport.STP_FLAGS.STP_STATE_DISCARDING||this.curr_status&switchport.STATUS_FLAGS.SPEED_DOWNSHIFT||this.curr_status&switchport.STATUS_FLAGS.FULL_DUPLEX&&this.curr_status&switchport.STATUS_FLAGS.LACP_DISABLED||this.curr_status&switchport.STATUS_FLAGS.AP_NOAUTH)||void 0)},switchport.switchport_error_text=function(){return this.stp_flags&&this.stp_flags&switchport.STP_FLAGS.STP_STATE_DISCARDING?"STP discarding packets from this port":this.curr_status&switchport.STATUS_FLAGS.SPEED_DOWNSHIFT?"Connected<br/>1 Gigabit link failed, speed downshifted":this.curr_status&switchport.STATUS_FLAGS.POE_OVERLOAD?"PoE Overload":this.curr_status&switchport.STATUS_FLAGS.POE_DENIED?"PoE port was denied power":this.curr_status&switchport.STATUS_FLAGS.AP_NOAUTH?"Port not forwarding traffic<br/>due to access policy":this.curr_status&switchport.STATUS_FLAGS.FULL_DUPLEX&&this.curr_status&switchport.STATUS_FLAGS.LACP_DISABLED?"Port running LACP and LACP has disabled this port":void log_error("Undefined switch port error status",{file:"switchport.js"})},switchport.is_sfp=function(){return!!(this.curr_status&switchport.STATUS_FLAGS.USING_SFP)},switchport.render_name=function(t){return _.compact([this.name,t&&this.is_uplink&&"uplink"]).join(" - ")},switchport.render_configured_stp=function(){return this.use_stp?"Enabled"+i(this.stp_guard):"Disabled"},switchport.render_stp_state=function(){if(!this.has_stp||!this.use_stp)return"Disabled";if(this.stp_flags){var t=[],r=this.stp_flags&switchport.STP_FLAGS.STP_STATE_LEARNING?"Learning":this.stp_flags&switchport.STP_FLAGS.STP_STATE_FORWARDING?"Forwarding":this.stp_flags&switchport.STP_FLAGS.STP_STATE_DISCARDING?this.stp_flags&switchport.STP_FLAGS.STP_ROOTGUARD_ACTIVE?"Blocking - Root guard activated":this.stp_flags&switchport.STP_FLAGS.STP_BPDUGUARD_ACTIVE?"Blocking - BPDU guard activated":this.stp_flags&switchport.STP_FLAGS.STP_LOOPGUARD_ACTIVE?"Blocking - Loop guard activated":"Blocking":"Enabled";return this.stp_flags&switchport.STP_FLAGS.STP_VERSION_LEGACY_STP&&t.push("Client is using legacy STP"),0<t.length&&(r+=dimtext(" ("+t.join(", ")+")")),r}return"Enabled"+i(this.stp_guard)},switchport.sort_current_traffic=function(){return c(this,"bytes").total},switchport.render_port_schedule=function(){if(this.schedule)return this.schedule+(this.scheduled_outage?dimtext(" (currently down)"):"")},switchport.render_current_traffic=function(t){var r=c(this,"bytes","bps");return r.sent||r.recv?t?r.total+dimtext(" ("+r.sent+" sent, "+r.recv+" received)"):r.total+dimtext(" ("+r.sent+" ↓, "+r.recv+" ↑)"):"-"},switchport.render_packet_rate=function(t){t=c(this,t,"pkts/s");return"-"!==t.sent&&0!==t.sent||"-"!==t.recv&&0!==t.recv?t.total+dimtext(" ("+t.sent+" ↓, "+t.recv+" ↑)"):"-"},switchport.render_lldp_info=function(r){if(!this.lldp_infos)return r?void 0:"-";var s=this.lldp_infos,e=this.lldp_infos,n=[];return _.each(_.keys(this.lldp_infos),function(t){n.push(t.replace(/:/g,""))}),_.each(_.keys(this.lldp_infos),function(t){var r=e[t];if(r&&r.cdp)for(var i in r.cdp.opts)"Device id"==r.cdp.opts[i][0]&&(i=r.cdp.opts[i][1]+"",_.contains(n,i)&&(s=_.omit(e,t)))}),this.lldp_infos=s,render_array($j.map(this.lldp_infos,function(t){return render_lldp_device(t,r)}))},switchport.searchable_lldp=function(r){return this.lldp_infos&&n.map(this.lldp_infos,function(t){return render_lldp_device(t,r)}).join(" ")},switchport.sort_lldp_info=function(){return n.map(this.lldp_infos||{},function(t){return t})},switchport.render_link_negotiation=function(){if(this.is_dedicated_stack_port)return"-";var t=r(this.link_negotiation);return this.link_negotiation.match(/auto$/)&&7&this.curr_status&&("auto"===this.link_negotiation?t+=" ("+dimtext(o(this.curr_status))+")":this.curr_status&switchport.STATUS_FLAGS.FULL_DUPLEX||(t+=" - half duplex")),t},switchport.sort_link_negotiation=function(){return this.link_negotiation+(23&(this.curr_status||0))},switchport.filter_link_negotiation=function(){return r(this.link_negotiation)+" ("+o(this.curr_status)+")"},switchport.link_speed_mbps=function(){switch(7&this.curr_status){case switchport.STATUS_FLAGS.SPEED_10:return 10;case switchport.STATUS_FLAGS.SPEED_100:return 100;case switchport.STATUS_FLAGS.SPEED_1000:return 1e3;case switchport.STATUS_FLAGS.SPEED_2500:return 2500;case switchport.STATUS_FLAGS.SPEED_5000:return 5e3;case switchport.STATUS_FLAGS.SPEED_10000:return 1e4;case switchport.STATUS_FLAGS.SPEED_25000:return 25e3;default:return 0}},switchport.guest_enabled=function(){return this.curr_status&switchport.STATUS_FLAGS.GUEST_ENABLED},switchport.render_profile_ports_link=function(t){if(t.profile){var r=url_for({controller:"configure",action:"switchports",anchor:{q:"profile:"+t.profile}});return link_to(r,t.profile)}return""},switchport.render_local_overrides=function(t){var r=t.local_overrides;if(_.any(r)){if(r.length<=2)return"<div>"+r.join("</div><div>")+"</div>";for(var s="&lt;&lt; hide",t=r.length-2,i="",e=0;e<2;e++)i+="<div>"+r[e]+"</div>";for(i+="<div class='hidden_values' num='"+t+"'>",e=2;e<r.length;e++)i+="<div>"+r[e]+"</div>";return i+="</div>",i+="<div>&nbsp;&nbsp;<span class='value_column_toggle_link'>"+(t+" more &gt;&gt;")+"</span></div>",n(".SwitchportsTable").off("click","span.value_column_toggle_link").on("click","span.value_column_toggle_link",function(t){var r=n(this).parent().siblings("div.hidden_values"),i=n(this).html()===s;return r.toggle(),i?n(this).html(r.attr("num")+" more &gt;&gt;"):n(this).html(s),!1}),i}return""},switchport.link_to_switchport=function(t,r,i){return link_to((i=i||r,url_for({controller:"nodes",action:"new_list",id:t})+"/"+switchport.child_path_from_port_identifier(i)),function(t){if("AGGR"===t.split("/")[0])return t;var r=s(t),t="";r.module_type&&(t=switchport.MODULE_TYPE_TO_NAME[r.module_type]+" / ");return t+r.port_num}(r))},switchport.child_path_from_port_identifier=function(t){t=s(t);return(t.module_type?"modules/"+t.module_type+"/":"")+"ports/"+t.port_num},switchport.human_readable_link_speed=o,switchport.human_readable_aggr_link_speed=function(t,r){var i=e(7&t);return!(i=i.split(" ")[0]*r+" "+i.split(" ")[1])||t&switchport.STATUS_FLAGS.FULL_DUPLEX||(i+=" - half duplex"),i},switchport.calc_packet_rate=c}(jQuery);