/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(r){window.events_list3={};var a={},n={},o={admin:{ad_auth:["group","user"],association:["channel","band","rssi"],channel_scan:["channel","clients","active"],radius_mac_auth:["resp"],splash_auth:["duration"],wpa_auth:[]},non_admin:{stack_cable_state:["switch_mac","port","old","new"],stackpower_cable_state:["switch_mac","port","old","new"]}};function d(e,t,a,n){if("string"!=typeof e&&(e=c(e)),0==_.size(t))return e;if(a&&!Mkiconf.is_acting_admin)return e;var i=a?"adminhighlight":"",a="&nbsp;&nbsp;<span class='"+i+"'><a href='#' class='event_detail_more'>more &#187;</a></span>",s="<table class='event_detail_table "+i+"'>";return r.each(t,function(e,t){t=n?_.escape(t):t;s+="<tr><td class='first'>"+_.escape(e)+"</td><td>"+t+"</td></tr>"}),e+a+(s+="</table>")}function l(e,t,a){return"string"!=typeof e&&(e=c(e)),0==_.size(t)||a&&Mkiconf.is_acting_admin,e}function c(e){var a=[];return r.each(e,function(e,t){a.push(_.escape(e)+": "+_.escape(t))}),a.join(", ")}function i(e,t){var a=e.el_type,n=Object.entries(e.details),i=o.admin.hasOwnProperty(a),e=i||o.non_admin.hasOwnProperty(a),s=i?"admin":"non_admin",r=e?Object.fromEntries(n.filter(function(e){return o[s][a].includes(e[0])})):Object.fromEntries(n.slice(0,3)),n=n.filter(function(e){return!r.hasOwnProperty(e[0])});return 1!==n.length||e||((e=Object.entries(r)).push(n.pop()),r=Object.fromEntries(e)),t?l(r,Object.fromEntries(n),i):d(r,Object.fromEntries(n),i,!0)}events_list3.toggle_details=function(){var e=r(this).parent().next(".event_detail_table").toggle().is(":visible");return r(this).html(e?"&#171; hide":"more &#187;"),!1};var s={0:"unknown reason "+dashhelp.icon("auto_hohelp disassoc_unknown_reason"),1:"unspecified reason",2:"previous authentication expired",3:"client was deauthenticated",4:"client association expired",5:"AP has too many associations",6:"client not authenticated",7:"client not associated",8:"client has left AP",9:"client requesting association is not authenticated",10:"power capability not valid",11:"supported channel not valid",15:"client association expired",23:"802.1x auth failed",34:"client not responding",53:"invalid pmkid",54:"invalid mdie"},u={1:"disassociated due to DHCP failure",2:"disassociated due to EAP timeout",3:"disassociated due to 802.1X failure",4:"disassociated because device was idle",5:"disassociated due to captive portal security failure",6:"disassociated due to decryption failure",7:"disassociated because client interface was disabled",8:"user triggered disassociation",9:"miscellaneous reason",10:"unknown reason",11:"peer triggered disassociation",12:"disassociated due to beacon loss"};a.disassociation=function(e){var t={},a=parseFloat(e.time_f)-parseFloat(e.details.duration);return e.details.arp_resp&&(t.arp_response=unparse_date(a+parseFloat(e.details.arp_resp),"%b %d %H:%M:%S")),e.details.dhcp_resp&&(t.dhcp_response=unparse_date(a+parseFloat(e.details.dhcp_resp),"%b %d %H:%M:%S")),e.details.dns_resp&&(t.dns_response=unparse_date(a+parseFloat(e.details.dns_resp),"%b %d %H:%M:%S")),e.details.ip_resp&&(t.ip_response=unparse_date(a+parseFloat(e.details.ip_resp),"%b %d %H:%M:%S")),a=s[e.details.reason]||"802.11_reason_code = "+e.details.reason,d(a=8===Number(e.details.reason)?u[e.details.apple_da_reason]||a:a,t,!0,!0)},n.disassociation=function(e){var t={},a=parseFloat(e.time_f)-parseFloat(e.details.duration);return e.details.arp_resp&&(t.arp_response=unparse_date(a+parseFloat(e.details.arp_resp),"%b %d %H:%M:%S")),e.details.dhcp_resp&&(t.dhcp_response=unparse_date(a+parseFloat(e.details.dhcp_resp),"%b %d %H:%M:%S")),e.details.dns_resp&&(t.dns_response=unparse_date(a+parseFloat(e.details.dns_resp),"%b %d %H:%M:%S")),e.details.ip_resp&&(t.ip_response=unparse_date(a+parseFloat(e.details.ip_resp),"%b %d %H:%M:%S")),a=s[e.details.reason]||"802.11_reason_code = "+e.details.reason,l(a=8===Number(e.details.reason)?u[e.details.apple_da_reason]||a:a,t,!0)};var f=["Tx power reduced to decrease network interference","Tx power increased"];a.auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),d(f[a]||f[0],t,!1,!0)},n.auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),l(f[a]||f[0],t,!1)},a.sunray_auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split(".").join("<br />")),d(f[a]||f[0],t,!1,!1)},n.sunray_auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&(t.Event_Reason=_.escape(e.details.rrmReason)),l(f[a]||f[0],t,!1)},a.ai_rrm_lite_auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split(".").join("<br />")),d(f[a]||f[0],t,!1,!1)},n.ai_rrm_lite_auto_tx_power_change=function(e){var t={},a=0;return e.details.oldReduction&&(t.Old_Reduction=parseInt(e.details.oldReduction)),e.details.newReduction&&(t.New_Reduction=parseInt(e.details.newReduction),t.Old_Reduction>t.New_Reduction&&(a=1)),e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),t.New_Power>t.Old_Power&&(a=1)),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&(t.Event_Reason=_.escape(e.details.rrmReason)),l(f[a]||f[0],t,!1)};var w=["FRA radio disabled","FRA radio re-enabled"];function h(e){var t={},a=-1;return e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower),-1===t.Old_Power&&(a=1)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),-1===t.New_Power&&(a=0)),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split("-").filter(e=>0!==e.trim().length).map(e=>"-"+e).join("<br />")),{texts:t,index:a}}function g(e){var t={},a=-1;return e.details.oldPower&&(t.Old_Power=parseInt(e.details.oldPower),-1===t.Old_Power&&(a=1)),e.details.newPower&&(t.New_Power=parseInt(e.details.newPower),-1===t.New_Power&&(a=0)),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split("-").filter(e=>0!==e.trim().length).map(e=>"-"+e).join("<br />")),{texts:t,index:a}}a.sunray_auto_rf_fra_change=function(e){var{texts:t,index:e}=h(e);return t.Event_Reason&&t.Event_Reason.includes("Coverage Hole Detected")?d("Coverage Hole Detected",t,!1,!1):d(-1!==e?w[e]:"Unknown FRA Event",t,!1,!1)},n.sunray_auto_rf_fra_change=function(e){var{texts:t,index:e}=h(e);return t.Event_Reason&&t.Event_Reason.includes("Coverage Hole Detected")?l("Coverage Hole Detected",t,!1):l(-1!==e?w[e]:"Unknown FRA Event",t,!1)},a.ai_rrm_lite_auto_rf_fra_change=function(e){var{texts:t,index:e}=g(e);return t.Event_Reason&&t.Event_Reason.includes("Coverage Hole Detected")?d("Coverage Hole Detected",t,!1,!1):d(-1!==e?w[e]:"Unknown FRA Event",t,!1,!1)},n.ai_rrm_lite_auto_rf_fra_change=function(e){var{texts:t,index:e}=g(e);return t.Event_Reason&&t.Event_Reason.includes("Coverage Hole Detected")?l("Coverage Hole Detected",t,!1):l(-1!==e?w[e]:"Unknown FRA Event",t,!1)};var v=["rx sop decreased","rx sop increased"];a.auto_rx_sop_change=function(e){var t={},a=0;return e.details.oldRxSop&&(t.Old_Rx_Sop=parseInt(e.details.oldRxSop)),e.details.newRxSop&&(t.New_Rx_Sop=parseInt(e.details.newRxSop),t.New_Rx_Sop>t.Old_Rx_Sop&&(a=1)),e.details.radio&&(t.Radio=parseInt(e.details.radio)),d(v[a]||v[0],t,!1,!0)},n.auto_rx_sop_change=function(e){var t={},a=0;return e.details.oldRxSop&&(t.Old_Rx_Sop=parseInt(e.details.oldRxSop)),e.details.newRxSop&&(t.New_Rx_Sop=parseInt(e.details.newRxSop),t.New_Rx_Sop>t.Old_Rx_Sop&&(a=1)),e.details.radio&&(t.Radio=parseInt(e.details.radio)),l(v[a]||v[0],t,!1)};var m=["unknown reason","Channel set for new AP","Auto Channel Update","Channel changed to avoid jammed channel","Channel changed to minimize network interference","Channel changed to move off invalid channel","Channel changed to improve network performance"];function R(e){return e?Object.entries(e).map(function(e){return e[0]+" - "+e[1].join(", ")}).join("\n"):""}function e(t){var e=t.details.cause.trim().split(/\s+/).map(function(e){switch(e){case"RootElected":return"Root elected after "+t.details.timeSinceRoot+"s";case"RootReleased":return"Root released after "+t.details.timeToRoot+"s from port "+t.details.reportingPort;case"BPDUConflict":return"BPDU Conflict observed - Received BPDU from "+t.details.senderMAC+"-"+t.details.senderPort+"; expected "+t.details.expectedMAC+"-"+t.details.expectedPort;case"NonEdgePortToForwarding":return"A non-edge port may have moved to forwarding state";case"DelayReceivingBPDUs":return"Delay in receiving BPDUs";case"DelaySendingBPDUs":return"Delay in sending BPDUs";default:return"Unknown"}});return _.escape("Port "+t.details.port+" generated a TCN. Possible causes: "+e.join(", ")+".")}function t(e){return"Profile "+_.escape(e.details.profile)+" applied to port "+_.escape(e.details.port)+" via "+_.escape(e.details.trigger)}function b(e){return"Port "+_.escape(e.details.port)+" received BPDU from "+_.escape(e.details.senderMAC)+", "+_.escape(e.details.senderPort)+"; expected "+_.escape(e.details.expectedMAC)+", "+_.escape(e.details.expectedPort)}a.auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),d(m[e.details.reason]||m[0],t,!1,!0)},n.auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),l(m[e.details.reason]||m[0],t,!1)},a.sunray_auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split(".").join("<br />")),d(m[e.details.reason]||m[0],t,!1,!1)},n.sunray_auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&(t.Event_Reason=_.escape(e.details.rrmReason)),l(m[e.details.reason]||m[0],t,!1)},a.ai_rrm_lite_auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&void 0!==e.details.rrmReason&&(t.Event_Reason=e.details.rrmReason.split(".").join("<br />")),d(m[e.details.reason]||m[0],t,!1,!1)},n.ai_rrm_lite_auto_rf_channel_change=function(e){var t={};return e.details.newChan&&(t.New_Channel=e.details.newChan),e.details.oldChan&&(t.Old_Channel=e.details.oldChan),e.details.band&&(t.Band=e.details.band),e.details.radio&&(t.Radio=parseInt(e.details.radio)),e.details.rrmReason&&(t.Event_Reason=_.escape(e.details.rrmReason)),l(m[e.details.reason]||m[0],t,!1)},a.auto_rf_channel_change_insight=function(e){var t={},a="Better channel after channel change",n=e.details||{};n.radio&&(t.Radio=parseInt(n.radio));e=["oldChanMetric","newChanMetric"].map(function(e){return(n[e]||"").split("/").map(Number).filter(_.negate(isNaN))});return 8==e[0].length&&8==e[1].length&&(t["Current Neighbors"]=e[0][5]-1,t["Expected Neighbors"]=e[1][5]-1,t["Current Channel Utilization"]=(1e3-e[0][7])/10+"%",t["Expected Channel Utilization"]=(1e3-e[1][7])/10+"%",e[0][0]>=e[1][0]&&(a="Improve RF for neighbor APs")),d(a,t,!1,!0)},n.auto_rf_channel_change_insight=a.auto_rf_channel_change_insight,a.channel_avoid_list_change=function(e){var t={},e=e.details||{};return e.band&&(t.Band=parseInt(e.band)),e.chan&&(t.Channel=parseInt(e.chan)),e.newType&&(t.Type=e.newType),e.severity&&(t.Severity=parseInt(e.severity)),e.expiresAt&&(t["Expiry Time"]=unparse_date(parseFloat(e.expiresAt),"%b %-d %H:%M:%S",1)),d("New channel avoidance",t,!1,!0)},n.channel_avoid_list_change=a.channel_avoid_list_change,a.boot=function(e){var t,a,n=[];return e.details.boot_count&&(t=_.escape(e.details.boot_count),(a=events_list3.lookup_node(e))&&e.details.boot_count?(a=url_for({controller:"watchdog_reports",action:"show",node_mac:a.mac,boot_count:e.details.boot_count}),n.push('<a href="'+a+'">boot_count: '+t+"</a>")):n.push("boot_count: "+t)),e.details.reason&&n.push("reason: "+_.escape(e.details.reason)),e.details.build&&n.push("build: "+_.escape(e.details.build)),n.join(", ")},n.boot=function(e){var t=[];return e.details.boot_count&&t.push("boot_count: "+_.escape(e.details.boot_count)),e.details.reason&&t.push("reason: "+_.escape(e.details.reason)),e.details.build&&t.push("build: "+_.escape(e.details.build)),t.join(", ")},a.events_dropped2=function(e){return(1==e.details.n?"1 event was":_.escape(e.details.n)+" events were")+" not logged. "+dashhelp.icon("auto_hohelp events_dropped")},n.events_dropped2=function(e){return(1==e.details.n?"1 event was":_.escape(e.details.n)+" events were")+" not logged. "+dashhelp.icon("auto_hohelp events_dropped")},a.tool=function(e){return e.details&&e.details.user?"started by "+_.escape(e.details.user):""},n.tool=function(e){return e.details&&e.details.user?"started by "+_.escape(e.details.user):""},a.filtering=function(e){var t=[];for(p in e.details)"classification"!=p&&"type"!=p&&t.push(p+" "+_.escape(e.details[p]));return t.join(", ")},n.filtering=function(e){var t=[];for(p in e.details)"classification"!=p&&"type"!=p&&t.push(p+" "+_.escape(e.details[p]));return t.join(", ")},a.ip_conflict=function(e){return"MAC: "+_.escape(e.details.contending_mac)+" also claims IP: "+_.escape(e.details.conflicting_ip)},n.ip_conflict=function(e){return"MAC: "+_.escape(e.details.contending_mac)+" also claims IP: "+_.escape(e.details.conflicting_ip)},a.failover=function(e){return 1==parseInt(e.details.is_cellular)?"Using Cellular":"Using Internet "+(parseInt(e.details.uplink)+1)},n.failover=function(e){return 1==parseInt(e.details.is_cellular)?"Using Cellular":"Using Internet "+(parseInt(e.details.uplink)+1)},a.stp_port_role_change=function(e){var t=_.escape(e.details.port);return"Port "+(t=e.details.agg_port?'<span title="'+R(e.details.agg_port)+'">'+t+"</span>":t)+" "+_.escape(e.details.old_state)+"&rarr;"+_.escape(e.details.new_state)},n.stp_port_role_change=function(e){return"Port "+_.escape(e.details.port)+" "+_.escape(e.details.old_state)+"&rarr;"+_.escape(e.details.new_state)},a.loop_detected=function(e){var t=e.details?e.details.port:"";if(t)return"port: "+_.escape(e.details.port);if(t=e.details?e.details.hops:""){for(var a,n,i,s=t.split(","),r=[],o=0;o<s.length;o++)a=s[o].split("/")[0],n=s[o].split("/")[1],i=a,(i=""==(i=normalize_mac_address(i).split(":").join(""))?0:(i=parseInt(i,16),Number.isNaN(i)?0:i))&&(i=url_for({controller:"nodes",action:"new_list",node_group:Mkiconf.switch,id:i})+"/ports/"+n,r.push('<a href="'+i+'">'+a+"/"+n+"</a>"));return r.join(", ")}},a.mac_flap_detected=function(e){e=Object.assign({},e.details);return e.port=e.port.map(function(e){return _.isString(e)?_.escape(e):'<span title="'+R(e.agg_group)+'">AGGR/'+e.agg_group_id+"</span>"}).join(","),Object.entries(e).map(function(e){return"port"!==e[0]&&(e[1]=_.escape(e[1])),_.escape(e[0])+": "+e[1]}).join(", ")},n.mac_flap_detected=function(e){e=Object.assign({},e.details);return e.port=e.port.map(function(e){return _.isString(e)?e:"AGGR/"+e.agg_group_id}).join(","),c(e)},a.stp_tcn_src=e,n.stp_tcn_src=e,a.sc_capability_detected=function(e){return e.details,_.escape(e.details.deviceMAC)},a.port_autoconf_applied=t,n.port_autoconf_applied=t,a.stp_bpdu_conflict=b,n.stp_bpdu_conflict=b,a.stp_no_longer_root=function(e){var t=parseInt(_.escape(e.details.rootTimeElapsed),10);return"Device "+_.escape(e.details.deviceMAC)+" is no longer root after "+unparse_interval(t)},a.stp_elected_root=function(e){return"Device "+_.escape(e.details.deviceMAC)+" has held root for "+_.escape(e.details.timeToStableRoot)+"s"},a.poe_budget_change=function(e){return"PoE budget changed from "+e.details.old/1e3+"W to "+e.details.new/1e3+"W"},n.poe_budget_change=function(e){return"PoE budget changed from "+e.details.old/1e3+"W to "+e.details.new/1e3+"W"},a.config_fetched=function(e){return"New configuration retrieved from dashboard, cfg_id: "+e.details.cfg_id},n.config_fetched=a.config_fetched,a.config_new_staged=function(e){return"New configuration staged, pending apply, cfg_id: "+e.details.cfg_id},n.config_new_staged=a.config_new_staged,a.config_prev_staged=function(e){return"Error applying new configuration, reverting to last-known configuration, cfg_id: "+e.details.cfg_id},n.config_prev_staged=a.config_prev_staged,a.config_safe_staged=a.config_prev_staged,n.config_safe_staged=a.config_safe_staged,a.config_applied=function(e){return"New configuration successfully applied, new_cfg_id: "+e.details.new_cfg_id+", old_cfg_id: "+e.details.old_cfg_id},n.config_applied=a.config_applied,a.config_apply_failure=function(e){var t={},a="New configuration failed to apply, new_cfg_id: "+e.details.new_cfg_id+", transaction_id: "+e.details.cfg_trans_id;return"cfg_trans_reason"in e.details&&(t["Transaction Reason"]=e.details.cfg_trans_reason),"msg"in e.details&&(t.Description=e.details.msg),"failure_id"in e.details&&(t["Failure ID"]=e.details.failure_id),"failure_type"in e.details&&(t["Failure type"]=e.details.failure_type),d(a,t,!1,!0)},n.config_apply_failure=a.config_apply_failure,a.topology_changed=function(e){var t={},a="Network topology changed, change_type: "+e.details.change_type+", state: "+e.details.state;return"msg"in e.details&&(t.Description=e.details.msg),"topo_change_id"in e.details&&(t["Change ID"]=e.details.topo_change_id),"old"in e.details&&(t["Old state"]=e.details.old),"new"in e.details&&(t["New state"]=e.details.new),"diff"in e.details&&(t["Difference in state"]=e.details.diff),d(a,t,!0,!0)},n.topology_changed=a.topology_changed,a.memory_low=function(e){var t={},a="Low memory, type: "+e.details.type;return"msg"in e.details&&(t.Description=e.details.msg),"total_kb"in e.details&&(t["Total (in KB)"]=e.details.total_kb),"avail_kb"in e.details&&(t["Available (in KB)"]=e.details.avail_kb),"avail_percent"in e.details&&(t["Available (%)"]=e.details.avail_percent),d(a,t,!0,!0)},n.memory_low=a.memory_low,a.diskspace_low=function(e){var t={},a="Low diskspace, type: "+e.details.type+", file system: "+e.details.filesystem;return"msg"in e.details&&(t.Description=e.details.msg),"total_kb"in e.details&&(t["Total (in KB)"]=e.details.total_kb),"avail_kb"in e.details&&(t["Available (in KB)"]=e.details.avail_kb),"avail_percent"in e.details&&(t["Available (%)"]=e.details.avail_percent),d(a,t,!0,!0)},n.diskspace_low=a.diskspace_low,a.conn_state_change=function(e){var t={},a="Tunnel connection state change, type: "+e.details.type+", interface: "+e.details.interface;return"msg"in e.details&&(t.Description=e.details.msg),"ipconflict"in e.details&&(t["IP conflict"]=e.details.ipconflict),"state"in e.details&&(t.State=e.details.state),"uptime"in e.details&&(t["Connection uptime"]=e.details.uptime),"ipconflict"in e.details&&(t["IP conflict"]=e.details.ipconflict),"old"in e.details&&(t["Old state"]=e.details.old),"new"in e.details&&(t["New state"]=e.details.new),d(a,t,!1,!0)},n.conn_state_change=a.conn_state_change,a.config_startup_saved=function(e){return"Configuration successfully committed for optimized system startup, cfg_id: "+e.details.cfg_id},n.config_startup_saved=a.config_startup_saved,a.psu_insert=function(e){var t=events_list3.lookup_node(e),a="Unknown";return t&&(a=t.model.match(/^MS320-48(LP|FP)?-HW$/)?3-e.details.slot:_.escape(e.details.slot)),"serial: "+_.escape(e.details.serial)+", slot: "+a},n.psu_insert=a.psu_insert,a.psu_remove=function(e){return a.psu_insert(e)},n.psu_remove=function(e){return n.psu_insert(e)},a.rps_avail=function(e){return"true"==e.details.avail?"Redundant power available. The RPS system power has changed to good.":"Redundant power lost. The RPS system power state changed to bad. The RPS might not be able to provide power to the switch."},n.rps_avail=a.rps_avail,a.rps_backup=function(e){return"true"==e.details.backed_up?"Main power lost. The RPS is providing power to the switch.":"Main power restored. Redundant power available."},n.rps_backup=a.rps_backup,a.ids_alert=function(e){var t=r.extend({},e.details);if(void 0===t.message)return i(e,is_csv=!1);e=t.message;return delete t.message,delete t.timestamp,d(e,t,!1,!0)},n.ids_alert=function(e){var t=r.extend({},e.details);if(void 0===t.message)return i(e,is_csv=!0);e=_.escape(t.message);return delete t.message,delete t.timestamp,l(e,t)},a.vrrp_state_change=function(e){return _.escape(e.details.old_state)+"&rarr;"+_.escape(e.details.new_state)},n.vrrp_state_change=a.vrrp_state_change,a.vrrp_vrid_collision=function(e){return"VRID: "+_.escape(e.details.vrid)+" Source IP: "+_.escape(e.details.src_ip)},n.vrrp_vrid_collision=a.vrrp_vrid_collision,events_list3.render_ssid=function(e,t){return e.details&&void 0!==e.details.vap?t[e.details.vap]:""},events_list3.lookup_node=function(e){return window.nodes_by_serial&&e.node_serial&&window.nodes_by_serial[e.node_serial]?window.nodes_by_serial[e.node_serial]:nodes_hash&&e.ap_id&&nodes_hash[e.ap_id]?nodes_hash[e.ap_id]:Mkijson&&Mkijson.n&&Mkijson.n.hash&&e.ap_id&&Mkijson.n.hash[e.ap_id]?Mkijson.n.hash[e.ap_id]:window.flux&&e.ap_id?window.flux.store("NodeStore").get(e.ap_id):void 0},events_list3.render_ap_column=function(){return"[% node = events_list3.lookup_node(item) %]<span style='white-space:nowrap'><a href=\""+Mkiconf.node_show_url.replace(/%23|%2523/,"[%= node ? node.id : '' %]")+"\">[%= node ? _.escape(node.name || node.mac) : 'N/A' %]</a></span>"},events_list3.render_ap_text=function(e){e=events_list3.lookup_node(e);return e?_.escape(e.name||e.mac):"N/A"},events_list3.find_node_id=function(e){e=events_list3.lookup_node(e);return e?e.id:""};function P(e){return'<a href="'+Mkiconf.client_show_url.replace(/%23|%2523/,"[%= item.cli_key %]")+'">'+e+"</a>"}function y(e){return _.isString(e.details)?_.reduce(r("<x "+e.details+"/>").get(0).attributes,function(e,t){return e[t.name]=t.value,e},{}):e.details}events_list3.render_client_column=function(){return P("[%= escape(item.cli_name || item.cli_mac || '') %]")},events_list3.render_track_by_ip_client_column=function(){return P("[%= escape(item.cli_name || item.cli_ip || '') %]")},events_list3.render_track_by_unique_client_identifier_column=function(){return"<a href=\"[%= url_for({controller:'dashboard', action: 'show', mac: item.cli_mac }) %]\">[%= escape(item.cli_name || item.cli_mac || '') %]</a>"},events_list3.render_pcc_machine_column=function(){return"<a href=\"[%= url_for({controller:'pcc', action: 'show', id: item.pcc_machine_id}) %]\">[%= escape(item.cli_name || '') %]</a>"},events_list3.render_pcc_completed_at_column=function(e){var t=" - ";return t=!isNaN(parseFloat(e.completed_at))?unparse_date(parseFloat(e.completed_at),"%b %d %H:%M:%S"):t},events_list3.render_details_column=function(t){var e=_.extend({},t);try{e.details=y(t)}catch(e){log_error("EventLog: Failed to parse event description",{description:t.details,type:t.el_type})}switch(t.el_type){case"cf_block":case"sf_url_block":case"sf_binary_block":return a.filtering(e);case"spectrum_scan_start":return a.tool(e)}return a[t.el_type]?a[t.el_type](e):i(e,is_csv=!1)},events_list3.render_details_column_csv=function(t){var e=_.extend({},t);try{e.details=y(t)}catch(e){log_error("EventLog: Failed to parse event description",{description:t.details,type:t.el_type})}switch(t.el_type){case"cf_block":case"sf_url_block":case"sf_binary_block":return n.filtering(e);case"spectrum_scan_start":return n.tool(e)}return n[t.el_type]?n[t.el_type](e):i(e,is_csv=!0)},events_list3.render_csv_column=function(e){return summary="",summary="string"!=typeof e.summary?c(summary):e.summary,summary}}(jQuery);