/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(){var e=['<td class="name"></td>','<td class="state"><select class="state"></select></td>','<td class="timespan"><select class="start"></select><select class="end"></select></td>','<td style="width: 300px; height: 40px">','<div class="schedule_slider_container">','<div class="hour_tick no_tick hour_0" style="0">0:00</div>','<div class="hour_tick hour_1" style="left:16.6666666667%">4:00</div>','<div class="hour_tick hour_2" style="left:33.3333333333%">8:00</div>','<div class="hour_tick hour_3" style="left:50%">12:00</div>','<div class="hour_tick hour_4" style="left:66.6666666667%">16:00</div>','<div class="hour_tick hour_5" style="left:83.3333333333%">20:00</div>','<div id="schedule_slider" class="slider"> </div>',"</div>","</td>"].join("");var t=new Backbone.Epoxy.Model({stateOptions:[{label:"Enabled",value:"enabled"},{label:"Disabled",value:"disabled"}],timeOptions:function(){for(var e=[],t=0;t<=48;t++){var l={};l.value=t.toString();var s=String(Math.floor(t/2));l.label=s+":"+(t%2==0?"00":"30"),e.push(l)}return e}()});window.MKI.Views.Schedule=Backbone.Epoxy.View.extend({viewModel:t,tagName:"tr",bindings:{"td.name":"text:name","td.state select":"value:state,options:stateOptions","td.timespan select.start":"value:start,options:timeOptions","td.timespan select.end":"value:end,options:timeOptions"},template:e,initialize:function(){_.bindAll(this,"handleSlide"),this.$el.html(this.template),this.initializeSlider().initializeSelects().initializeSelectBindings()},initializeSlider:function(){var e=this;return e.$(".slider").slider({range:!0,min:0,max:48,values:[+e.model.get("start"),+e.model.get("end")],slide:e.handleSlide}).find("a.ui-slider-handle:first").addClass("left-slider"),this},handleSlide:function(e,t){$(t.handle).hasClass("left-slider")?this.model.set("start",t.value.toString()):this.model.set("end",t.value.toString())},initializeSelects:function(){return"enabled"==this.model.get("state")?this.$(".schedule_slider_container").addClass("invert"):this.$(".schedule_slider_container").removeClass("invert"),this},initializeSelectBindings:function(){var e=this.$(".schedule_slider_container"),l=this.$(".slider"),s=this.model;return s.on("change:state",function(){e.toggleClass("invert","enabled"==s.get("state"))}).on("change:start",function(){var e=s.get("start"),t=l.slider("values",1),t=Math.min(e,t);l.slider("values",0,t)}).on("change:end",function(){var e=s.get("end"),t=l.slider("values",0),t=Math.max(e,t);l.slider("values",1,t)}),this}}),window.MKI.Views.ScheduleList=Backbone.Epoxy.View.extend({tagName:"div",className:"schedules",events:{"click .schedule_template":"setAllSchedules"},initialize:function(){this.$table=$("<table class='schedules'>"+this.header+"<tbody data-bind='collection:$collection'></tbody></table>"),this.$el.append(this.commonSchedules).append(this.$table),this.collection instanceof Backbone.Collection||(this.collection=new MKI.Collections.Schedules(this.collection)),this.collection.view=MKI.Views.Schedule},header:['<thead><tr style="vertical-align:top; font-weight:bold;">',"<th>Day</th>","<th>State</th>",'<th style="padding-left:33px">During</th>',"</tr></thead><tbody></tbody>"].join(""),commonSchedules:['<div class="template_list" style="padding-left:14px">Templates:','<a class="schedule_template" href="#" data-mode="eight_to_five">8 to 5 daily</a>','<a class="schedule_template" href="#" data-mode="eight_to_five_wd">8 to 5 on weekdays only</a>','<a class="schedule_template" href="#" data-mode="weekdays">weekdays only</a>','<a class="schedule_template" href="#" data-mode="always_on">always on</a>','<a class="schedule_template" href="#" data-mode="always_off">always off</a>',"</div>"].join(""),setAllSchedules:function(e){var l=this,s=$(e.target).data("mode");return this.collection.each(function(e){var t="weekdays"==s?"always_on":"eight_to_five_wd"==s?"eight_to_five":s;"weekdays"!=s&&"eight_to_five_wd"!=s||!_.contains(["5","6"],e.get("day_id"))?e.set(l.allScheduleLookup[t]||l.defaultAllSchedules):e.set({start:"0",end:"48",state:"disabled"})}),!1},allScheduleLookup:{eight_to_five:{start:"16",end:"34",state:"enabled"},always_on:{start:"0",end:"48",state:"enabled"},always_off:{start:"0",end:"48",state:"disabled"}},defaultAllSchedules:{start:"0",end:"48",enabled:"enabled"}})}();