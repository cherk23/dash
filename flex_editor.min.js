/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(q,J){q.fn.flex_editor=function(c){if(0==this.length)return this;var p=this;q(p).addClass("flex-editor");var e,t=c.rows,a=[],u=c.columns,n=q("<table />",{class:c.class||""}),o=q("<thead />"),r=q("<tbody />",{class:"flex-editor-body"}),s=q("<tfoot />"),i=c.name||p.attr("data-flex-key")||p.attr("id"),l="]"==i[i.length-1]?i.substring(0,i.length-1)+"_deleted]":i+"_deleted",d=q("<input/>",{type:"hidden",name:i,value:JSON.stringify(t)}),_=q("<input/>",{type:"hidden",name:l}),h=0;return c=q.extend({blankimg:Mkiconf.images+"onebyone.gif",has_add_link:!0,has_default_row:!1,default_row_top:!1,show_secret_toggle:!0,sortable:!1,no_header:!1,no_entries_message:!1,no_track:!1,row_create_callback:q.noop,row_added_callback:q.noop,rendered_callback:q.noop},c),void 0!==u&&(f(),this);function f(){p.empty(),function(){c.no_header||(n.append(o),function(){o.empty();var n=q("<tr />");q.each(u,function(e,t){var a=q("<th />",{class:t.classname}).html(t.headername||"").attr("data-testid",t.classname+"-header").toggleClass("hidden","hidden"==t.type);t.dashhelp&&window.dashhelp&&dashhelp(t.dashhelp,a),n.append(a)}),o.append(n)}());n.append(r),n.append(s),function(){var a;r.empty(),c.has_default_row&&c.default_row_top&&r.append(g());r.attr("data-rows-count",t.length),q.each(t,function(e,t){a=m(t),r.append(a),"function"==typeof c.row_create_callback&&c.row_create_callback(a,t,c)}),b(),r.on("click",".remove_row_link",k),r.on("change",j)}(),s.empty(),c.has_default_row&&!c.default_row_top&&s.append(g())}(),p.append(n),c.rendered_callback(n),p.find(".chosen-select").chosen(),c.no_entries_message&&p.append(e=q("<div />",{class:"no_entries_message"}).html(c.no_entries_message)),C(),c.has_add_link&&p.append(function(){{if(!c.max_rows||h<c.max_rows)return q("<div />").append(q("<a href='#' />").addClass("add_row_link").html(c.add_text).attr("data-testid","add-row-link").click(y));if(1<c.max_rows)return q("<div />").text(c.max_rows_message)}}()),c.sortable&&r.sortable({handle:".move_row_link",items:" > tr",opacity:.5,axis:"y",update:function(){q(this).change(),b()}}),p.data({name:i,to_json:S,to_obj:M,deleted:a,add_row:x,rerender_column:A,columns:u,set_rows:O,update_row_data:j}),0===p.parents(".flex-editor").length&&(d.add(_).appendTo(p),c.no_track&&d.addClass("notrack"),void 0!==c.hidden_config_label&&p.append(q("<label/>",{for:i,class:"hidden_config_label"}).html(c.hidden_config_label)),p.off("change",z),p.off("rows_added_or_removed",C),p.on("change",z),p.on("rows_added_or_removed",C)),p.trigger("flex_editor_init_completed")}function m(n){var o=q("<tr />").data({row_data:n,rerender:v});return J.each(u,function(e){var t=w(e,n),a=q("<td/>",{class:e.classname,"data-testid":e.classname+"-value"}).html(t);t.data&&"function"==typeof t.data("after_render")&&t.data("after_render")(),a.toggleClass("hidden","hidden"==e.type).appendTo(o)}),o}function v(e){var t=q(this).data().row_data;q.extend(!0,t,e),q(this).replaceWith(m(t)),p.change()}function w(e,t){if("custom"===e.type)return q(e.custom_cell_func(e,t,c));if("dom"!==e.type)return T[e.type](e,t,c);var a=q(e.custom_cell_dom).clone(!0);return a.data({init:e.init,to_obj:e.to_obj}),"function"==typeof e.init&&a.data().init.apply(a,[e,t,c]),a.removeAttr("id").show()}function g(){var n=q("<tr />"),o={};return q.each(u,function(e,t){var a;t.defaulteditable?(o[t.classname]=t.defaulttext,a=w(t,o),n.append(q("<td />",{class:t.classname,"data-testid":t.classname+"-footer"}).html(a)),a.data&&"function"==typeof a.data("after_render")&&a.data("after_render")()):n.append(q("<td />",{class:t.classname,"data-testid":t.classname+"-footer"}).html(t.defaulttext))}),n}function y(e){e.preventDefault(),x({})}function x(e){if(c.max_rows&&h>=c.max_rows)return alert(c.max_rows_message||"Cannot create new row. Limit of "+c.max_rows+" has been reached."),!1;var t=m(e);r.append(t),c.row_create_callback(t,e,c),c.row_added_callback(t,e,c),t.find(":input").change(),t.find(".chosen-select").chosen(),C()}function k(e){if(e.stopPropagation(),c.min_rows&&0<c.min_rows&&h<=c.min_rows)return alert(c.min_rows_message||"Cannot delete row. Minimum of "+c.min_rows+" has been reached."),!1;var t=q(this).closest("tr"),e=t.data("row_data");if(!1===(c.row_before_delete_callback||q.noop)(t,c))return!1;t.remove(),C(),p.change(),e.id&&!/^new_/.test(e.id.toString())&&(a.push(e.id),_.val(a.join(","))),(c.row_after_delete_callback||q.noop)()}function b(){r.attr("data-rows-count",r.children("tr").length),r.attr("data-testid","radius-server-table-input"),q.each(r.children("tr"),function(e,t){e+=1;t.setAttribute("data-testid","row-identifier-"+e),"ordernum"===u[0].type&&q(t).find("td").first().html(e)})}function C(){h=r.children("tr").length,b(),(e||c.hide_headers_when_empty)&&(c.has_default_row&&(h+=1),n.toggle(0<h),e&&e.toggle(0==h))}function j(e){e.stopPropagation();for(var t,a,n,o,r=q(e.target),s=r.parents(),i=s.length,l=0;l<i;l++)if(q(s[l]).is(".flex-editor")){a=q(s[l-3]),t=q(s[l-4]),n=q(s[l-5]);break}if(0<a.length&&0<t.length){var e=H(u[t.index()].classname),e=n.attr("data-flex-key")||e;if(n.is(":not(:input)")&&"function"==typeof n.data().to_obj)o=n.data().to_obj.apply(n);else if(r.is("input[type=radio]")){if(!r.closest("tr").children().eq(c.hidden_col_idx).children().val()){for(var d=Math.floor(1e4*Math.random());0<=c.random_ids.indexOf(d);)d=Math.floor(1e4*Math.random());c.random_ids.push(d),r.closest("tr").children().eq(c.radio_col_idx).children().val(d),r.closest("tr").children().eq(c.hidden_col_idx).children().val(d),0==h&&r.prop("checked",!0)}o=r.prop("checked")}else o=r.is("input[type=checkbox]")?r.prop("checked"):r.is("input[type=file]")?r.val().split("\\").pop():(n.is(".chosen-container")?t.find("select"):r).val();r=a.data().row_data,c.no_classname_data?r=q.extend(r,o):r[e]=o}p.change()}function z(e){e.target===this&&d.val(S()).change()}function A(a){r.children("tr").each(function(){var e=q(this),t=q(this).data("row_data");e.find(">td:nth-child("+(a+1)+")").each(function(){q(this).html(w(u[a],t))})})}function S(){return JSON.stringify(M())}function M(){var a=[];return q.each(r.children("tr"),function(e,t){null!=q(t).data().row_data&&a.push(q(t).data().row_data)}),a}function O(e){t=e,f()}};var T=window.flex_editor_cell_functions={};function s(e,t){t=q("<option />",{value:t[1],text:t[0],disabled:!0===t[2]});e.append(t)}function H(e){var t=e,a=e.indexOf(" ");return t=-1!==a?e.substr(0,a):t}T.inputcheckbox=function(e,t,a){var n=H(e.classname),o=void 0!==e.default_val,n=void 0===t[n]&&o?e.default_val:t[n],e=q("<input />",{type:"checkbox",class:e.classname});return e.prop("checked",n),e},T.inputradio=function(e,t,a){var n=H(e.classname),o=void 0!==e.default_val,n=void 0===t[n]&&o?e.default_val:t[n],e=q("<input />",{type:"radio",class:e.classname,name:e.classname,value:null==e.data_key2?t[e.data_key]:t[e.data_key]+":"+t[e.data_key2]});return e.prop("checked",n),e},T.inputtext=function(e,t,a,n){var o=H(e.classname);return q("<input />").attr({type:n||"text",size:e.size,maxlength:e.maxlength,class:e.classname,autocomplete:e.autocomplete||"on",value:J.nilCompact([t[o],e.default_value,""])[0],placeholder:J.nilCompact([e.hinttext,""])[0]})},T.inputemail=function(e,t,a){return this.inputtext(e,t,a,"email")},T.inputnumeric=function(e,t,a){return this.inputtext(e,t,a,"tel")},T.inputnumber=function(e,t,a){return this.inputtext(e,t,a,"number")},T.inputtext_secret=function(e,t,a){var n,o=H(e.classname),r=J.nilCompact([t[o],e.default_value,""])[0],t=q("<div />"),s=q("<input />").attr({type:"password",class:e.classname+" jsAnalyticsExclude",autocomplete:e.autocomplete||"on",size:e.size,value:""==r||e.show_secret_toggle?r:"4UWv76gAZrY50"});return t.append(s),!1!==e.show_secret_toggle?(n=q("<a />",{class:"show_key_link"}).html("Show secret"),s.after(n),s.after("&nbsp;"),n.click(function(){var e="password"===s.prop("type");s.prop("type",e?"text":"password"),q(this).html(e?"Hide secret":"Show secret")})):(o=q("<input />").attr({type:"text",size:e.size,readonly:"readonly"}),r=q("<input />").attr({type:"text",size:e.size}),n=q("<span />",{class:"show_key pseudo_link",text:"Show key"}),e=q("<span />",{class:"hide_key pseudo_link",text:"Hide key"}),t.addClass("password_toggle").append(o).append(r).append(n).append(e)),t},T.inputtextarea=function(e,t,a){var n=H(e.classname),n=J.nilCompact([t[n],e.default_value,""])[0];return Array.isArray(n)&&(n=n.join("\n")),q("<textarea />",{rows:1,cols:e.cols,class:e.classname,placeholder:J.nilCompact([e.hinttext,""])[0]}).html(n)},T.hidden=function(e,t,a){var n=H(e.classname);return q("<input />",{type:"hidden",class:e.classname,value:J.nilCompact([t[n],e.default_value,""])[0]})},T.plaintext=function(e,t,a){var n=H(e.classname),n=Array.isArray(t[n])?t[n].join(",\n"):t[n];return void 0!==e.render_value_fn&&"function"==typeof e.render_value_fn?e.render_value_fn(n)||"":J.nilCompact([e.plaintext_value,n,""])[0]},T.spinner=function(){return baseline_spinner_html()},T.template=function(e,t,a){return new JSTemplate("[% var item=this.item %]"+e.tmpl).render({item:t})},T.ordernum=function(e,t,a){return""},T.actions=function(e,t,a){var n=q(""),o={};return o.reorder=q('<svg class="reorder-icon-svg" width="16" height="16"><use href="/images/icons/icons-sprite.svg#move-icon"></use></svg>'),o.remove=q('<svg class="remove-icon-svg" width="16" height="16"><use href="/images/icons/icons-sprite.svg#remove-icon"></use></svg>'),a.sortable&&(n=n.add(q("<a />",{class:"move_row_link","data-testid":"move-row-link"}).append(o.reorder))),n=!(t.unremovable||a.max_rows&&a.max_rows<=1)?n.add(q("<a />",{class:"remove_row_link","data-testid":"remove-row-link",title:e.delete_tooltip||""}).append(o.remove)):n},T.inputselect=function(e,t,a){var n,o=q("<select "+(e.multi?'multiple="multiple"':"")+"/>",{class:e.classname}),r="function"==typeof e.options?e.options(t):e.options;e.show_class&&o.addClass(e.classname),e.size&&o.css("width",e.size),q.each(r,function(e,t){"object"!=typeof t[1]?s(o,t):(n=q("<optgroup />",{label:t[0]}),q.each(t[1],function(e,t){s(n,t)}),o.append(n))}),e.on_change&&o.change(e.on_change);r=H(e.classname);return o.val(J.nilCompact([t[r],e.default_value])[0])},T.inputtextarray=function(e,t,a){var n,o=H(e.classname),r=J.nilCompact([t[o],e.default_value,""])[0],t=1,o=q("<div />").data({to_obj:function(){return J.compact(n.val().split(/[,\s]+/))}});return Array.isArray(r)&&(t=r.length,r=r.join(",\n")),n=q("<textarea />",{rows:t,cols:e.cols,class:e.classname,placeholder:e.hinttext||""}).val(r),o.append(n),o},T.chosen=function(e,t,a){var n=T.inputselect(e,t,a).data({after_render:function(){n.chosen(e.chosen_opts||{}),e.chosen_opts&&J.isFunction(e.chosen_opts.after_create)&&e.chosen_opts.after_create(n.data("chosen"))}});return void 0!==e.placeholder&&n.attr("data-placeholder",e.placeholder),n}}(jQuery,_);