/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
var STATUS_FLAGS={SPEED_10:1,SPEED_100:2,SPEED_1000:3,SPEED_2500:4,SPEED_5000:5,SPEED_10000:6,SPEED_20000:7,SPEED_40000:8,SPEED_100000:9,SPEED_25000:10,CONNECTED:15,FULL_DUPLEX:16,SPEED_DOWNSHIFT:256,USING_SFP:1024,POE_OVERLOAD:262144,POE_UNDERLOAD:524288,POE_DENIED:1048576,LACP_DISABLED:2097152,AP_NOAUTH:4194304,GUEST_ENABLED:8388608,UDLD_PORT_BLOCKED:33554432,UDLD_ERR_MASK:201326592,UDLD_ERR_TX_RX_LOOP:67108864,UDLD_ERR_N_MISMATCH:134217728,UDLD_ERR_UNIDIR:201326592,PRESENT:268435456},STP_FLAGS={STP_STATE_LEARNING:1,STP_STATE_FORWARDING:2,STP_STATE_DISCARDING:4,STP_VERSION_LEGACY_STP:8,STP_IS_EDGE:16,STP_IS_PTP:32,STP_ROOTGUARD_ACTIVE:64,STP_BPDUGUARD_ACTIVE:128,STP_LOOPGUARD_ACTIVE:256,STP_BPDU_CONFLICT:512},STATUS_TYPE={STATUS_DISCONNECTED:0,STATUS_OPTIMAL:1,STATUS_SUBOPTIMAL:2,STATUS_WARNING:3,STATUS_ERROR:4},USAGE_FLAGS={CRC_WARNING:1,CRC_ERROR:2,JABBERS_WARNING:4,JABBERS_ERROR:8,FRAGS_WARNING:16,FRAGS_ERROR:32,MISSIZED_WARNING:64,MISSIZED_ERROR:128,COLLISIONS_WARNING:256,COLLISIONS_ERROR:512,STP_TCS_WARNING:1024,STP_TCS_ERROR:2048},logLegacyJsFunction=function(S){var s=new Error(S+" is still being called."),S="[logLegacyJsFunction]: "+s.message+" Check stack trace for details.";window.JL("onerrorLogger").fatalException({logData:{errorMsg:S},message:S,stack:s.stack})};function switchportIsConnected(S){return 0!=(S.curr_status&STATUS_FLAGS.CONNECTED)}function _checkStatus(S){return S.curr_status&STATUS_FLAGS.POE_OVERLOAD||S.curr_status&STATUS_FLAGS.UDLD_PORT_BLOCKED||S.stp_flags&STP_FLAGS.STP_LOOPGUARD_ACTIVE||S.usageStatus&USAGE_FLAGS.CRC_ERROR||S.usageStatus&USAGE_FLAGS.JABBERS_ERROR&&S.isAdmin||S.usageStatus&USAGE_FLAGS.FRAGS_ERROR||S.usageStatus&USAGE_FLAGS.STP_TCS_ERROR||S.usageStatus&USAGE_FLAGS.MISSIZED_ERROR&&S.isAdmin&&!S.isStackport?STATUS_TYPE.STATUS_ERROR:S.curr_status&STATUS_FLAGS.POE_DENIED||S.curr_status&STATUS_FLAGS.AP_NOAUTH||S.curr_status&STATUS_FLAGS.SPEED_DOWNSHIFT||S.curr_status&STATUS_FLAGS.UDLD_ERR_MASK||S.stp_flags&STP_FLAGS.STP_BPDUGUARD_ACTIVE||S.stp_flags&STP_FLAGS.STP_ROOTGUARD_ACTIVE||S.stp_flags&STP_FLAGS.STP_BPDU_CONFLICT||S.usageStatus&USAGE_FLAGS.CRC_WARNING||S.usageStatus&USAGE_FLAGS.JABBERS_WARNING&&S.isAdmin||S.usageStatus&USAGE_FLAGS.FRAGS_WARNING||S.usageStatus&USAGE_FLAGS.COLLISIONS_ERROR||S.usageStatus&USAGE_FLAGS.STP_TCS_WARNING||S.usageStatus&USAGE_FLAGS.MISSIZED_WARNING&&S.isAdmin&&!S.isStackport?STATUS_TYPE.STATUS_WARNING:switchportIsConnected(S)?(15&S.curr_status)<=STATUS_FLAGS.SPEED_100?STATUS_TYPE.STATUS_SUBOPTIMAL:STATUS_TYPE.STATUS_OPTIMAL:STATUS_TYPE.STATUS_DISCONNECTED}function switchportCodifyStatus(S,s,t){logLegacyJsFunction("switchportCodifyStatus");for(var _=S||[],A=[],r=0,T=0;T<_.length;T++){var a,e,u=[],E=_[T]&&_[T][1],o=_[T]&&_[T][2],R=_[T]&&_[T][3];null!=E&&(_[T-1]&&_[T-1][1]===E&&_[T-1][2]===o&&_[T-1][3]===R||(e=0,_checkStatus(a={curr_status:E,stp_flags:o,usageStatus:R,isAdmin:s,isStackport:t})===STATUS_TYPE.STATUS_DISCONNECTED?e=1:_checkStatus(a)===STATUS_TYPE.STATUS_ERROR?e=2:_checkStatus(a)===STATUS_TYPE.STATUS_WARNING?e=3:_checkStatus(a)===STATUS_TYPE.STATUS_SUBOPTIMAL?e=4:_checkStatus(a)===STATUS_TYPE.STATUS_OPTIMAL&&(e=5),u[0]=_[T][0],u[1]=e,u[2]=E,u[3]=o,u[4]=R,A[r]=u,r++))}return A}function switchportHasStatus(S){return switchportIsConnected(S)||S.curr_status&STATUS_FLAGS.POE_OVERLOAD||S.curr_status&STATUS_FLAGS.POE_DENIED||S.curr_status&STATUS_FLAGS.UDLD_PORT_BLOCKED}function switchportErrorMessages(S){logLegacyJsFunction("switchportErrorMessages");var s=[];return S.curr_status&STATUS_FLAGS.POE_OVERLOAD&&s.push("PoE overload"),S.curr_status&STATUS_FLAGS.UDLD_PORT_BLOCKED&&S.curr_status&STATUS_FLAGS.UDLD_ERR_MASK&&s.push(switchportUDLDMessageText(S)),S.stp_flags&STP_FLAGS.STP_LOOPGUARD_ACTIVE&&s.push("Stopped receiving BPDUs with loop guard enabled"),S.usageStatus&USAGE_FLAGS.CRC_ERROR&&s.push("Very high proportion of CRC errors"),S.usageStatus&USAGE_FLAGS.JABBERS_ERROR&&S.isAdmin&&s.push("Very high proportion of jabber errors"),S.usageStatus&USAGE_FLAGS.FRAGS_ERROR&&s.push("Very high rate of packet fragments"),S.usageStatus&USAGE_FLAGS.MISSIZED_ERROR&&S.isAdmin&&!S.isStackport&&s.push("Very high proportion of oversized or undersized packets"),S.usageStatus&USAGE_FLAGS.STP_TCS_ERROR&&s.push("Very high rate of STP topology changes"),s}function switchportWarningMessages(S){logLegacyJsFunction("switchportWarningMessages");var s=[];return S.stp_flags&STP_FLAGS.STP_BPDU_CONFLICT&&s.push("Received BPDUs from multiple senders"),S.stp_flags&STP_FLAGS.STP_BPDUGUARD_ACTIVE&&s.push("BPDU guard activated, STP discarding packets"),S.stp_flags&STP_FLAGS.STP_ROOTGUARD_ACTIVE&&s.push("Root guard activated, STP discarding packets"),S.curr_status&STATUS_FLAGS.SPEED_DOWNSHIFT&&s.push("1 Gigabit link failed, speed downshifted"),S.curr_status&STATUS_FLAGS.POE_DENIED&&s.push("PoE port was denied power"),S.curr_status&STATUS_FLAGS.UDLD_ERR_MASK&&s.push(switchportUDLDMessageText(S)),S.usageStatus&USAGE_FLAGS.CRC_WARNING&&s.push("High proportion of CRC errors"),S.usageStatus&USAGE_FLAGS.JABBERS_WARNING&&S.isAdmin&&s.push("High proportion of jabber errors"),S.usageStatus&USAGE_FLAGS.FRAGS_WARNING&&s.push("High rate of packet fragments"),S.usageStatus&USAGE_FLAGS.MISSIZED_WARNING&&S.isAdmin&&!S.isStackport&&s.push("High proportion of oversized or undersized packets"),S.usageStatus&USAGE_FLAGS.COLLISIONS_ERROR&&s.push("High proportion of ethernet collisions"),S.curr_status&STATUS_FLAGS.AP_NOAUTH&&s.push("Port not forwarding traffic due to access policy"),S.usageStatus&USAGE_FLAGS.STP_TCS_WARNING&&s.push("High rate of STP topology changes"),s}function switchportTrafficMessages(S){logLegacyJsFunction("switchportTrafficMessages");var s=[];return S.curr_status&STATUS_FLAGS.LACP_DISABLED&&s.push("Port running LACP and LACP has disabled this port"),S.stp_flags&STP_FLAGS.STP_STATE_DISCARDING&&s.push("STP discarding packets from this port"),s}function switchportSpeedMessages(S){logLegacyJsFunction("switchportSpeedMessages");var s=[];return(7&S.curr_status)===STATUS_FLAGS.SPEED_10?s.push("Connected at 10 Mbps"):(7&S.curr_status)===STATUS_FLAGS.SPEED_100?s.push("Connected at 100 Mbps"):S.curr_status&STATUS_FLAGS.USING_SFP?s.push("SFP link"):(7&S.curr_status)===STATUS_FLAGS.SPEED_1000&&s.push("Connected at 1 Gbps"),s}function switchportUDLDMessageText(S){logLegacyJsFunction("switchportUDLDMessageText");var s={};return s[STATUS_FLAGS.UDLD_ERR_TX_RX_LOOP]="TX/RX loop",s[STATUS_FLAGS.UDLD_ERR_N_MISMATCH]="neighbor mismatch",s[STATUS_FLAGS.UDLD_ERR_UNIDIR]="unidirectional link","UDLD has detected a "+s[S.curr_status&STATUS_FLAGS.UDLD_ERR_MASK]+(S.curr_status&STATUS_FLAGS.UDLD_PORT_BLOCKED?" and has blocked the port":"")}function switchportStatusMessageText(S){logLegacyJsFunction("switchportStatusMessageText");var s,t,_;return switchportHasStatus(S)?(s=switchportErrorMessages(S),t=switchportWarningMessages(S),_=switchportTrafficMessages(S),S=switchportSpeedMessages(S),0!==s.length?s.join("<br/>"):0!==t.length?t.join("<br/>"):0!==_.length?_.join("<br/>"):0!==S.length?S.join("<br/>"):"Connected"):"Disconnected"}function switchportSortStatus(S){var s=switchportCodifyStatus(S.status),t=Mkijson.ports.all.t1-Mkijson.ports.all.t0,_=0,A=0;if(!s||!s[0])return t/60*-1e7;for(var r=s[0][0],T=s[0][1],a=1;a<s.length;a++){var e=s[a][0],u=s[a][1],A=e-r;switch(T){case 2:_+=1e3*A;break;case 3:_+=100*A;break;case 4:_+=5*A;break;case 5:_+=4*A}r=e,T=u}switch(A=Mkijson.ports.all.t1-r,T){case 2:_+=1e3*A;break;case 3:_+=100*A;break;case 4:_+=5*A;break;case 5:_+=4*A}return _+(0<S.rx_bytes+S.tx_bytes?1:0)}