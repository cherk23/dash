/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(n){window.report&&typeof report==typeof{}||(window.report={}),report.SecurityFilter=function(){this.lookups={network:{},client:{}},this.stats=null,this.init=function(t){var i=new SearchFilter({data:t,filter:this._make_filter()});_.extend(i,this);var e=i,r=i.checkboxHTML,r=[r("priority:1","High"),r("priority:2","Medium"),r("priority:3","Low")].join("");return i.container.find(".checkboxes").html(r),n(i).on("change:data",function(t,i){e._init_data_callback(i)}).on("change:results",function(t,i){e._filtered_callback(t,i)}),i._init_data_callback.apply(i,[t]),i.runNow(),i},this.set_lookups=function(t,i){this.lookups.network=t,this.lookups.client=i},this._init_data_callback=function(t){_.isArray(t)||(t=_.values(t||[])),this._calculate_stats(t),this._setup_advanced_search_html()},this._filtered_callback=function(t,i){i=this.stats.count!==i.length?"<b>"+pluralize(i.length,"match")+"</b> in "+this.stats.count:"<b>"+pluralize(this.stats.count,"attacks")+"</b>";this.container.siblings(".search_count").html(i)},this._make_filter=function(){var e=make_smart_filter();return e.addkw({"":function(t,i,e,r){return[r.getkw("priority")(t,i,e,r),r.getkw("signature")(t,i,e,r),r.getkw("client")(t,i,e,r),r.getkw("message")(t,i,e,r),r.getkw("protocol")(t,i,e,r),r.getkw("network")(t,i,e,r),r.getkw("source")(t,i,e,r),r.getkw("destination")(t,i,e,r)].join("||")},priority:function(t,i){return e.propmatch("priority",t,i,!1)},signature:function(t,i){return e.propmatch("signature",t,i,!1)},client:function(t,i){return e.propmatch("cli_key",t,i,!1)},message:function(t,i){return e.propmatch("message",t,i,!1)},protocol:function(t,i){return e.propmatch("protocol",t,i,!1)},network:function(t,i){return e.propmatch("ng_id",t,i,!1)},source:function(t,i){return e.propmatch("src_ip",t,i,!1)},destination:function(t,i){return e.propmatch("dest_ip",t,i,!1)}}),e.add_checkbox_partition("priority:1","-priority:1"),e.add_checkbox_partition("priority:2","-priority:2"),e.add_checkbox_partition("priority:3","-priority:3"),e},this._calculate_stats=function(t){var e=this;this.stats={count:t.length,ng_id:{},cli_key:{},src_ip:{},dest_ip:{},protocol:{},signature:{},priority:{}},_.each(t,function(t){_.each(t,function(t,i){e.stats[i]&&(t="dest_ip"===i||"src_ip"===i?t.split(":")[0]:t)&&(e.stats[i][t]||(e.stats[i][t]=0),e.stats[i][t]++)})})},this._setup_advanced_search_html=function(){var i=this;build_advanced_search_select("#network_search",this.stats.ng_id,function(t){return(i.lookups.network[t]||{name:""}).name}),build_advanced_search_select("#client_search",this.stats.cli_key,function(t){return i.lookups.client[t]}),build_advanced_search_select("#source_search",this.stats.src_ip),build_advanced_search_select("#destination_search",this.stats.dest_ip),build_advanced_search_select("#protocol_search",this.stats.protocol),build_advanced_search_select("#signature_search",this.stats.signature),this.container.find(".chosen-select").trigger("chosen:updated")}}}(jQuery);