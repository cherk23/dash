/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
var CIDR=function(n){var e,t={},_=n.split("/"),i=_[0],s=_[1]?-1===(e=_[1]).indexOf(".")?parseInt(e,10):function(n){for(var e=0,t=CIDR.netmasks.length;e<t;e++)if(CIDR.netmasks[e]==n)return e;return 0}(e):32,n=p(i),r=p(CIDR.netmasks[s]),u=o(n,r);return t.contains=function(n){return!!(s&&n.netmask_length()>=s)&&(n.netmask_length()&&u==o(p(n.ip()),r))},t.overlaps=function(n){return t.contains(n)||n.contains(this)},t.netmask_length=function(){return s},t.netmask=function(){return CIDR.netmasks[s]},t.ip=function(){return i},t.ip.to_i=function(){return CIDR.ip_s_to_i(i)},t.network=function(){return u},t.network.to_i=function(){return CIDR.ip_s_to_i(u)},t.size=function(){return Math.pow(2,32-s)},t.unparse=function(){return i+"/"+s},t.get_ip_ranges_after_excluding_subnets=function(n){ip_ranges=[[t.network.to_i()+1,t.network.to_i()+t.size()-2]];for(var e=0;e<n.length;e++)ip_ranges=function(n,e){excluded_subnet=CIDR(n),excl_first_ip=excluded_subnet.network.to_i(),excl_last_ip=excl_first_ip+excluded_subnet.size()-1,new_ip_ranges=new Array;for(var t=0;t<e.length;t++)subnet_begin=e[t][0],subnet_end=e[t][1],excl_first_ip<=subnet_begin&&excl_last_ip<=subnet_end&&excl_last_ip+1<subnet_end?new_ip_ranges.push([excl_last_ip+1,subnet_end]):excl_first_ip>=subnet_begin&&excl_last_ip>=subnet_end&&subnet_begin<excl_first_ip-1?new_ip_ranges.push([subnet_begin,excl_first_ip-1]):excl_first_ip>=subnet_begin&&excl_last_ip<=subnet_end&&(subnet_begin<excl_first_ip-1&&new_ip_ranges.push([subnet_begin,excl_first_ip-1]),excl_last_ip+1<subnet_end&&new_ip_ranges.push([excl_last_ip+1,subnet_end]));return new_ip_ranges}(n[e],ip_ranges);return ip_ranges.map(function(n){return CIDR.ip_i_to_s(n[0])+"-"+CIDR.ip_i_to_s(n[1])})},t;function p(n){return n.split(".").map(function(n){return parseInt(n,10)})}function o(n,e){return[n[0]&e[0],n[1]&e[1],n[2]&e[2],n[3]&e[3]].join(".")}};CIDR.netmasks=["0.0.0.0","128.0.0.0","192.0.0.0","224.0.0.0","240.0.0.0","248.0.0.0","252.0.0.0","254.0.0.0","255.0.0.0","255.128.0.0","255.192.0.0","255.224.0.0","255.240.0.0","255.248.0.0","255.252.0.0","255.254.0.0","255.255.0.0","255.255.128.0","255.255.192.0","255.255.224.0","255.255.240.0","255.255.248.0","255.255.252.0","255.255.254.0","255.255.255.0","255.255.255.128","255.255.255.192","255.255.255.224","255.255.255.240","255.255.255.248","255.255.255.252","255.255.255.254","255.255.255.255"],CIDR.ip_s_to_i=function(n){n=n.split(".");return 256*(256*(256*+n[0]+ +n[1])+ +n[2])+ +n[3]},CIDR.ip_i_to_s=function(n){for(var e=n%256,t=3;0<t;t--)e=(n=Math.floor(n/256))%256+"."+e;return e},CIDR.ip_i_or_null_to_s=function(n){return null==n?"":CIDR.ip_i_to_s(n)};