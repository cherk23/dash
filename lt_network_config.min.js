/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(o){var e,t,c,a,n,l,s;function i(){o("#nc_arg_select").html(""),o("#nc_arg_select_span").hide();var e=o("#nc_cmd_select").val();"ip"==c?(o("#nc_arg_select").html(""),o("#nc_addr_span").hide(),"route"==e?(o("#nc_arg_select_span").show(),o.each(["list table all","get"],function(e,t){o("#nc_arg_select").append(o("<option />",{value:t,text:t}))})):"xfrm"==e&&(o("#nc_arg_select_span").show(),o.each(["state","policy"],function(e,t){o("#nc_arg_select").append(o("<option />",{value:t,text:t}))}))):"birdc"==c&&"show ospf"==e&&(o("#nc_arg_select_span").show(),o.each(["state","neighbors"],function(e,t){o("#nc_arg_select").append(o("<option />",{value:t,text:t}))}))}function r(){c=o("#nc_tool_select").val(),o(".nc_hideable_opt").hide(),o(".nc_"+c).show(),o("#nc_cmd_select").html("");o.each({swctl:["linkneg","stats"],broboctl:["port read","stats read"],racoonctl:["flush","show"],ip:["route","xfrm","rule","neighbor","link","addr"],ethtool:[],wl:[],iwconfig:[],ifconfig:[],birdc:["show status","show route","show ospf"]}[c],function(e,t){o("#nc_cmd_select").append(o("<option />",{value:t,text:t}))});var e=Mkiconf.feature_versions[c];e?o("#nc_firmware_warning_version").text("builds before "+e+"."):o("#nc_firmware_warning_version").text("old firmware.")}function d(){lt_network_config.stop(),live_toolbox.set_tool_status(lt_network_config,!0),e=c,(a=o("#nc_history").is(":checked"))||o("#nc_textarea").text(""),o("#nc_popout_button").show(),s={broker:"CommandFetch",command:e,filter:o("#nc_filter").val()},"ifconfig"==e||"iwconfig"==e?t=o.comet.command_subscribe(_.extend(s,{interface:o("#nc_interface").val()}),p):"wl"==e?t=o.comet.command_subscribe(_.extend(s,{interface:o("#nc_interface").val(),cmd:o("#nc_cmd").val()}),p):"swctl"==e?t=o.comet.command_subscribe(_.extend(s,{interface:o("#nc_interface").val(),cmd:o("#nc_cmd_select").val(),arg:o("#nc_arg").val()}),p):"broboctl"==e?t=o.comet.command_subscribe(_.extend(s,{interface:o("#nc_interface").val(),cmd:o("#nc_cmd_select").val().split(" ")[0]}),p):"racoonctl"==e?(s[o("#nc_cmd_select").val()]=o("#nc_protocol_select").val(),t=o.comet.command_subscribe(s,p)):"ethtool"==e?t=o.comet.command_subscribe(_.extend(s,{interface:o("#nc_interface").val(),ethFlag:o("#nc_flag_select").val()}),p):"birdc"==e?(s.cmd=o("#nc_cmd_select").val(),s.arg=o("#nc_arg_select").val(),t=o.comet.command_subscribe(s,p)):"ip"==e&&(t=o.comet.command_subscribe(_.extend(s,{cmd:o("#nc_cmd_select").val(),arg:o("#nc_arg_select").val(),addr:o("#nc_addr").val()}),p))}function p(e){var t=o("#nc_textarea");l=new Date;var c=(n=l,n=unparse_date(n,"%b %-d %H:%M:%S %Z"),o("#nc_last_fetched").text("Completed at "+n),n),n=e.data.chunk;a&&t.append("\n\n---- Fetched at "+c+" ----\n"),n&&0<n.length&&(c=a?t.text():"",t.text(c+n)),e.data.completed&&lt_network_config.stop()}function u(){var e=o("#lt_network_config_popout").clone(),t=o("link[href*='manage.css?mtime'").clone();e.prepend(t),e.find("#nc_popout_tool").html(s.command),e.find("#nc_popout_last_seen").html(unparse_date(l,"%b %-d %H:%M:%S %Z")),e.find("#nc_popout_filter").html(s.filter),e.find("#nc_popout_contents").html(o("#nc_contents").html());t=e.find("#nc_textarea");t.attr("id","nc_popout_textarea"),t.height("calc(100% - 37px)").width("calc(100% - 5px)"),(n=window.open("","_blank","height=600,width=1000,status=yes,toolbar=no,menubar=no,location=no")).document.write(e.html()),n.document.title=s.command+"_"+l}window.lt_network_config={},lt_network_config.init=function(e){tool_html=o("#lt_network_config_tmpl").tmpl().appendTo(e),o("#new_nc").click(d),o("#lt_network_config_popout").hide(),o("#nc_popout_button").hide(),o("#nc_popout_button").click(u),o("#lt_nc_tool input").keyup(function(e){if(e.which==o.ui.keyCode.ENTER)return d(),!1});e=["ifconfig","ip"];s3node&&!s3node.is_switch&&e.push("iwconfig"),Mkiconf&&Mkiconf.supports_wl&&e.push("wl"),Mkiconf&&Mkiconf.has_wired&&e.push("swctl","ethtool","broboctl","racoonctl","birdc"),o.each(e,function(e,t){o("#nc_tool_select").append(o("<option />",{value:t,text:t}))}),o("#nc_tool_select").chosen({placeholder_text:"Select tool"});o.each(["","-S","-h"],function(e,t){o("#nc_flag_select").append(o("<option />",{value:t?t.split("-")[1]:"",text:t||"no flag"}))});o.each(["esp","isakmp"],function(e,t){o("#nc_protocol_select").append(o("<option />",{value:t,text:t}))}),o("#nc_arg").focus(function(){var e=["enable","disable","flush","read"];o(this).typeahead({source:function(){return"swctl"==c&&"stats"==o("#nc_cmd_select").val()?e:[]}})}),o("#nc_cmd").focus(function(){var e=["chanspec","curpower","rateset","country","dump perf_stats","ssid","cca_get_stats","cur_etheraddr","interference","counters","status","channels","msglevel"];o(this).typeahead({source:function(){return"wl"==c?e:[]}})}),r(),i(),o("#nc_tool_select").change(r),o("#nc_tool_select").change(i),o("#nc_cmd_select").change(i),o("#nc_arg_select").change(function(){o("#nc_addr_span").hide(),"get"==o("#nc_arg_select").val()&&o("#nc_addr_span").show()}),dashhelp("network_config_help","#lt_nc_header",{above:!0}),dashhelp("live_tool_filter_help","#nc_filter_span label")},lt_network_config.stop=function(){t&&t.stop(),e=null,live_toolbox.set_tool_status(lt_network_config,!1)}}(jQuery);