/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(a){var t;function e(){selected_tool=a("#tc_tool_select").val(),a(".tc_hideable_opt").hide(),"ldapsearch"==selected_tool?(a("#tc_ldap_flags_span").show(),a("#tc_ldapuri_span").show(),a("#tc_binddn_span").show(),a("#tc_passwd_span").show(),a("#tc_searchbase_span").show(),a("#tc_filter_span").show()):"wmilogons"==selected_tool?(a("#tc_debug_level_span").show(),a("#tc_user_span").show(),a("#tc_password_span").show(),a("#tc_addr_span").show(),a("#tc_firmware_warning").show()):"ad_dump_db"==selected_tool&&a("#tc_firmware_warning").show();var t=Mkiconf.feature_versions[selected_tool];t?a("#tc_firmware_warning_version").text("builds before "+t+"."):a("#tc_firmware_warning_version").text("old firmware.")}function o(){lt_test_credentials.stop(),live_toolbox.set_tool_status(lt_test_credentials,!0),curr_tool=selected_tool,store_history=a("#tc_history").is(":checked"),store_history||a("#tc_textarea").text(""),"wmilogons"==curr_tool?t=a.comet.command_subscribe({broker:"CommandFetch",command:curr_tool,debug_level:a("#tc_debug_level").val(),user:a("#tc_user").val(),passwd:a("#tc_password").val(),addr:a("#tc_addr").val()},s):"ldapsearch"==curr_tool?(params={broker:"CommandFetch",command:curr_tool,ldapuri:a("#tc_ldapuri").val(),binddn:a("#tc_binddn").val(),passwd:a("#tc_passwd").val(),searchbase:a("#tc_searchbase").val(),filter:a("#tc_filter").val()},_.each(["#tc_flag_x","#tc_flag_zz"],function(t){a(t)[0].checked&&(params[a(t).val()]=1)}),t=a.comet.command_subscribe(params,s)):"ad_dump_db"==curr_tool&&(t=a.comet.command_subscribe({broker:"CommandFetch",command:curr_tool},s))}function s(t){var e=a("#tc_textarea"),_=(o=new Date,o=unparse_date(o,"%b %-d %H:%M:%S %Z"),a("#tc_last_fetched").text("Completed at "+o),o),o=t.data.chunk;store_history&&e.append("\n\n---- Fetched at "+_+" ----\n"),o&&0<o.length&&(_=store_history?e.text():"",e.text(_+o)),t.data.completed&&lt_test_credentials.stop()}window.lt_test_credentials={},lt_test_credentials.init=function(t){a("#lt_test_credentials_tmpl").tmpl().appendTo(t),a("#tc_run").click(o),a("#lt_tc_tool input").keyup(function(t){if(t.which==a.ui.keyCode.ENTER)return o(),!1}),a.each(["ldapsearch","wmilogons","ad_dump_db"],function(t,e){a("#tc_tool_select").append(a("<option />",{value:e.split(" "),text:e}))}),a("#tc_tool_select").chosen({placeholder_text:"Select tool"}),e(),a("#tc_tool_select").change(e),dashhelp("test_credentials_help","#lt_tc_header",{above:!0}),dashhelp("live_tool_filter_help","#tc_filter_span")},lt_test_credentials.stop=function(){t&&t.stop(),t=null,live_toolbox.set_tool_status(lt_test_credentials,!1)}}(jQuery);