/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
function make_smart_filter(){var o={"":function(){return"false"}},t={},s={false:0,true:1},h={},p={},g={},m=1,a=2,d=0,c=1,x=3,v=4,w=5;function l(e){var r,t,n;for(r in p){if(0==((t=p[r])&e))return 0;(t|e)===m&&(n=t)}return n}function f(e,r,t){var n;return e===x?void 0===(n=l(r))?-2&m:n?r^n:m:e===v?r&t:e===w?void 0!==l(r&t)?r|t:-2&(r|t):r}function k(e,r,t){var n,u,i,l,a;if(!(u=(r=jQuery.trim(r)).match(/^(\(|(?:[^\(\)\"\s]|\"[^\"]*\"?)+)(.*)$/)))return[r,null,0];if("("===u[1])return b(e,r.substr(1),t,!0);if("NOT"===u[1]&&u[2]&&1<u[1].length)return(n=k(e,u[2],t))[1]?[n[0],[x,n[1]],f(x,n[2])]:n;if(":"===u[1].charAt(u[1].length-1)&&(a=o[u[1].slice(0,u[1].length-1)])&&(n=u[2].match(/^\s*(\(|(?:[^\(\)\"\s]|\"[^\"]*\"?)+)(.*)$/)))if("("===n[1]){if(!a.take_expr||t.kwprefix)return l=t.kwprefix,t.kwprefix+=u[1],n=k(e,u[2],t),t.kwprefix=l,[n[0],n[1]&&[c,u[1],n[1]],n[2]];n=function(e){for(var r,t=e,n=0;(r=t.match(/^\s*(\(|\)|(?:[^\(\)\"\s]|\"[^\"]*\"?)+)(.*)$/))&&("("===r[1]?++n:")"===r[1]&&--n,t=r[2],0!==n););return[e.slice(0,e.length-t.length),t]}(u[2]),u[1]+=n[0],u[2]=n[1]}else"OR"!==n[1]&&"AND"!==n[1]&&(u[1]+=n[1],u[2]=n[2]);return i="",(n=(r=t.kwprefix+u[1]).match(/^(.*?)(:|[=<>]=?|!=)(.*)$/))&&o[n[1]]&&(i=n[1],r=":"==n[2]||"="==n[2]||"=="==n[2]?n[3]:n[2]+n[3]),(a=o[i]).take_expr||a.case_sensitive||(r=r.toLowerCase()).match(/^\".*[^\"]$/)&&(r+='"'),l=a(r,t,e,A),void 0===(e=s[l])&&(e=-2&m),[u[2],[d,l,u[1]],e]}function $(e,r,t){return 1===r.length?[e,null,0]:2===r.length?[e,r[1],t]:[e,r,t]}function b(e,r,t,n){for(var u,i=[w],l=0;""!==(r=jQuery.trim(r));)if(")"===r.charAt(0)){if(r=r.substr(1),n)break}else r=r.match(/^OR(?: |$)/)?r.substr(2):((u=function(e,r,t){for(var n,u=[v],i=m;""!==(r=jQuery.trim(r));)if((n=r.match(/^(\)|OR(?=[ \)]|$)|AND(?=[ \)]|$))(.*)$/))&&"AND"===n[1])r=n[2];else{if(n)break;(n=k(e,r,t))[1]&&(u.push(n[1]),i&=n[2]),r=n[0]}return $(r,u,i)}(e,r,t))[1]&&(i.push(u[1]),l=f(w,l,u[2])),u[0]);return $(r,i,l)}function y(e){var r,t,n;if(e[0]===d)return e[2];for(r=1+(e[0]<x),t=[];r<e.length;++r)n=y(e[r]),t.push(e[r][0]>e[0]?"("+n+")":n);return t=t.join(e[0]>v?" OR ":" "),((n=[null,e[1],null,"-"][e[0]])||"")+t}function j(e){var r,t;if(e[0]===d)return e[1];for(r=1+(e[0]<x),t=[];r<e.length;++r)t.push(j(e[r]));return e[0]===x?"!("+t.join("")+")":1===t.length?t[0]:"("+t.join(e[0]>v?")||(":")&&(")+")"}function O(e){var r,t,n;if(e[0]===d)return void 0!==(t=s[e[1]])?[2,t,null]:e;for(t=(e=e.slice(0))[0]===w?0:m,r=1+(e[0]<x);r<e.length;++r)e[r]=O(e[r]),n=2===e[r][0]?e[r][1]:-2&m,t=f(e[0],n,t),e[0]===w||2!==e[r][0]||t===(-2&m)||(e[r]=e[r][2])||(e.splice(r,1),--r);return e[0]===w&&1&t?e=[w]:e[0]===w&&t!==(-2&m)&&function(e,r){var t,n;for(n=~r&m&-2,t=1;t<e.length;++t)if(e[t][1]===r){for(t=1;t<e.length;++t)e[t][1]!==(1|r)&&(e[t][1]|=n,(1|e[t][1])!==m||(e[t]=e[t][2])||(e.splice(t,1),--t));break}}(e,t),e.length===1+(e[0]<x)?[2,t,null]:t!==(-2&m)?[2,t,e]:e}function R(e){var r=jQuery.extend({kwprefix:"",helpers:[]},t);return e&&(r.items=e),r}function A(e,r){var t,n,u=R(),i={checkbox:{}};if(r.match(':""')||r.match(":''")){var l=r.replace(":''",':""').split(':""');if(_.isEmpty(_.compact(l)))return i.items=e,i.filtered=!1,i;var l=_.initial(_.map(l,function(e){var r=_.max([_.lastIndexOf(e,"("),_.lastIndexOf(e," ")]);return e.slice(r+1)})),a=_.map(l,function(e){return o[e]?o[e]("",0).split('"')[1]:""}),c=function(r){var t=!0;return _.each(a,function(e){""!==r[e]&&null!==r[e]&&(t=!1)}),t},f=0}else f=null!=r&&""!==r?((r=b(e,r,u))[1]&&(c=build_func("function (x) { var t; return "+j(r[1])+" }",u)),r[2]):m;for(t in h)i.checkbox[t]=0!=(f&h[t]);if(u.unready)i.unready=u.unready;else for(t in i.items=[],i.filtered=!1,e)n=e[t],!c||c(n)?i.items.push(n):i.filtered=!0;return i}function i(e){return"x"+_.map(e.split("."),function(e){return"['"+e+"']"}).join("")}return A.addkw=function(e){jQuery.extend(o,e)},A.getkw=function(e){return o[e]},A.mvars=function(){return R()},A.addmvars=function(e){jQuery.extend(t,e)},A.propmatch=function(e,r,t,n){e=i(e);return A.result_match(e,r,t,n)},A.outages_updated_at=function(e,r,t){var n=i(e),u=n+"&&",e=r.split("-");if(2!=e.length)return"true";r=((new Date).getTime()-864e5*parseInt(e[0]))/1e3,e=((new Date).getTime()-864e5*parseInt(e[1]))/1e3;return"("+u+n+".toString().replace(/[\"]/g, '') < "+r.toString()+"&&"+n+".toString().replace(/[\"]/g, '') > "+e.toString()+")"},A.result_match=function(e,r,t,n){var u=e+"&&";if(0<=r.indexOf("*")){var i=(i=r.replace(/[\\\"]/g,"")).replace(/[\[\]\\^$*+?.()|{}]/g,function(e){return"*"===e?".*":"\\"+e});return t.helpers.push(new RegExp(i,n?"":"i")),"("+u+"helpers["+(t.helpers.length-1)+"].test("+e+"))"}return"("+u+A.index_of_match(e,r,n)+")"},A.index_of_match=function(e,r,t){r='"'+r.replace(/[\\\"]/g,"")+'"';return t?e+".indexOf("+r+") !== -1":e+'.toString().toLowerCase().replace(/[\\"]/g, "").indexOf('+r.toLowerCase()+") !== -1"},A.simple_pm=function(t){return function(e,r){return A.propmatch(t,e,r,!1)}},A.exact_pm=function(n,u){return function(e,r){var t='x["'+n+'"]&&';return e=e.replace(/[\\\"]/g,""),u?t+'x["'+n+'"] == "'+e+'"':(e=e.toLowerCase(),t+'x["'+n+'"].toString().toLowerCase() == "'+e+'"')}},A.contains_pm=function(e,r,t){var n,u=(n="x",_.map(e.split("."),function(e){return n+="['"+e+"']"})),i=_.last(u);u.push("_.isArray("+i+")");var l=r?"":"i";return function(e,r){e=regexp_escape(e);t&&(e="^"+e+"$"),r.helpers.push(new RegExp(e,l));r=r.helpers.length-1;return u.concat(["_.any("+i+", function(_el) { return helpers["+r+"].test(_el); })"]).join("&&")}},A.ids=function(e,r,t,n){var u,i,l,a=[],c=(t=t||R()).helpers,r=b(e,r,t);for(i in t.helpers=c,r[1]&&(u=build_func("function (x) { var t; return "+j(r[1])+" }",t)),e||{})u&&!u(e[i])||a.push(i);if("r"===n)return 0==a.length?new RegExp("(?!.*)"):new RegExp("\\b("+a.join("|")+")\\b");if("h"!==n)return a;for(i in l={},a)l[a[i]]=!0;return l},A.add_checkbox_partition=function(){var e,r,t,n,u=0,i=0,l=arguments;if(0!=(l=1==l.length&&"object"==typeof l[0]?l[0]:l).length){for(e in p)u|=p[e];for(e=0;e<l.length;++e)i|=t=a,a<<=1,r=b(null,n=l[e],R()),s[j(r[1])]=t|u|1,s[t]=n,h[n]=t;for(e in 1==l.length&&(i|=a,a<<=1),p[l[0]]=i,s)e.match(/^[0-9]+$/)||!s[e]||s[e]&i||(s[e]|=i);m|=i}},A.add_checkbox_synonym=function(e,r){var t,n,u=0,i=b(null,r,R()),r=O(i[1]);if(!r||2!==r[0]||r[2]||!(n=l(r[1])))throw new Error("y");for(t in r=r[1]&n,p)p[t]!==n&&(u|=p[t]);i=b(null,e,R()),s[j(i[1])]=r|u|1,s[r]=e,h[e]=r},A.set_checkbox_live=function(e,r){e=h[e];r?delete g[e]:g[e]=!0},A.change_checkbox=function(e,r,t){var n;if((n=!(n=""!==e?O((n=b(null,e,R()))[1]):n)||2!==n[0]?[2,m,n]:n)[1]|=1,null==(r=h[r]))throw new Error("y");return t?n[1]|=r:n[1]&=~r,(n=function e(r){var t,n,u,i,l,a,c,f;if(!r||r[0]===d)return r;for(t=1+(r[0]<x);t<r.length;++t)(r[t]=e(r[t]))||(r.splice(t,1),--t);if(1===r.length)return null;if(r[0]>=v&&2===r.length)return r[1];if(2!==r[0])return r;for(t in f=R(),c=[],p)if((u=p[t])&&(i=r[1]&u)!==u){for(l=[],a=[],n=1;n<u;n<<=1)u&n&&s[n]&&!g[n]&&(i&n?l.push(k(null,s[n],f)[1]):a.push(k(null,"-"+s[n],f)[1]));a.length&&(a.length<l.length||!l.length?c=c.concat(a):c.push(1===l.length?l[0]:[w].concat(l)))}return 0===c.length?r[2]:r[2]&&r[2][0]!==v?[v,r[2]].concat(c):1!==c.length||r[2]?(r[2]||[v]).concat(c):c[0]}(n))?y(n):""},A.addprim=function(e,r,t){var n,u,i=R(),l=(n=!(n=""!==e&&(n=b(null,e,i)[1])[0]===d?[v,n]:n)||n[0]!==v?[v].concat(n?[n]:[]):n).length;if(t)for(u=1;u<n.length;++u)n[u][0]===d&&t.test(n[u][2])&&(n.splice(u,1),l=u,--u);return r&&n.splice(l,0,b(null,r,i)[1]),y(n)},A.findprim=function(e,r,t){var n,u,i=R(),l=[],a=[v];for((n=""!==e&&(n=b(null,e,i)[1])[0]===d?[v,n]:n)&&n[0]===v||(n=[v].concat(n?[n]:[])),u=1;u<n.length;++u)n[u][0]===d&&r.test(n[u][2])?l.push(n[u][2]):a.push(n[u]);return t?{matches:l,rest:y(a)}:l},A}function make_smart_filter_match_ip(){var i=arguments;return function(e,r){var t,n,u=make_smart_filter_match_ip_base_template(e,r);if(null==u)return"false";for(n=0,t="";n<i.length;++n)m=u.replace("%","x['"+i[n]+"']"),t+=0==n?m:"||(x['"+i[n]+"']&&"+m+")";return t}}function make_smart_filter_match_ip_base_template(e,r){var t,n;if(t=(e=e.replace(/[\\\"]/g,"")).match(/^([\d.]+)\/(\d+)$/))n='show3_cidr_match(%, "'+t[1]+'", '+parseInt(t[2],10)+")";else if(e.match(/^\d+\.\d+\.\d+\.\d+$/))n='%==="'+e+'"';else if(e.match(/^[\d.]+$/)){var u="."===e.charAt(0),i="."===e.charAt(e.length-1);e=e.replace(/\./g,"\\."),u||(e=(i?"^":"(?:^|\\.)")+e),i||(e+=u?"$":"(?:$|\\.)"),r.helpers.push(new RegExp(e)),n="helpers["+(r.helpers.length-1)+"].test(%)"}else{if(!(t=e.match(/^([\d.]*)\*([\d.]*)$/)))return null;t[1]=t[1].replace(/\.$/,""),t[2]=t[2].replace(/^\./,""),e="."===t[1].charAt(0)?"^.*":"^",e+=t[1].replace(/\./g,"\\.")+"(?:$|\\.).*",e+=(""===t[2]?"":"\\.")+t[2].replace(/\./g,"\\."),r.helpers.push(new RegExp(e+"$")),n="helpers["+(r.helpers.length-1)+"].test(%)"}return n}function smart_filter_match_usage(i,l){return function(e,r){var t,n,u="usage"==i?(n=null==l?"(x.usage[0]+x.usage[1])":"x.usage["+l+"]",1024):null!=l?(n='((x["'+i+'"]||[])['+l+"]||0)",1024):(n='(x["'+i+'"]||0)',1),e=e.match(/^([<>=]?=?)\s*((?:\d+\.?\d*|\.\d+)\s*[kmgt]?(?:B|Bytes?)?)$/i);return!e||"="!==e[1]&&"=="!==e[1]&&""!==e[1]?e?(t=parse_size(e[2],e[1])/u,n+e[1]+t):"false":"(t="+n+",t>="+.9*(t=parse_size(e[2],">=")/u)+"&&t<="+1.1*t+")"}}