/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
Mkiconf=window.Mkiconf||{},Mkihelp=window.Mkihelp||{};var EPOCH_WARNING_TS=13e10,IPV4_ADDR_REGEXP=/^\s*(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}\s*$/,IPV6_ADDR_REGEXP=/^\s*((?:[a-fA-F\d]{1,4}:){7}(?:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(:[a-fA-F\d]{1,4}){1,2}|:)|(?:[a-fA-F\d]{1,4}:){4}(?:(:[a-fA-F\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(:[a-fA-F\d]{1,4}){1,3}|:)|(?:[a-fA-F\d]{1,4}:){3}(?:(:[a-fA-F\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(:[a-fA-F\d]{1,4}){1,4}|:)|(?:[a-fA-F\d]{1,4}:){2}(?:(:[a-fA-F\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(:[a-fA-F\d]{1,4}){1,5}|:)|(?:[a-fA-F\d]{1,4}:){1}(?:(:[a-fA-F\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(:[a-fA-F\d]{1,4}){1,6}|:)|(?::((?::[a-fA-F\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,7}|:)))(%[0-9a-zA-Z]{1,})?\s*$/;function setup_time(e,t,n){var r,a,i=$.now()/1e3;e=e||2592e3,t=t||86400,r=+(n=n||{}).t0,a=+n.t1,t=r&&a?a-r:0<+n.timespan?+n.timespan:0<r?i-r:t,t=Math.min(t,e),a=a||(0<r?r+t:i),Mkiconf.timespan=parseInt(t),Mkiconf.t1=parseInt(Math.min(a,i)),Mkiconf.t0=parseInt(Mkiconf.t1-Mkiconf.timespan)}function add_url_param(e,t,n){var r,a=document.createElement("a"),i=/(?:\?|&amp;|&)+([^=]+)(?:=([^&]*))*/g,o=[];for(a.href=e,t=encodeURIComponent(t);r=i.exec(a.search);)t!=r[1]&&o.push(r[1]+(r[2]?"="+r[2]:""));return o.push(t+(n?"="+encodeURIComponent(n):"")),a.search=o.join("&"),a.href}function sticky_action_bar(){$(function(){var n=$(".action_bar"),r=n.position().top,a=0;$(window).scroll(function(){var e,t=Date.now();20<t-a&&($(n).toggleClass("sticky_action_bar",window.scrollY>r),e=$(n).parent().width(),$(n).css("width",e+"px"),a=t)}),$(window).resize(function(){var e;$(n).hasClass("sticky_action_bar")&&(e=$(n).parent().width(),$(n).css("width",e+"px"))})})}function tooltipScrollPlacement(e,t){t=$(t).position();return window.scrollY>t.top?"bottom":"top"}function node_group_name_to_tag(e){e=_.first(e.replace(/[-\s]+/g,"-").replace(/[^-_.:a-zA-Z0-9\u0080-\u00FF]/g,""),16);return 2===e.length?e.push("_"):1===e.length?(e.push("_"),e.unshift("_")):0===e.length&&(e=["_","_","_"]),e.join("")}function url_for(e){var t,n="",r=e.shard_id||e.organization&&e.organization.shard_id,a=r?1===r&&-1!==Mkiconf.shard_origin_url.indexOf("dev%SHARD_NUMBER%.meraki.com")?Mkiconf.shard_origin_url.replace("%SHARD_NUMBER%",""):Mkiconf.shard_origin_url.replace("%SHARD_NUMBER%",r):"/";e.global?t="":e.node_group?t=((r=!(r=e.scala_project||e.node_group.tag||e.node_group.t)&&e.node_group.name?node_group_name_to_tag(e.node_group.name):r)||"")+"/n/"+(e.node_group.eid||e.node_group.id)+"/":e.organization?t=(e.scala_project?e.scala_project+"/":"")+"o/"+e.organization.eid+"/":(t=(Mkiconf.base_url||"/").substring(1),e.scala_project&&((i=t.split("/")).shift(),i.unshift(e.scala_project),t=i.join("/")));var i=e.controller;if(e.action&&!i&&(i=Mkiconf.controller_name),e.action&&"index"!=e.action&&(o=e.action),e.id){if(_.isEmpty(i))throw"url_for: `id` was passed without `controller`.";if(_.isEmpty(o))throw"url_for: `id` was passed without `action`."}if(o&&_.isEmpty(i))throw"url_for: `action` was passed without `controller`.";var i=_.compact([e.global||i&&("/"===i[0]||0===i.indexOf("manage/"))?"":"manage",i,o,e.id]).join("/"),o=_.extend(_.omit(e,"global","shard_id","node_group","controller","action","id","anchor","organization","params","scala_project"),e.params);return 0<_.size(o)&&(n="?"+$.param(o)),e.anchor&&(_.isString(e.anchor)?n+="#"+e.anchor:_.isObject(e.anchor)&&(n+="#"+$.param(e.anchor))),_.escape(a)+(_.escape(t)+_.escape(i)).replace(/\/+/g,"/").replace(/^\//,"")+n}function url_for_node_group(e,t){var n={};return t&&e.network_type==Mkiconf.network_type&&(n={controller:Mkiconf.controller_name,action:Mkiconf.action_name},0<$("#vpn_status_page").length&&"wired"==e.network_type&&(n.id=e.eid),"bgp_routers"===Mkiconf.controller_name&&(n={controller:"switches",action:"bgp_routers"})),url_for(_.extend({node_group:e},n))}function url_for_organization(e,t){return url_for({organization:e,controller:(t=t||{}).controller_name||"organization",action:t.action_name||"overview"})}function url_for_client(e){return Mkiconf.client_show_url.replace(/%23|%2523/,e)}function url_for_node(e){if(!Mkijson.n||!Mkijson.n.hash||!Mkijson.n.hash[e])return url_for({controller:"nodes",action:"show",id:e});var t=Mkijson.n.hash[e],n=t.product_type||Mkiconf.network_type;return Mkiconf[n]?"wired"==t.product_type?t.is_spare?url_for({node_group:Mkiconf[n],controller:"nodes",action:"new_spare_status"}):url_for({node_group:Mkiconf[n],controller:"nodes",action:"wired_status"}):url_for({node_group:Mkiconf[n],controller:"nodes",action:"list",anchor:{n:e}}):url_for({controller:"nodes",action:"show",id:e})}function url_for_switch_profile(e,t){return url_for({controller:"switch_profiles",action:e,node_group:t})}function url_for_ng_and_node(e,t){return url_for({controller:"nodes",action:"list",node_group:t,anchor:"n="+e})}function url_for_ng_and_switchport(e,t,n){return url_for({controller:"nodes",action:"list",node_group:n,anchor:"n="+e+"&port="+t})}function url_for_switchport(e,t){return url_for({controller:"nodes",action:"new_list",node_group:Mkiconf.switch,id:e})+"/"+switchport.child_path_from_port_identifier(t)+location.search}function link_for_client(e,t){return link_to(url_for_client(e),t)}function is_mki_mac(e){return/00:18:0A/i.test(e)}function node_pin_image_url(e,t){return map_image_url("pin",e,t)}function node_repeater_image_url(e,t){return map_image_url("repeater",e,t)}function node_cluster_image_url(e,t){return map_image_url("cluster",e,t)}function map_image_url(e,t,n){return Mkiconf.images+_.compact(["map/map-"+e,["green","yellow","red"][t]||"gray",n]).join("-")+".png"}function node_is_on_floorplan(e){return!("undefined"==typeof floorplan_placements||!floorplan_placements)&&(floorplan_placements[e]&&0<_.keys(floorplan_placements[e]).length)}function calc_node_health(e){var t=e["status#"],n=e.mtun_gws_cache,r=e.dormant,e=null===t||isNaN(t);return t=null==(t="t"==r||e&&!n?3:e?0===(n=MKI.node_health_status[MKI.mtunnel_state_lookup[n]])?2:1===n?0:2===n?1:3:t<4?t:3)?3:t}function show_table(e,t){var r=$("<table class='show_table'>");return e&&(e="string"==typeof e?$("<h3>").html(e):e,t&&(e=e.add(t)),$("<tr><td colspan='2'></td></tr>").appendTo(r).find("td").html(e)),r.gap=function(){r.row("","&nbsp;")},r.row=function(e,t,n){if(t){e&&(e+=":");e=$("<tr><td>"+e+"</td><td></td>");return e.find("td:last-child").html(t),n&&e.addClass("adminhighlight"),r.append(e),e}},r.double_wide=function(e){var t=$("<tr><td colspan='2'></td></tr>");return t.find("td").html(e),r.append(t),t},r.center=function(e){var t=$("<tr><td colspan='2' class='center'></td></tr>");return t.find("td").html(e),r.append(t),t},r}function name_for_node(e,t){e=Mkijson.n.hash[e];return e&&!t&&(t=e.name||e.mac),t=e&&!t&&"wired"==e.product_type?"Security appliance":t}function link_for_node(e,t){return link_to(url_for_node(e),name_for_node(e,t))}function link_for_switch_profile(e,t,n){return link_to(url_for_switch_profile(e,n),t)}function link_for_stack(e,t){var n=url_for({controller:"configure",action:"switch_stacks"});return link_to(n+="/"+e+"/",t)}function link_to(e,t){return"<a href='"+e+"'>"+t+"</a>"}function ip_and_nm_to_subnet(e,t){for(var n=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/),r=[],a=0;a<4;a++){var i=-1<<8-Math.min(Math.max(t-8*a,0),8);r[a]=n[a+1]&i}return r.join(".")+"/"+t}function ip_in_subnet(e,t){if(!_.isString(e)||!_.isString(t))return!1;var n=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/),r=t.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)\/(\d+)$/),a=+r[5];if(!n||!r)return!1;for(var i=0;i<4;i++){var o=+n[i+1],s=-1<<8-Math.min(Math.max(a-8*i,0),8);if((o&s)!=(+r[i+1]&s))return!1}return!0}function rssi_bar(e){e=e/40*100;return"<div class='rssi_bar'><div style='width:"+(e=Math.min(e,100))+"%'></div></div>"}function any_true(e,t){return _.any(e,function(e){return e[t]})}function has_none(e,t){return _.isEmpty(e[t])}function build_network_selector(r){var e,t,n,a,i;Mkiconf.administered_orgs&&Mkiconf.administered_orgs[r]&&((e=$("#select_network")).attr("notranslate",!0),e.html($("#network_selector_tmpl").tmpl({org_id:r||Mkiconf.org_id})),any_true(Mkiconf.administered_orgs[r].node_groups,"is_config_template")&&(t="<optgroup label='Select a template'>",_.each(build_network_selector.make_network_array(Mkiconf.administered_orgs[r],{is_config_template:!0}),function(e){t+="<option value='"+Mkiconf.org_id+","+e.type+"-"+e.id+"'",e.sel&&(t+="selected='selected'"),t+=" class='notranslate'>"+e.name+"</option>"}),t+="</optgroup>",e.append(t)),has_none(Mkiconf.administered_orgs[r],"node_groups")||(n="<optgroup label='Select a network'>",_.each(build_network_selector.make_network_array(Mkiconf.administered_orgs[r],{is_config_template:!1}),function(e){n+="<option value='"+Mkiconf.org_id+","+e.type+"-"+e.id+"'",e.sel&&(n+="selected='selected'"),n+=" class='notranslate'>"+e.name+"</option>"}),n+="</optgroup>",e.append(n)),a=2<=e.find("option").length,e.toggle(a),i=!Mkiconf.administered_orgs||_.size(Mkiconf.administered_orgs)<=1,e.siblings("label").toggle(a&&i),e.off("change.build").on("change.build",function(){var e,t,n;$(this).val()&&$(this).val().match(/^\//)?window.location.href=$(this).val():(n=$(this).val()?$(this).val().split(","):[r],e=Mkiconf.administered_orgs[n[0]],(n=(n[1]||"").match(/(locale|ng)-(.*)/))?(t="locale"==n[1]?(t=(t=e.locales[n[2]])[Mkiconf.network_type]||t.wireless||t.wired||t.switch||t.camera,e.node_groups[t]):e.node_groups[n[2]],n=-1===$.inArray(Mkiconf.controller_name,["users","organization"]),window.location.href.match(/msp_portal/g)&&(n=!1),window.location.href=url_for_node_group(t,n)):window.location.href=url_for({organization:e,controller:"organization",action:"overview"}))}))}function regexp_escape(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function wrap_space_quotes(e){return e=-1!==e.indexOf(" ")?'"'+e+'"':e}function strip_quotes(e){return e.replace(/["]/g,"")}function replace_double_quotes_for_csv(e){return e.replace(/\"/g,"'")}function latlng_for(e,t,n,r){var a=Math.PI/180,i=e*a,e=t*a,t=-Math.atan2(n,r)+Math.PI/2,n=Math.sqrt(r*r+n*n)/(2*Math.PI*6378137)*2*Math.PI;return[Math.asin(Math.sin(i)*Math.cos(n)+Math.cos(i)*Math.sin(n)*Math.cos(t))/a,(Math.atan2(Math.sin(n)*Math.sin(t),Math.cos(i)*Math.cos(n)-Math.sin(i)*Math.sin(n)*Math.cos(t))+e)/a]}function distance_between_lat_lng_in_meters(e,t,n,r){var a=Math.PI/180;return e*=a,t*=a,n*=a,r*=a,6378137*Math.sqrt(Math.cos(e)*Math.cos(n)*((t-r)*(t-r))+(e-n)*(e-n))*(1-.0033493*Math.sin(e+n/2)*Math.sin(e+n/2))}function dismiss_new_features(){$.get(url_for({controller:"support",action:"dismiss_new_features"}))}function dismiss_auth_info_exposure_flash(){$.post(url_for({controller:"dashboard",action:"disable_user_feature"}),{feature:"has_auth_information_exposure"})}function position_horizontally_in_viewport(e,t,n){var r=e.width(),a=t.offset().left,i=t.width(),o=jQuery(window),s=o.width(),t=o.scrollLeft(),o=s+t;null==n&&(n=8),r&&s&&(t<=a&&a<o&&o<a+r+n?a=Math.max(t+n,a+i-r,o-n-r):a<t&&t<=a+i&&(a=Math.min(t+n,a+i))),e.css({left:a})}build_network_selector.make_network_array=function(e,t){if(_.isEmpty(e))return[];var n=_.map(_.where(e.locales,t),function(e){return{type:"locale",id:e.id,sel:Mkiconf.locale_id==e.id,name:e.name}}),e=_.filter(e.node_groups,function(e){return!e.locale_id});t&&(e=_.where(e,t));e=_.map(e,function(e){return{type:"ng",id:e.eid,sel:Mkiconf.ng_eid==e.eid,name:e.n}}),e=n.concat(e);return _(e).sortBy(function(e){return e.name.toLowerCase()})},build_network_selector.make_options=function(e,t){t=build_network_selector.make_network_array(e,t);return _.map(t,function(e){return"<option value='"+e.type+":"+e.id+"' class='notranslate'>"+e.name+"</option>"}).join("")},function(n,r){n.fn.makeNetworkSelector=function(e,t){e=r.extend({is_virtual:!!Mkiconf.is_virtual},e);t=t||function(){};return n(this).html(r.chain(Mkiconf.administered_networks).where(e).reject(t).sortBy("n").map(function(e){return"<option value='"+e.eid+"' class='notranslate'>"+e.n+"</option>"}).join("").value()).val(Mkiconf.ng_eid),this}}(jQuery,_),function(o){function s(e,t,n,r){e.hasOwnProperty(n)&&(t[n]=e[n],r&&delete e[n])}o.slice=function(n,e,r){var t,a=0,i={};if("number"!=typeof e)return"string"==typeof e&&(e=e.split(/\s+/)),o.each(e,function(e,t){s(n,i,t,r)}),i;for(t in n)if(s(n,i,t,r),++a==e)break;return i}}(jQuery),function(r){r.fn.stretch=function(t){t=r.extend({footer:null,live:!0,min_height:0,adjust:0,resized:null},t);function e(){return n.each(function(){var e=r(window).height();e=r(t.footer).length?e-r(t.footer).first().offset().top-r(t.footer).first().outerHeight(!0)+r(this).height():e-r(this).offset().top,(e+=t.adjust)<t.min_height&&(e=t.min_height),r(this).height(e),t.resized&&t.resized()})}var n=this;t.live&&r(window).resize(e),e()}}(jQuery);var validate=function(i){function o(){i(this).css({"background-color":"var(--control-bg-weak-default)"}),i(this).hohelp()}function s(e,t,n){var r,a;n=i.extend(n,{background_color:"var(--negative-bg-medium-default)",message:!0}),i(e).blur((r=t,a=n,function(){var e=r(i(this).val());if("string"!=typeof e)return i(this).css({"background-color":"var(--control-bg-weak-default)"}),void i(this).hohelp();!1!==a.background_color&&i(this).css({"background-color":a.background_color}),!1!==a.message&&i(this).addClass("auto_hohelp").hohelp(e,{nostack:!0,sticky:!1})})),i(e).focus(o)}return s.alpha_numeric_underscore_validator=function(e,t){if(!e||!e.match(/^[\d\w_]+$/))return t},s.alpha_numeric_underscore_hyphen_validator=function(e,t){if(!e||!e.match(/^[\d\w_-]+$/))return t},s.int_validator=function(e,t,n,r,a){if(!a||!e.match(/^any$/i)){a=parseInt(e);return isNaN(a)||a<n||r<a||!String(e).match(/^[+-]?\d+$/)?t:void 0}},s.switch_port_validator=function(e){return s.int_validator(e,"Port must be a number between 1 and 54",1,54,!0)},s.ipv4_subnet_validator=function(e,t){if(!e)return t;e=e.match(/^(\d+).(\d+).(\d+).(\d+)\/(\d+)$/);return!e||e[1]<0||255<e[1]||e[2]<0||255<e[2]||e[3]<0||255<e[3]||e[4]<0||255<e[4]||e[5]<0||32<e[5]?t:void 0},s.ipv4_validator=function(e,t){if(!e)return t;e=e.match(/^(\d+).(\d+).(\d+).(\d+)$/);return!e||e[1]<0||255<e[1]||e[2]<0||255<e[2]||e[3]<0||255<e[3]||e[4]<0||255<e[4]?t:void 0},s.NO_PORTS_ERROR_STRING="Must specify ports",s.port_list_validator=function(e){var t=e&&e.split(",");if(!t||0==t.length)return s.NO_PORTS_ERROR_STRING;for(var n=0;n<t.length;n++){var r,a=t[n].match(/^\s*(\d+)\s*$/);if(a){if(r=s.switch_port_validator(a[1]))return r}else{if(!(a=t[n].match(/^\s*(\d+)\s*-\s*(\d+)\s*$/)))return'Ports must be a comma-separated list of ports or port ranges (eg. "1,2,4-10, 15, 20")';if(r=s.switch_port_validator(a[1])||s.switch_port_validator(a[2]))return r}}},s}(jQuery);function make_query_url(t){var e=_.filter(arguments,function(e){return null!=e&&""!=e&&e!=t}).join("&");if(""==e)return t;var n=t.match(/([^#]*)(#?.*)/);return n[1]+(-1==n[1].indexOf("?")?"?":"&")+e+n[2]}function xhr_extract_error_json(e){var t={};if(e.responseText)try{"object"!=typeof(t=JSON.parse(e.responseText))&&(t={})}catch(e){}return t.errf=t.errf||!0,t.error=t.error||"Unable to save changes. Please try again.",t}function html_entity_decode(e){var t=document.createElement("textarea");return t.innerHTML=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.value.replace(/^\s*|\s*$/g,"")}function html_entity_encode(e,t){e=document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML;return e=t?e.replace(/\n/g,"<br />\n"):e}function br2nl(e){return e.replace(/<br\s*\/?>(?:<\/br>)?\n?/g,"\n")}function strcmp(e,t){e=e||"",t=t||"";return e<t?-1:t<e?1:0}function strcasecmp(e,t){var n=e?e.toLowerCase():"",r=t?t.toLowerCase():"";return n<r?-1:r<n?1:e==t?0:strcmp(e,t)}function numcmp(e,t){e=+(e||0),t=+(t||0);return e<t?-1:t<e?1:0}function strcmp_null_last(e,t){return e&&e.length?t&&t.length?strcmp(e,t):-1:1}function human_sortable_string(e){return(" "+e).replace(/\s+/g," ").replace(/(\A|[^:.])(\d+)/g,function(e,t,n){return 7<=n.length?e:t+"000000".slice(0,7-n.length)+n}).toLowerCase()}function pluralize(e,t,n){var r,a=(n=n||{}).nocount||n.nc?t:n.wordcount&&0<=e&&e<=10&&e==Math.ceil(e)?["zero","one","two","three","four","five","six","seven","eight","nine","ten"][e]+" "+t:e+" "+t;return(r=1===e==!!n.verb?1:0)&&2<t.length&&("ch"===(e=t.substr(t.length-2))||"sh"===e||"s"==e[1])?a+="es":r&&n.ies&&"y"===t.substr(t.length-1)?a=a.substr(0,a.length-1)+"ies":r&&(a+="s"),n.these&&(a=n.trailing?a+[" this"," these"][r]:["this ","these "][r]+a),n.their&&(a=n.trailing?a+[" its"," their"][r]:["its ","their "][r]+a),a=n.are?n.trailing?a+[" is"," are"][r]:["is ","are "][r]+a:a}function pluralized_matches_html(e,t,n,r){return _.isUndefined(r)||r===e?"<b>"+pluralized_phrase(e,t,n)+"</b>":"<b>"+pluralized_phrase(r,t,n)+"</b> in <var>"+_.escape(e)+"</var>"}function pluralized_phrase(e,t,n,r){t=1!=e?n:t;return(r=r||{}).svg?"<tspan><tspan data-var='total' data-pluralize='"+_.escape(e)+"'>"+_.escape(e)+"</tspan> "+_.escape(t)+"</tspan>":"<span><var total pluralize='"+_.escape(e)+"'>"+_.escape(e)+"</var> "+_.escape(t)+"</span>"}function dimtext(e){return"<span class='dimtext'>"+e+"</span>"}function human_readable_number(e){for(var t=e+"",n=parseInt(t.length/3)+1,r=1;r<n;r++){var a=t.length-4*r+1;0!=a&&(t=t.slice(0,a)+","+t.slice(a))}return t}function parse_size(e,t){var n,r,a,i=parse_size.sipfx;if(!(r=e.match(parse_size.regexp)))return!1;for(e=r[1],r[2]=r[2].toUpperCase(),a=0;""!==r[2]&&a<i.length;a+=3)r[2]===i[a]&&(e*=n=i[a+1],t&&-1<t.indexOf("<")?e=Math.max(Math.ceil(e+.05*n),0):t&&-1<t.indexOf(">")&&(e=Math.floor(e-.05*n)));return e}function unparse_size(e,t,n,r){for(var a="",i=Math.abs(e),o=parse_size.sipfx,s=0;s<o.length;s+=3)if(i>=o[s+1]){e/=o[s+1],a=" "+parse_size.sipfx[s],!0===t&&(t=o[s+2]);break}if(!0===t){if(0==e)return"None";t=1,r=!0}return null==t?e=e.toString():(e=e.toFixed(t),r&&0<t&&(e=e.replace(/\.?0+$/,""))),"Bytes"==n&&(a?n="B":"1"==e&&(n="Byte")),e+(a=n?(a||" ")+n:a)}function unparse_bytes(e,t){return unparse_size(e,!0,"Bytes",t)}function unparse_kb(e,t){return unparse_size(1024*e,!0,"Bytes",t)}function translated_unparse_kb(e,t,n){return"<var "+_.escape(e)+">"+_.escape(unparse_kb(t,n))+"</var>"}function unparse_kb_pair(e,t,n,r){var a=("s"==n?"SSID u":"U")+"sage"+(r||"");return e+t?(r="<var usage>"+unparse_kb(e+t,!0)+"</var>",e="<var downloaded>"+unparse_kb(e,!0)+"</var>",t="<var uploaded>"+unparse_kb(t,!0)+"</var>","h"==n?r+" (<span title='Received/downloaded'>&darr;<span class='thinsp'></span>"+e+"</span>, <span title='Sent/uploaded'>&uarr;<span class='thinsp'></span>"+t+"</span>)":a+": "+r+" ("+e+" received, "+t+" sent)"):"No "+a.replace(/^U/,"u")}function parse_time(e,t){for(var n,r,a=!1;n=e.match(/^(\d+\.?\d*|\.\d+)\s*([a-z]*)\s*(.*)$/i);){for(n[2]=n[2].toLowerCase(),parse_time.tsyn.hasOwnProperty(n[2])&&(n[2]=parse_time.tsyn[n[2]]),""===n[2]&&t&&""===n[3]&&(n[2]=t),r=0;r<parse_time.tsfx.length&&n[2]!==parse_time.tsfx[r];r+=2);if(r>=parse_time.tsfx.length)return!1;!1===a&&(a=0),a+=n[1]*parse_time.tsfx[r+1],e=n[3]}return""===e&&a}function unparse_interval(e,t){for(var n=0;e>=unparse_interval.tsfx[n];n+=3);return(e=unparse_interval.tsfx[n+1]?Math.round(e/(unparse_interval.tsfx[n+2]/10))/10:Math.round(e/unparse_interval.tsfx[n+2]))+(t?" ":" ")+unparse_interval.tmap[unparse_interval.tsfx[n+2]]+(1==e?"":"s")}function options_for_select(e,a,i,o){var s=typeof a,l=typeof i,c=typeof o;return _(e).map(function(e){var t,n,r;return"function"==s&&(t=a(e)),"function"==l&&(n=i(e)),"function"==c&&(r=o(e)),Array.isArray(e)?(t=t||e[0],n=n||e[1]):$.isPlainObject(e)?(t=t||e[a],n=n||e[i],r=r||e[o]):(t=t||e,n=n||e),"<option value='"+n+(_.isEmpty(r)?"":"' class='"+r)+"'>"+t+"</option>"}).join("\n")}function group_options_for_select(e,r,a,i){return _.reduce(e,function(e,t,n){return e+'<optgroup label="'+n+'">\n'+options_for_select(t,r,a,i)+"</optgroup>\n"},"")}function add_time_zone_info(e){var t,n,r,a;if(e&&e.length){for(Mkiconf.tz=n=Mkiconf.tz||[],t=e[r=0];t[0]&&n[r]&&t[0]>n[r][0];++r);for(a=n.length,t=e[e.length-1];t[1]&&0<a&&(!n[a-1][1]||t[1]<n[a-1][1]);--a);(t=[r,a-r]).push.apply(t,e),meraki_array_splice_apply(n,t)}}function unparse_fraction_as_percent(e,t){return(t||0)<=0?"N/A":"0.0%"==(t=(100*(e||0)/t).toFixed(1)+"%")&&0!=(e||0)?"&lt;<span class='thinsp'></span>0.1%":t}function unparse_fraction_as_sortable_decimal(e,t){return(t||0)<=0?-1:(e||0)/t}function unparse_truncated_fixed(e,t){e=e.toFixed(t);return 0<t?e.replace(/\.?0+$/,""):e}function is_ip4address(e){return IPV4_ADDR_REGEXP.test(e)}function is_ip4range(e){return!!e&&e.match(/((\d+)\.){3}\d+\s*-\s*((\d+)\.){3}\d+/)}function is_ip6address(e){return IPV6_ADDR_REGEXP.test(e)}function is_ip6range(e){if(!e)return!1;e=e.match(/^([0-9A-Fa-f:]*)-([0-9A-Fa-f:]*)$/);return e&&is_ip6address(e[1])&&is_ip6address(e[2])}function is_ipaddress(e){return is_ip4address(e)||is_ip6address(e)}function is_iprange(e){return is_ip4range(e)||is_ip6range(e)}function is_ip6plen(e){return e&&0<e&&e<128}function is_vlan(e){return e&&0<e&&e<4095}function build_func(text,context){var i,f,ctx="";for(i in context)context.hasOwnProperty(i)&&(ctx+="var "+i+" = context."+i+";");return eval(ctx+"f = "+text),f}function add_toggled_helplink_listeners(e){jQuery("#"+e+".config_explanation a.link_text").click(function(){return jQuery(this).blur().parents(".config_explanation").toggleClass("expanded"),!1})}function baseline_spinner_html(){return"<span data-testid=\"spinner-loading\" style='display:inline-block;width:16px;position:relative'>&nbsp;<img src='"+Mkiconf.images+"spinner.gif' style='position:absolute;left:0;bottom:-1px' /></span>"}function colored_bullet(e){return"<span class='colbult_l1'>&nbsp;<span class='colbult_l2' style='color:"+e+"'>&#x25CF;</span></span>"}function block_enter_key(e){return 13!=(window.event?window.event.keyCode:e.which)}function preload_image(e){var t=new Image;return t.src=e,t}function image_exists(e,t){var n=new Image;n.onload=function(){t(!0)},n.onerror=function(){t(!1)},n.src=e}function hide_notice(e,t){!0!==e&&e||(t=e,e="#notice_explanation"),(e=jQuery(e)).parent().hasClass("notice_explanation_container")&&(e=e.parent()),t?e.hide():e.fadeOut("slow")}function nodecmp(e,t){var n;return(n=t.is_gateway-e.is_gateway)||e.model!=t.model&&(n=strcmp(node_product_info(e,"type"),node_product_info(t,"type")))?n:strcmp(e.name$,t.name$)||strcmp(e.mac,t.mac)}function node_name(e){return e.name||e.mac||(e.id?"(AP #"+e.id+")":"(unknown)")}function mac_to_node_id(e){return!e||6!=(e=e.split(":")).length?0:65536*parseInt(e[3],16)+256*parseInt(e[4],16)+parseInt(e[5],16)}parse_size.sipfx=["T",1099511627776,2,"G",1073741824,2,"M",1048576,1,"K",1024,!0],parse_size.regexp=/^\s*([-+]?(?:\d+\.?\d*|\.\d+))\s*([KMGT]?)/i,parse_time.tsfx=["y",31536e3,"mo",2628e3,"d",86400,"h",3600,"m",60,"s",1,"ms",1e-4],parse_time.tsyn={years:"y",year:"y",yr:"y",months:"mo",month:"mo",mos:"mo",days:"d",day:"d",hrs:"h",hr:"h",hours:"h",hour:"h",min:"m",mins:"m",minutes:"m",minute:"m",seconds:"s",second:"s",sec:"s",secs:"s",msec:"ms",milliseconds:"ms"},unparse_interval.tsfx=[90,0,1,3600,0,60,28800,1,3600,172800,0,3600,604800,1,86400,5184e3,0,86400,7257600,1,604800,31556928,1,2629744,1/0,0,2629744],unparse_interval.tmap={1:"second",60:"minute",3600:"hour",86400:"day",604800:"week",2629744:"month"},function(p){var f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=new RegExp("^(.*)\\b("+f.join("|")+"|"+h.join("|")+")\\b(.*)$","i"),g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=["January","February","March","April","May","June","July","August","September","October","November","December"],y={Y:"getFullYear",d:"getDate",m:"getMonth",a:"getDay",H:"getHours",M:"getMinutes",S:"getSeconds"},w={Y:"getUTCFullYear",d:"getUTCDate",m:"getUTCMonth",a:"getUTCDay",H:"getUTCHours",M:"getUTCMinutes",S:"getUTCSeconds"},b=function(){for(var e={},t=0;t<12;++t)e[g[t].toLowerCase()]=e[v[t].toLowerCase()]=t;return e}();function k(e){return e.getDate?e.getTime()/1e3:e}function x(e){var t,n,r=Mkiconf.tz||[];for(e=k(e),t=r.length-1;0<=t;--t)if(null==(n=r[t])[0]||n[0]<=e||0==t)return n;return null}window.time_range_in_words=function(e,t){var n="%b %-d %H:%M %Z";return unparse_date(e,n)+" to "+unparse_date(t,n,1)},window.unparse_date=function(e,t,n){var r,a,i,o,s,l,c,u,d="",_=y,p="";for(t=t||"%b %d %H:%M",1==(n=void 0===n?1:n)&&(a=x(e))?(e=k(e="string"==typeof e?parseInt(e):e)+a[2],p=a[3],_=w):2==n?(_=w,p="UTC"):3==n&&(c=e.tzoffset,n=e.tzabbr,e=k(e.ts)+(void 0!==c?c:0),p=void 0!==n?n:"UTC",_=w),e.getDate||(e=new Date(1e3*e)),r=0;r<t.length;++r)if("%"==(a=t.charAt(r))){for(s="0",l=0,++r;r<t.length;++r)if("-"==(i=t.charAt(r)))s="";else if("#"==i)++l;else{if(" "!=i)break;s=" "}if(r==t.length)break;"a"==i?d+=f[e[_.a]()]:"A"==i?d+=h[e[_.a]()]:"b"==i?d+=g[e[_.m]()]:"B"==i?d+=v[e[_.m]()]:"c"==i?d+=((o=e[_.m]()+1)<10?s:"")+o:i.match(/^[dHmMS]/)?d+=((o=e[_[i]]())<10?s:"")+o:"I"==i?d+=((o=e[_.H]()%12||12)<10?s:"")+o:"p"==i?d+=e[_.H]()<12?"AM":"PM":"P"==i?d+=e[_.H]()<12?"am":"pm":"y"==i?d+=((o=e[_.Y]()%100)<10?s:"")+o:"Y"==i?(l=l&&(new Date).getFullYear()-e.getFullYear()?0:l)||(d+=("0"!=s?s:"")+e[_.Y]()):"Z"==i?""!=p&&(d+=("0"==s?"":s)+p):"R"==i?d+=((u=e[_.H]())<10?s:"")+u+":"+((u=e[_.M]())<10?s:"")+u:"%"==i&&(d+=i)}else d+=a;return d},window.translated_unparse_date=function(e,t,n,r){return"<var "+_.escape(e)+">"+_.escape(unparse_date(t,n,r))+"</var>"},window.parse_date=function(e,t,n){var r,a,i,o,s,l,c=0,u=0,d=0;function _(e){return b[e.toLowerCase()]}if((r=e.match(m))&&(e=r[1]+" "+r[3]),""==p.trim(e))return!1;if((r=e.match(/^(.*)\b(\d{1,2}):(\d\d)(?::(\d\d(?:\.\d+)?))?(?:\s*([ap])m?)?(.*)$/i))&&0<=+r[2]&&+r[2]<24&&0<=+r[3]&&+r[3]<60&&(c=+r[2],r[5]&&"p"==r[5].toLowerCase()?c+=12==c?0:12:r[5]&&"a"==r[5].toLowerCase()&&12==c&&(c=0),u=+r[3],d=r[4]?+r[4]:0,e=r[1]+" "+r[6]),(r=e.match(/^(.*)\b(\d{4})[-\/](\d+)[-\/](\d+)\b(.*)$/))?(i=+r[2],o=+r[3]-1,s=+r[4],e=r[1]+" "+r[5]):(r=e.match(/^(.*)\b(\d+)(?:[-\/]|\s+)(\w+)(?:[-\/]|\s+)(\d+)\b(.*)$/))&&null!=(o=_(r[3]))?(s=4==r[2].length?(i=+r[2],+r[4]):(i=+r[4],+r[2]),e=r[1]+" "+r[5]):(r=e.match(/^(.*)\b(\d{1,2})\/(\d{1,2})\b(.*)$/))?(o=+r[2]-1,s=+r[3],e=r[1]+" "+r[4]):(r=e.match(/^(.*)\b(\d{1,2})\s+(\w+)\b(.*)$/))&&null!=(o=_(r[3]))?(s=+r[2],e=r[1]+" "+r[4]):(r=e.match(/^(.*)\b(\w+)\s+(\d{1,2})(?:\s*(\d{4}))?\b(.*)$/))&&null!=(o=_(r[2]))&&(s=+r[3],i=r[4]?+r[4]:null,e=r[1]+" "+r[5]),e=p.trim(e),/^(?:GMT|UTC)$/i.test(e))l=!0;else if(/^(?:\w+(?:[-+]\d+)?)$/.test(e)){if(""!=e)return!1}else;return l=!!n||l,n=(e=x(t=k(t||new Date)))?(t+=e[2],w):y,t=new Date(1e3*t),null==s&&(s=t[n.d]()),null==o&&(o=t[n.m]()),null==i&&o>t[n.m]()?i=t[n.Y]()-1:null==i&&(i=t[n.Y]()),!(i<2e3||i>t[n.Y]()+10||o<0||11<o||s<1||31<s||c<0||23<c||u<0||59<u||d<0||62<d)&&(t=Math.round(1e3*d)-1e3*Math.round(d),d=Math.round(d),n=Date.UTC(i,o,s,c,u,d,t),l?new Date(n):(e=x(n/1e3))?(l=new Date(n-1e3*e[2]),e[0]&&e[0]>l.getTime()/1e3&&(a=x(e[0]-1))&&a!=e||e[1]&&e[1]<l.getTime()/1e3&&(a=x(e[1]+1))&&a!=e?new Date(n-1e3*a[2]):l):new Date(i,o,s,c,u,d,t))}}(window.jQuery),navigator&&navigator.appVersion&&navigator.appVersion.match(/MSIE 8/)?window.meraki_array_splice_apply=function(e,t){var n,r=t[0],a=t[1];e.length!=r+a&&(n=e.slice(r+a,e.length)),e.splice(r,a),e.push.apply(e,t.slice(2,t.length)),n&&e.push.apply(e,n)}:window.meraki_array_splice_apply=function(e,t){e.splice.apply(e,t)},function(e){e.fn.only_text=function(){return e(this).clone().children().remove().end().text()},e.fn.outerHTML=function(){return e("<div/>").append(e(this).clone()).html()}}(jQuery),function(o){o.fn.add_simple_search_filter_search_count_updater=function(i){o(this).on("change:results",function(e,t){var n=t.length,r=this.data.length,a=this.container.siblings(".search_count");n!==r?a.text("").append(o("<b></b>").text(pluralize(t.length,"match"))).append(document.createTextNode(" in "+pluralize(this.data.length,i))):a.text(pluralize(n,i)).wrapInner("<b></b>")})}}(jQuery),function(o){function n(e,n,t,r){var a=o(this);r&&(e+=" input"),o(e).on("change",function(){var e=o(this).val()==n&&(!r||o(this).prop("checked"));!!t==!!e?a.show():a.hide()});var i=!1;o(e).each(function(e,t){r&&o(t).val()!=n||(i=!(o(this).val()!=n||r&&!o(this).prop("checked")))}),!!t==!!i?a.show():a.hide()}jQuery.fn.hide_when=function(e,t){n.call(this,e,t,!1,!1)},jQuery.fn.show_when=function(e,t){n.call(this,e,t,!0,!1)},jQuery.fn.hide_when_radio=function(e,t){n.call(this,e,t,!1,!0)},jQuery.fn.show_when_radio=function(e,t){n.call(this,e,t,!0,!0)}}(jQuery),jQuery.fn.m_status_msg=function(e,t){var n,r,a={l_offset:0,t_offset:0,show_spinner:!0,spinner_src:Mkiconf.images+"spinner.gif",show_checkmark:!1,checkmark_src:Mkiconf.images+"icon_checkmark_black_16x16.gif",auto_dismiss_ms:void 0};return $(this).data("m_status_msg_c")&&$(this).data("m_status_msg_c").remove(),$.extend(a,t),n=$(this).offset().left+a.l_offset,t=$(this).offset().top+a.t_offset,a.show_spinner&&(e='<img src="'+a.spinner_src+'" alt="Working" style="vertical-align:middle; width:16px; height:16px"/>&nbsp;'+e),a.show_checkmark&&(e='<img src="'+a.checkmark_src+'" alt="Success" style="vertical-align:middle; width:16px; height:16px"/>&nbsp;'+e),r=$("<div style='position:absolute; display:none'>"+e+"</div>"),$("body").append(r),t+=($(this).height()-r.height())/2,n+=$(this).outerWidth(),r.css({left:n+"px",top:t+"px"}),r.show(),a.auto_dismiss_ms&&setTimeout(function(){r.animate({opacity:"0"},800,function(){r.remove()})},a.auto_dismiss_ms),$(this).data("m_status_msg_c",r),r},jQuery.fn.dim=function(e,t,n){var r={alert_on_click:!1,click_callback:!1};return n&&jQuery.extend(r,n),null==e||e?(n=jQuery("<div class='controls_dimmer active'></div>"),(t="string"==typeof e?e:t)&&(n.attr("title",t),r.alert_on_click&&n.click(function(){alert(t)})),r.click_callback&&n.click(r.click_callback),r.width&&n.css("width",r.width),r.klass&&n.addClass(r.klass),jQuery(this).children(".controls_dimmer.active").remove().end().prepend(n),jQuery(this).css("position","relative")):jQuery(this).undim(),this},jQuery.fn.undim=function(){return jQuery(this).children(".controls_dimmer").remove(),this},jQuery.fn.mval=function(){var e=jQuery(this).val();switch(jQuery(this).prop("type")){case"checkbox":return jQuery(this).is(":checked")?e:null;case"radio":return jQuery(this).is(":checked")?e:void 0;case"select-multiple":return Array.isArray(e)&&0===e.length?null:e;default:return e}},function(r){var a={},i=0;r.fn.showHint=function(e){var t=r(this);if(!t.attr("id")){for(var n="";n="hinttext_"+ ++i,document.getElementById(n););t.attr("id",n)}a[t.attr("id")]=e,""==t.val()||t.val()==e?(t.addClass("hint_text"),t.val(e),t.trigger("hintShown")):t.hasClass("hint_text")&&t.removeClass("hint_text")},r.fn.hideHint=function(e){var t=r(this);t.removeClass("hint_text"),t.val()==e&&(t.val(""),t.trigger("hintHidden"))},r.fn.hintValue=function(){var e=r(this);if(e.attr("id"))return a[e.attr("id")]},r.fn.valWithoutHint=function(){var e=r(this);return e.attr("id")&&a[e.attr("id")]&&a[e.attr("id")]==e.val()?"":e.val()}}(jQuery),jQuery.fn.hint=function(e){jQuery(this).on("blur",function(){jQuery(this).showHint(e)}).blur(),jQuery(this).on("click focus",function(){jQuery(this).hideHint(e)})},function(){var t={wireless:"access point",switch:"switch",wired:"security appliance",cellular_gateway:"cellular gateway"};window.get_devices_noun=function(e){return t[e]||""}}(),window.node_product_info=function(){var i={icon:"product_icon",type:"device_type",icon_extra_class:"",description:"product_description",short_description:"product_short_description",interface_names:"interface_names",max_ssid:"max_ssid"},o={interface_names:[]};return function(e,t,n){var r,a=Mkiconf.products;return void 0===n&&(n=o[t]),e?a&&e.model&&(r=a[e.model])?r[t]||n:(r=i[t])&&e[r]||n:n}}();var form_helper={make_target:function(e){var t,n=e.form,r=_.uniqueId("form_iframe_");(t=n.attr("target"))&&jQuery("#"+t).remove(),n.attr("target",r),n.after("<iframe src='about:blank' id='"+r+"' name='"+r+"' onload='form_helper.target_loaded(\""+r+"\")' style='display:none'></iframe>"),jQuery("#"+r)[0].form_iframe_complete=e.complete},target_loaded:function(e){var t=jQuery("#"+e),e=t.contents();"about:blank"!==e[0].location.href&&(t[0].form_iframe_complete(e),t.attr("src","about:blank"))}};function set_uri_param(e,a,i){var o=new RegExp("(?:^\\?|&)"+a.replace(/\W/g,"\\$&")+"(?:=[^&]*)?(?=&|$)","g");return e.replace(/^([^\?#]*)(\?[^\#]*)?(\#.*)?$/,function(e,t,n,r){return n=(n||"").replace(o,""),null!=i&&(""!=n&&"?"!=n&&(n+="&"),n+=a+"="+encodeURIComponent(i)),t+(n="?"==(n=1<(n=0<n.length&&"?"!=n.charAt(0)?"?"+n:n).length&&"?&"==n.substr(0,2)?"?"+n.substr(2):n)?"":n)+(r=r||"")})}function stable_json_stringify(e){var t,n,r=[];if(null==e)return"";if("object"!=typeof e)return JSON.stringify(e);if(Array.isArray(e)){for(t=0;t<e.length;++t)r.push(stable_json_stringify(e[t]));return"["+r.join(",")+"]"}for(t in e)e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]&&""!==(n=stable_json_stringify(e[t]))&&"{}"!==n&&r.push(JSON.stringify(t)+":"+n);return r.sort(strcmp),"{"+r.join(",")+"}"}function json_eq(e,t){var n,r,a;if(null==e||null==t)return e==t;if("object"!=typeof e||"object"!=typeof t)return e===t;if(n=Array.isArray(e),r=Array.isArray(t),n||r){if(!n||!r||e.length!==t.length)return!1;for(a=e.length-1;0<=a;--a)if(!json_eq(e[a],t[a]))return!1;return!0}for(a in e)if(!json_eq(e[a],t[a]))return!1;for(a in t)if(null!=t[a]&&null==e[a])return!1;return!0}function json_namespace_separate(e){for(var t,n=0;"/"==e.charAt(n);++n);return(t=e.indexOf("/",n))<0&&(t=e.length),{a:e.substring(n,t),b:e.substring(t+1,e.length)}}function json_ensure(e,t){t=json_namespace_separate(t);return e&&"object"==typeof e&&!Array.isArray(e)||(e={}),""!==t.a&&(e[t.a]=json_ensure(e[t.a],t.b)),e}function json_select(e,t,n){var r,t=json_namespace_separate(t);if(e&&"object"==typeof e&&!Array.isArray(e)||(e={}),""!==t.b)r=json_select(e[t.a],t.b,n);else{if(""===t.a)return e;r=e[t.a]}return n?((n={})[t.a]=r,n):r}function json_delete(e,t){t=json_namespace_separate(t);if(e&&"object"==typeof e&&!Array.isArray(e)||(e={}),""!==t.b)json_delete(e[t.a],t.b);else{if(""===t.a)return{};delete e[t.a]}return e}function json_assign(e,t,n){t=json_namespace_separate(t);if(e&&"object"==typeof e&&!Array.isArray(e)||(e={}),""!==t.b)e[t.a]=json_assign(e[t.a],t.b,n);else{if(""===t.a)return Array.isArray(n)?[].concat(n):n&&"object"==typeof n?jQuery.extend(!0,{},n):n;e[t.a]=json_assign({},"",n)}return e}function save_user_dashboard_prefs(e){var t=Mkiconf.user_dashboard_prefs,n="user_dashboard_prefs_saved",r=Mkiconf[n];(e="string"!=typeof e?"":e)&&(t=json_select(t,e,!0),r=json_select(r,e,!0)),json_eq(t,r)||(jQuery.post(url_for({controller:"dashboard",action:"quiet_update"}),{user_prefs:JSON.stringify(t)}),Mkiconf[n]=json_delete(Mkiconf[n],e||""),jQuery.extend(!0,Mkiconf[n],t))}function change_ssid(){var e=jQuery(this).val(),t=set_uri_param(window.location.href,"ssid",0<=e?e:null);window.location.href=change_ssid_url+"?ssid="+e+"&f="+encodeURIComponent(t)}function hQuery(e){var t;return 1!=arguments.length&&log_error("invalid call to hQuery args",{count:arguments.length}),(void 0===(t=jQuery(e)).length||t.length<1)&&log_error("no dom element matches selector "+e),t}jQuery.build_async_uploader=function(e){var i={name:(new Date).getTime(),id:(new Date).getTime(),classes:"notrack",label:"Locate your file: ",action:"",buttontext:"Upload",help_text:void 0,waiting_text:"Uploading. Please wait...",waiting_img:null,use_button:void 0,before:function(){},waiting:function(){},complete:function(e){},max_size_mb:0},t="";e&&jQuery.extend(i,e),"image"==i.waiting_img&&preload_image(i.waiting_img),void 0!==i.help_text&&!1!==i.help_text&&(t='<div class="async_uploader hide_during_upload help_text small_print">'+i.help_text+"</div>");var o="async_uploader hide_during_upload";0<i.classes.length&&(o+=" "+i.classes);var n=function(){var e,t="",n="";if(0<i.max_size_mb&&void 0!==jQuery(this)[0].files&&1==jQuery(this)[0].files.length&&jQuery(this)[0].files[0].size>1024*i.max_size_mb*1024)return void alert("Error: the max supported file size is "+i.max_size_mb+"MB");jQuery(this).parents("form").length?(a=jQuery(this).parents("form"),t=a.attr("target")||"",n=a.attr("action")||""):a=jQuery(this).wrap("<form method='post' enctype='multipart/form-data'></form>").parent("form").data("delete_during_cleanup",!0),i.before(jQuery(this)[0].files[0]);var r=a,a=jQuery(this);void 0!==i.these_fields_only&&(a=jQuery("<div></div>").hide().insertAfter(jQuery(this)),r=jQuery("<form></form>").attr({target:t,action:n,method:"post",enctype:"multipart/form-data",delete_during_cleanup:!0}).appendTo(jQuery(document.body)).hide(),jQuery(this).appendTo(r),_.each(i.these_fields_only,function(e){("checkbox"==(e=jQuery(e)).attr("type")?e.clone().prop("checked",e.is(":checked")):e.clone().val(e.val())).appendTo(r)})),"undefined"!=typeof Mkiconf&&!1!==Mkiconf&&(e=Mkiconf.authenticity_token),r.append(jQuery("<input>").attr({type:"hidden",name:"authenticity_token"}).val(e)).append(jQuery('<iframe src="about:blank" style="display:none;" class="'+o+'" name="'+i.name+'_target"></iframe>').on("load",function(){return"about:blank"!==jQuery(this).contents().get(0).location.href&&(i.complete(jQuery(this).contents().get(0).body.innerHTML),jQuery(this).attr("src","about:blank"),r.data("delete_during_cleanup")?r.remove():r.find(".async_uploader").remove().end().attr("target",t).attr("action",n)),!0})).attr("target",i.name+"_target").attr("action",i.action),r.submit(),i.waiting(),e=i.waiting_img?jQuery('<img class="waiting_message async_uploader" src="'+i.waiting_img+'" />'):jQuery('<span class="waiting_message async_uploader">'+i.waiting_text+"</span>"),a.siblings(".async_uploader.hide_during_upload").addBack().hide().end().end().after(e)},e=jQuery('<label for="'+i.id+'" class="async_uploader hide_during_upload">'+i.label+'</label><input type="file" name="'+i.name+'" id="'+i.id+'" class="'+o+' upload_file" />'+t),t=e.filter("input.upload_file"),n=jQuery.proxy(n,t);return void 0!==i.use_button&&!1!==i.use_button?i.use_button.click(function(){return n(),!1}):t.change(function(){return n(),!1}),e},jQuery.fn.m_disable_form=function(e){var t,n;return e=e||{},"form"==this.get(0).tagName.toLowerCase()&&(e.hard&&this.bind("submit.m_disable_form",function(){return!1}),this.addClass("disabled"),(t=this.find("input:submit")).attr("disabled","disabled"),e.button_text&&(t.each(function(e){jQuery(this).attr("data_orig_val",jQuery(this).val())}),t.val(e.button_text)),e.waiting_msg&&(n=function(){t.after("<br class='waiting_msg'/><div class='waiting_msg'>"+e.waiting_msg+"</div>")},e.waiting_msg_delay?setTimeout(n,e.waiting_msg_delay):n())),this},jQuery.fn.m_reenable_form=function(){var e,t;return"form"==this.get(0).tagName.toLowerCase()&&(this.removeClass("disabled"),this.unbind(".m_disable_form"),(e=jQuery(this).find("input:submit")).attr("disabled",!1),e.each(function(e){(t=jQuery(this)).attr("data_orig_val")&&t.val(t.attr("data_orig_val"))}),this.find(".waiting_msg").remove()),this},$(function(){$("#select_ssid.sync").on("change",change_ssid)}),$h=hQuery;var googleMapsLoad=function(){var n=null,r=null,t=null;function a(){var e;if(t&&(clearTimeout(t),t=null),"undefined"!=typeof GMap2){if(r=!0,n){for(e=0;e<n.length;++e)n[e]();n=null}}else t=setTimeout(a,25)}return function(e){var t;"function"==typeof GMap2&&null===r&&a(),"function"==typeof e?r?e():(n=n||[]).push(e):!0===e?a():null===r&&(r=!1,(t=document.createElement("script")).src=google_maps_script_url,t.type="text/javascript",t.onload=a,t.onreadystatechange=function(){"loaded"!==t.readyState&&"complete"!==t.readyState||a()},document.getElementsByTagName("head")[0].appendChild(t))}}();function normalize_mac_address(e){var t,n,r=[];if(!e)return"";for(t=e.split(":"),n=0;n<t.length;++n)""==t[n]||2<t[n].length?r.push("00"):1==t[n].length?r.push("0"+t[n]):r.push(t[n]);return r.join(":").toLowerCase()}function firewall_row_create_callback(l,e,t){var n=l.find(".proto select");n.change(function(){var e=$(this).val(),t="any"==e,n="icmp-ping"==e,r="icmp"==e,a=l.find(".dst_port input, .dst_port textarea, .src_port input, .src_port textarea"),i="cust"===e,o=l.find(".custom_proto"),s=o.val();a.attr("disabled",t||n||r||i),o.attr("disabled",!i),"tcp"===e?$(o).val(6):"udp"===e?$(o).val(17):"icmp"===e?$(o).val(1):(t||i&&_.contains(["6","17","1"],s))&&$(o).val(""),t||i||r?a.val("Any"):n?a.val("N/A"):"N/A"==a.val()&&a.val("Any"),a.trigger("change")}),n.trigger("change"),t.is_config_template?(e.dst_cidr&&new FirewallCIDRWidget(l.find(".dst_cidr")).setData(e.dst_cidr,t.wired_vlans),e.src_cidr&&new FirewallCIDRWidget(l.find(".src_cidr")).setData(e.src_cidr,t.wired_vlans)):t.is_templated_vpn_firewall&&(e.dst_cidr&&new VpnFirewallCIDRWidget(l.find(".dst_cidr")).setData(e.dst_cidr,t.templates_vlans_hash),e.src_cidr&&new VpnFirewallCIDRWidget(l.find(".src_cidr")).setData(e.src_cidr,t.templates_vlans_hash))}function FirewallCIDRWidget(e){this.$td=$(e),this.$select=$(e).find("select")}function VpnFirewallCIDRWidget(e){this.$td=$(e),this.$select=$(e).find("select")}function run_with_tmpl(e,t,n){e&&$(e).length?t():jQuery.get(n||Mkiconf.template_path,function(e){jQuery("body").append(e),t&&t()})}function sort_array(e,t,n,r){for(var a=[],i=[],o=0;o<e.length;o++){var s=e[o];s[t]&&!isNaN(parseInt(s[t]))&&(a[parseInt(s[t])-n]=s)}for(var o=0,l=0;o<a.length;o++)a[o]&&(i[l]=a[o],l++);return i}function remove_from_array(e,t,n){n=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n)}function remove_element(e,t){for(var n=0;n<e.length;n++)$.isFunction(t)?t(e[n])&&remove_from_array(e,n):e[n]==t&&remove_from_array(e,n)}function link_to_node_group(e,t){if(!Mkiconf||!Mkiconf.administered_networks||!Mkiconf.administered_networks[e])return"<span>"+(t||"unknown")+"</span>";var n=Mkiconf.administered_networks[e];return link_to(mki_manage_url(e,n.t),t||n.n)}function render_joined_with_commas(e){return e?e.join(", "):""}function random_password(){for(var e="23456789",t="abcdeghjkmnpqrtuvwxyz",n=e+t,r=new Array(12),a=0;a<12;a++)r[a]=a;var r=r.sort(function(){return Math.round(Math.random())}),i=new Array(12);for(i[r[0]]=e.charAt(Math.floor(Math.random()*e.length)),i[r[1]]=t.charAt(Math.floor(Math.random()*t.length)),i[r[2]]=t.charAt(Math.floor(Math.random()*t.length)).toUpperCase(),a=0;a<12;a++)null==i[a]&&(i[a]=n.charAt(Math.floor(Math.random()*n.length)));return i.join("")}function truncate(e,t){if(e.length<=t)return e;return e.substring(0,t-"...".length)+"..."}function set_page_loading_status(e){window.page_loading_status=e,$(window).trigger("page_loading_status_changed")}function inc_page_loading_status(){set_page_loading_status(window.page_loading_status+1)}function arr_to_int_list(e){for(var t,n,r="",a=0;a<e.length;a++)e[a]?(void 0===t&&(r+=""===r?a:", "+a,t=a),n=a):(t!==n&&(r+="-"+n),t=n=void 0);return t!==n&&(r+="-"+n),r}function int_list_contains(e,t){for(var n=e.split(","),r=0;r<n.length;r++){var a,i=n[r].replace(/\s+/g,"");if(a=i.match(/^(\d+)$/)){if(a[1]==t)return!0}else if((a=i.match(/(\d+)-(\d+)/))&&a[1]<=t&&a[2]>=t)return!0}return!1}function ip2identifier(e){e=e.split(".");return(parseInt(e[1])<<16)+(parseInt(e[2])<<8)+parseInt(e[3])}function isiPad(){return null!=navigator.userAgent.match(/iPad/i)}function isiPhone(){return-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod")}function case_insensitive_sort(e,t){return e.toLowerCase().localeCompare(t.toLowerCase())}function put_param_in_search(e,t){var n=Object.fromEntries(new URLSearchParams(window.location.search));return n[e]=t,"?"+jQuery.param(n)}function distance_of_time_in_words(e,t){e=Math.round(Math.abs((t-e)/6e4));return 0==e?"less than a minute":1==e?"1 minute":e<45?e+" minutes":e<90?"about 1 hour":e<1440?"about "+Math.round(e/60)+" hours":e<2160?"about 1 day":e<43200?Math.round(e/1440)+" days":e<86400?"about 1 month":e<525600?Math.round(e/43200)+" months":e<1051200?"about 1 year":"over "+Math.round(e/525600)+" years"}"undefined"!=typeof google_maps_script_url&&(Mkiconf.v3_maps_enabled||googleMapsLoad()),window.mki_odometer=function(m){function g(){m(this).remove()}function d(e){for(var t=[],n=(e=e.toString()).length-1;0<=n;--n)t.push(+e.charAt(n));return t}return function e(t,n,r){var a,i,o,s,l,c,u=r&&r.duration||500;if(1<(t="string"==typeof t||t.nodeType?m(t):t).length){for(a=0;a<t.length;++a)e(m(t[a]),n);return t}if(!t.length&&window.console&&console.log&&console.log("bad mki_odometer"),null==n)return t.empty(),t.data("mki_odometer",null),t;if((s=t.data("mki_odometer"))===+n)return t;for(l=null==s?[]:d(s),c=d(+n),0==l.length&&t.empty(),r=0==l.length||n<s,o=t.children().toArray(),i=Math.max(l.length,c.length,o.length);l.length<i;)l.push(0);for(;c.length<i;)c.push(0);for(;o.length<i;)o.unshift(m("<span style='display:inline-block;position:relative;overflow:hidden'>&nbsp;</span>").prependTo(t));return r?function(e,t,n){for(var r,a,i=t.length,o=0;o<i;++o)(r=m(e[i-o-1])).children("div.current").removeClass("current").fadeOut(n,g),a=m("<div class='current' style='position:absolute;left:0;top:0;display:none'>"+t[o]+"</div>").appendTo(r),r.width(function(e,t){return Math.max(t,a.width())}),a.fadeIn(n)}(o,c,u):function(e,t,n,r,a,i){for(var o,s,l,c,u,d,_=n.length,p=a-r,f=m(e[0]).height(),h=0;h<_&&!((l=t[h])==(c=n[h])&&p<1);++h,p/=10){for(s=[],l=(l+1)%10,o=1;o<20&&o<p;++o,l=(l+1)%10)s.push(l);for(;l!=c;l=(l+1)%10)s.push(l);(u=m(e[_-h-1])).children("div.current").removeClass("current").animate({top:-(s.length+1)*f},{duration:i,complete:g}),s.length&&m("<div style='position:absolute;left:0;top:"+f+"px'>"+s.join("<br />")+"</div>").appendTo(u).animate({top:-s.length*f},{duration:i,complete:g}),d=m("<div class='current' style='position:absolute;left:0;top:"+(s.length+1)*f+"px'>"+n[h]+"</div>").appendTo(u),u.width(function(e,t){return Math.max(t,d.width())}),d.animate({top:0},{duration:i})}}(o,l,c,s,n,u),t.data("mki_odometer",+n),t}}(window.jQuery),window.hohelp=function(v,y){var r,w=null,b=null,k=null,x="",M=!1,j=0,A=0,C=null,$=0,E=[6,7,7,7],T=8,D=13,Q=14,O=27,N=15,P=[8,4,4,4];function I(){w&&w.stop(!0,!0).hide(),x="",k=null,M=!1}function z(){C=null,0!=j||0!=A||M||I()}function S(e,t,n,r,a){var i=e[n],o=0,a=null!=a?0<a?a:i+a:i;e[t]+=y.max(o=null!=r?0<r?r:i+r:o,0),e[n]=y.max(a-o,0)}function e(e,t){if(!(t=void 0===t?!r(e).data("has_hohelp"):t))return r(e).data("has_hohelp",!1).hohelp();var n=r(e).data("hh");n||r.each(r(e).attr("class").split(/\s+/),function(e,t){n=n||Mkiconf.hohelp_map[t]}),n&&("function"==typeof n&&(n=n(e)),r(e).data("hash_hohelp",!0).hohelp(n,{nostack:!0}))}function R(e,t,n,r){var a,i,o,s,l,c,u,d,p,f,h,m,g;if(n=n||{},(e=(e="string"==typeof e?v(e):e)&&e.jquery?e[0]:e)&&!t&&k&&k!=e)return!1;if(M&&!n.sticky)return!1;if(e&&!t&&!n.nostack&&!n.sticky&&0<j&&0<--j)return!1;if(e&&t&&e==k&&t==x&&!r)return 0!=j&&(n.nostack||n.sticky)||++j,!1;if(C&&(clearTimeout(C),C=null),!e||!t)return j=0,n.sticky?I():C=setTimeout(z,n.delay||180),!1;if(++$,k=e,x="string"!=typeof t||t,M=n.sticky,j=1,A=0,!(n.sticky||r||w&&w.is(":visible")))return setTimeout((c=e,u=t,p=$,function(){p==$&&0<j&&R(c,u,d,!0)}),(d=n).delay||300),!1;if(w&&e!=k?w.stop(!0,!0).hide().fadeIn("fast"):(w||(w=v('<table id="hover_help_container" style="display:none;position:absolute;z-index:1500" class="lean"><tbody><tr><td><div style="position:relative"><div id="hover_help_pointer" class="hhptr_up" style="position:absolute;font-size:x-small">&nbsp;</div><table class="hover_body lean"><tbody><tr><td class="hhsh_tl" style="width:'+E[3]+"px;height:"+E[0]+'px"></td><td class="hhsh_t" style="height:'+E[0]+'px"></td><td class="hhsh_tr" style="width:'+E[1]+"px;height:"+E[0]+'px"></td></tr><tr><td class="hhsh_l" style="width:'+E[3]+'px"></td><td id="hover_help_contents"></td><td class="hhsh_r" style="width:'+E[1]+'px"></td></tr><tr><td class="hhsh_bl" style="width:'+E[3]+"px;height:"+E[2]+'px"></td><td class="hhsh_b" style="height:'+E[2]+'px"></td><td class="hhsh_br" style="width:'+E[1]+"px;height:"+E[2]+'px"></td></tr></tbody></table></div></td></tr></tbody></table>'),v("body").append(w),w.find("#hover_help_pointer, .hover_body").mouseover(function(){++A}).mouseout(function(){0<A&&0==--A&&(C&&clearTimeout(C),C=setTimeout(z,180))}),b=w.find("#hover_help_contents")),w.fadeIn("fast")),(l={l:(h=v(window)).scrollLeft(),t:h.scrollTop(),w:h.width(),h:h.height()}).lp=l.l+T,l.rp=l.l+l.w-T,l.tp=l.t+T,l.bp=l.t+l.h-T,i=n.offsets||n.offset)for(a=Array.isArray(i)?i:[i],f=0;f<4;++f)a[f]=v.extend({},a[f]||a[2^f]||a[3^f]||a[1^f]),a[f].l=a[f].l||a[f].left,a[f].t=a[f].t||a[f].top;else r=n,e=v(h=e),(g=e.offset()).w=r.elem_width||e.outerWidth(),g.h=r.elem_height||e.outerHeight(),g.l=g.left-(g.w-(r.elem_width||e.width()))/2,g.t=g.top-(g.h-(r.elem_height||e.height()))/2,S(g,"l","w",r.left,r.right),S(g,"t","h",r.top,r.bottom),g=[{l:g.l+g.w/2,t:g.t+y.min(P[0],g.h)},{l:g.l+g.w-y.min(P[1],g.w),t:g.t+g.h/2},{l:g.l+g.w/2,t:g.t+g.h-y.min(P[2],g.h+1)},{l:g.l+y.min(P[3],g.w),t:g.t+g.h/2}],r.aboveoffset&&"number"==typeof r.aboveoffset?g[0].t-=r.aboveoffset:r.aboveoffset&&(m=v(r.aboveoffset)).length&&(g[0].t-=v(h).offset().top-m.offset().top),a=g;for(_.isString(t)?(n.no_hohelp_replace||-1!==t.indexOf("no_hohelp_replace")||(t=R.prepare_html(t)),b.html("<div><div class='hover_help_contents "+(n.className||"")+"'>"+t+"</div></div>")):(b.html("<div><div class='hover_help_contents'></div></div>"),b.find(".hover_help_contents").append(t)),m=b.children(),i=E[1]+E[3],g=y.max(y.min(m.width()+i+1,n.max_width||300,l.w-2*T),100),n.no_fixed_width||m.width(g-i),t=m.height()+E[0]+E[2],i=y.max(l.lp,y.min(l.rp-g,a[0].l+O-g)),o=[{l:i,t:a[0].t-t-(Q-E[2])+1}],m=y.max(l.tp,y.min(l.bp-t,a[1].t-t/2)),o[1]={l:a[1].l+(Q-E[1]),t:m},i=y.max(l.lp,y.min(l.rp-g,a[2].l+O-g)),o[2]={l:i,t:a[2].t+(Q-E[0])},m=y.max(l.tp,y.min(l.bp-t,a[3].t-t/2)),o[3]={l:a[3].l-g-(Q-E[3])+1,t:m},o[0].o=l.t-o[0].t,o[1].o=o[1].l+g-(l.l+l.w),o[2].o=o[2].t+t-(l.t+l.h),o[3].o=l.l-o[3].l,s=n.above?[0,2]:[2,0],n.atleft&&s.unshift(3),n.atright&&s.unshift(1),f=0;f<s.length&&0<o[s[f]].o;++f);return f>=s.length&&(s.sort(function(e,t){return o[e].o-o[t].o}),f=0),s=s[f],o=o[s],n=w.find("#hover_help_pointer"),m=a[s][1&s?"t":"l"]-o[1&s?"t":"l"],m=y.max(N,y.min((i=1&s?t:g)-N,m))-D/2-.5,0==s?n.css({left:y.floor(m),top:t-E[2]-1}):1==s?n.css({left:E[3]-Q+1,top:y.floor(m)}):2==s?n.css({left:y.floor(m),top:E[0]-Q+1}):n.css({left:g-E[1]-1,top:y.floor(m)}),n[0].className="hhptr_"+["down","left","up","right"][s],w.css({left:y.round(o.l),top:y.round(o.t)}),!1}return jQuery.fn.hohelp=function(e,t){return this.each(function(){R(this,e,t)})},r=jQuery,Mkiconf.hohelp_map={},r(function(){r("body").on("mouseover",".auto_hohelp",function(){e(this,!0)}).on("mouseout",".auto_hohelp",function(){e(this,!1)}).on("click",".auto_hohelp",function(){return e(this),!1})}),R.prepare_html=function(e){e=e.replace(/(?:\s*<br\s*\/?>|\s*\n){2,}/g,"<br/><br/>\n");return e=Mkiconf&&!Mkiconf.has_wireless&&Mkiconf.devices_noun?(e=Mkiconf.devices_noun_plural?e.replace(/access points/g,Mkiconf.devices_noun_plural).replace(/Access points/g,Mkiconf.devices_noun_plural_cap):e).replace(/access point/g,Mkiconf.devices_noun).replace(/Access point/g,Mkiconf.devices_noun_cap).replace(/\bAP\b/g,Mkiconf.devices_noun_abbrev_cap).replace(/\bAPs\b/g,Mkiconf.devices_noun_abbrev_plural_cap):e},R}(jQuery,Math),window.dashhelp=function(){var d={};function c(e){return!Mkiconf.update_help_message_url||Mkihelp[e]||void 0===e?"asx_p fa fa-info-circle":"asx_np fa fa-info-circle"}function u(e,t,n,r){var a,i,o;e.unbind("mouseover.dashhelp").unbind("mouseout.dashhelp"),Mkihelp[n]&&(a="#"+t,i=n,o=r,e.bind("mouseover.dashhelp",(e=[function(){hohelp(a,Mkihelp[i],o)},function(){hohelp(a)}])[0]).bind("mouseout.dashhelp",e[1]))}function p(e,t,n,r){Mkihelp[n]=e.text,Mkihelp.drafts[n]=e.draft_text,u(jQuery(r._t),t,n,r),jQuery("#"+t)[0].className=c(n)}function f(t,n,r,a){jQuery.getJSON(Mkiconf.update_help_message_url,{name:n,page_name:Mkihelp.page_name||Mkihelp.page_names[n]},function(e){d[n]||(d[n]=!0,p(e,t,n,r),a())}),setTimeout(function(){d[n]||(d[n]=!0,a())},5e3)}function h(l,c,u){function e(e,t){var r,a,i,o,n=jQuery(e).closest("form"),s=Mkihelp.page_name||Mkihelp.page_names[c],s=n.serialize()+"&"+t+"=1&page_name="+encodeURIComponent(s);return jQuery.ajax({type:"POST",url:Mkiconf.update_help_message_url,data:s,dataType:"json",error:(o=e,function(e,t,n){var r=jQuery(o).closest("form");r.find(".notice_explanation").html(xhr_extract_error_json(e).error).show(),r.css("opacity",1)}),success:(r=l,a=c,i=u,function(e,t,n){p(e,r,a,i),hohelp("#"+r,null,{sticky:"dashedithelp"})})}),n.css("opacity",.5),!1}function n(){return hohelp("#"+l,null,{sticky:"dashedithelp"})}function r(){return e(this,"abandon")}function a(){return e(this,"approve")}function i(){return e(this,"save")}function o(){var e=jQuery(this).closest("form");return Mkihelp.drafts[c]=e.find("textarea").val(),(e=jQuery("<div><div style='text-align:right;font-size:11px;padding-bottom:3px'><a class='previewer' href='#'>Edit draft</a> &nbsp; <a class='q closer' href='#'>X</a></div><div class='helppreview'></div></div>")).find("a.previewer").click(s),e.find("a.closer").click(n),e.find(".helppreview").html(hohelp.prepare_html(Mkihelp.drafts[c])),hohelp("#"+l,e,{sticky:"dashedithelp"})}function s(e){var t=[];return e&&e.stopPropagation(),Mkiconf.sync_help_messages&&!d[c]?(hohelp("#"+l,"Loading..."),f(l,c,u,s)):(t.push("<form action='"+Mkiconf.update_help_message_url+"' method='post' enctype='multipart/form-data' style='font-size:11px'>"),t.push("<div style='text-align:right'><a class='previewer' href='#'>Preview draft</a> &nbsp; <a class='q closer' href='#'>X</a></div>"),t.push("<div class='notice_explanation bad' data-testid='error-notice' style='display:none'></div><div>"),t.push("<strong>HTML help text for &ldquo;"+c+"&rdquo;</strong>"),Mkihelp.drafts[c]&&Mkihelp[c]?t.push("<br />This <em>draft</em> help differs from the user-visible help."):Mkihelp.drafts[c]&&t.push("<br />This <em>draft</em> help is not shown to normal users."),t.push("<textarea name='text' rows='8' style='width:240px;font-size:100%'></textarea><div style='text-align:right'>"),t.push("<input type='hidden' name='name' />"),Mkihelp.drafts[c]&&t.push("<input type='submit' name='abandon' value='Delete draft' style='font-size:100%' />&nbsp; "),t.push("<input type='submit' name='save' value='Save draft' style='font-size:100%' />&nbsp; "),t.push("<input type='submit' name='approve' value='Publish' style='font-size:100%;font-weight:bold' />"),t.push("</div></div></form>"),(t=jQuery(t.join(""))).find("input[name=name]").val(c),t.find("textarea").text(Mkihelp.drafts[c]||Mkihelp[c]||""),t.find("a.previewer").click(o),t.find("a.closer").click(n),t.find("input[name=abandon]").click(r),t.find("input[name=approve]").click(a),t.find("input[name=save]").click(i),hohelp("#"+l,t,{sticky:"editdashhelp"}),t.find("textarea")[0].focus()),!1}return s}function m(e,t,n){var r,a,i,o,s,l;if((t=t&&(_.isString(t)||t.jquery||t.nodeType)?{trigger_selector:t}:t)&&n&&(t=_.extend({},t,n)),_.isArray(e))for(o=0;o<e.length;++o)m(e[o],t);else _.isObject(e)&&(e=(t=_.extend({},e,t||{})).name),s={_t:(t=t||{})&&t.trigger_selector||"#"+e+"_header"},t&&t.above&&_.extend(s,{above:!0,aboveoffset:s._t}),t&&t.no_hohelp_replace&&(s.no_hohelp_replace=!0),t&&t.no_fixed_width&&(s.no_fixed_width=!0),(r=jQuery(s._t)).hasClass("dashhelp_initialized")||(r.addClass("dashhelp_initialized"),a=jQuery((t?t.marker_selector:null)||s._t),i=!!Mkiconf.update_help_message_url,0!=r.length&&0!=a.length&&(i||Mkihelp[e])&&(n=_.uniqueId("dashhelpa_"),t&&t.nospace||a.append(" "),t&&t.no_info_icon?u(r,(s._t.selector||"").slice(1),e,s):(l=t.icon_class||c(e),(l=jQuery("<i id='"+n+"' class='"+l+"' alt='[Help]' />")).appendTo(a),u(r,n,e,s)),i&&l.click(h(n,e,s))))}return m.icon=function(e){return"<i class='"+(c()+" "+(e||""))+"' alt='[Help]' />"},m}(),window.mkistartdrag=function(o){return function(t,e){var r;function n(e,t){var n="BODY"==this.tagName.toUpperCase()?0:1,e=r[e];return r[n]=t,e}function a(e){(e=o.event.fix(e||window.event)).type="mkidrag",o(t).trigger(e),e.stopPropagation()}function i(e){document.addEventListener?(document.removeEventListener("mousemove",a,!0),document.removeEventListener("mouseup",i,!0)):(t.detachEvent("onmousemove",a),t.detachEvent("onmouseup",i),t.detachEvent("onlosecapture",i),t.releaseCapture()),r&&(o(t).css("cursor",n),o("body").css("cursor",n)),(e=o.event.fix(e||window.event)).type="mkidragend",o(t).trigger(e),e.stopPropagation()}if(t.jquery&&(t=t[0]),document.addEventListener)document.addEventListener("mousemove",a,!0),document.addEventListener("mouseup",i,!0);else{if(!document.attachEvent)return!1;t.setCapture(),t.attachEvent("onmousemove",a),t.attachEvent("onmouseup",i),t.attachEvent("onlosecapture",i)}e&&e.cursor?(r=[e.cursor,e.cursor],o(t).css("cursor",n),o("body").css("cursor",n)):r=null}}(jQuery),jQuery.expr.pseudos.focus=function(e){return e===document.activeElement&&(e.type||e.href)},function(t){t.fn.hashify=function(){var e={};return t(":input:not(.nosave, [disabled])",t(this)).filter("[name]").each(function(){return!t(this).is(":disabled")&&void("radio"==t(this).attr("type")&&e[t(this).attr("name")]||function(e,t,n){var r=t,a=t.split("]["),i=a.length-1,o=null;if(i=/\[/.test(a[0])&&/\]$/.test(a[i])?(a[i]=a[i].replace(/\]$/,""),(a=a.shift().split("[").concat(a)).length-1):0)for(var o=e,s=0;s<=i;s++)o=o[r=""===a[s]?o.length:a[s]]=s<i?o[r]||(a[s+1]&&isNaN(a[s+1])?{}:[]):n;else Array.isArray(e[r])?e[r].push(n):void 0!==e[r]?e[r]=[e[r],n]:e[r]=n}(e,t(this).attr("name"),t(this).mval()))}),e}}(jQuery),FirewallCIDRWidget.prototype.setData=function(e,r){var a,i=this,o=0<i.$select.length;o&&i.$select.empty();var s=[];this.$select.empty(),_.each(e.split(","),function(e){var t=e.trim(),n={value:t,text:t};(a=t.match(/^(\d+)(\.\d+)?$/))&&(e=a[1],e=_.findWhere(r,{guid:e}).name,t=t.replace(/\d+/i,e),n.text=t),o?$("<option />",n).prop("selected",!0).appendTo(i.$select).trigger("chosen:updated"):s.push(t)}),o||(i.$td.empty(),i.$td.text(s.join(", ")))},VpnFirewallCIDRWidget.prototype.setData=function(e,i){var o,s=this,l=0<s.$select.length;l&&s.$select.empty();var c=[];_.each(e.split(","),function(e){var t,n,r={value:e=e.trim(),text:e},a=e;(o=e.match(/^(\d+)\.(\d+)(\.\d+)?$/))&&(t=o[1],n=o[2],e=o[3],n=void 0===(t=i[t])?"":t.vlans[n].name,a=(void 0===t?"":t.name)+"."+n,e&&(a+=e),r.text=a),l?$("<option />",r).prop("selected",!0).appendTo(s.$select).trigger("chosen:updated"):c.push(a)}),l||(s.$td.empty(),s.$td.text(c.join(", ")))},jQuery.fn.enable_password_pair_events=function(){var e=jQuery(this);return e.find(".password_pair").change(function(){var e;return jQuery(this).is(":visible")?jQuery(this).siblings(".password_pair").val(jQuery(this).val()).change():(e=jQuery(this).parent().children(".password_pair"),"password"!=jQuery(this).attr("type")||e.is(":visible")||e.filter(":not([type='password'])").val(jQuery(this).val()).change()),!0}),e.find("a.show_key_link").click(function(){var e=jQuery(this).siblings("input.password_pair:password").is(":visible"),t=jQuery(this).text(),t=e?t.replace(/Show/,"Hide"):t.replace(/Hide/,"Show");return jQuery(this).siblings("input.password_pair").toggle(),jQuery(this).siblings("label").attr("for",jQuery(this).siblings("input:visible").attr("id")),jQuery(this).html(t).blur(),!1}),e},function(e){e.fn.enterKey=function(t){return this.each(function(){e(this).keydown(function(e){13==e.which&&t.call(this,e)})})}}(jQuery),jQuery("body").on("dblclick",".atomic",function(){var e;window.getSelection&&document.createRange?((e=document.createRange()).selectNodeContents(this),window.getSelection().addRange(e)):document.body.createTextRange&&((e=document.body.createTextRange()).moveToElementText(this),e.select())}),jQuery.fn.build_firewall_rules_editor=function(e){jQuery(this).children().remove();var t=e.is_config_template||e.is_templated_vpn_firewall,n=[{type:"ordernum",classname:"order",defaulttext:"&nbsp;",headername:"#"},{type:e.readonly?"plaintext":"inputselect",classname:"policy",options:[["Deny","deny"],["Allow","allow"]],render_value_fn:e.readonly?function(e){return e&&"allow"!=e?"Deny":"Allow"}:null,defaulttext:e.has_l3fw_default_deny?"Deny":"Allow",headername:"Policy"}],r={classname:"proto",type:e.readonly?"plaintext":"inputselect",render_value_fn:e.readonly?function(e){return e&&"any"!=e?e.toUpperCase():"Any"}:null,defaulttext:"Any",headername:"Protocol"};e.custom_ip_protocol?(r.options=[["TCP","tcp"],["UDP","udp"],["ICMP","icmp"],["Any","any"],["Custom","cust"]],n.push(r),n.push({classname:"custom_proto",type:"inputnumber",defaulttext:"&nbsp;",headername:"Protocol ID"})):(e.has_icmp_firewall?r.options=[["TCP","tcp"],["UDP","udp"],["ICMP","icmp"],["Any","any"]]:r.options=[["TCP","tcp"],["UDP","udp"],["Any","any"]],n.push(r)),e.include_src_options&&(t?n.push({classname:"src_cidr",type:e.readonly?"plaintext":"chosen",defaulttext:"Any",headername:"Sources",multi:!0,options:["Placeholder","Not used"],chosen_opts:e.chosen_opts_src}):n.push({classname:"src_cidr",type:e.readonly?"plaintext":"inputtext",defaulttext:"Any",headername:"Source",size:20}),n.push({classname:"src_port",type:e.readonly?"plaintext":"inputtext",defaulttext:"Any",headername:"Src port",size:10})),t?n.push({classname:"dst_cidr",type:e.readonly?"plaintext":"chosen",defaulttext:"Any",headername:"Destinations",multi:!0,options:["Placeholder","Not used"],chosen_opts:e.chosen_opts_dst}):n.push({classname:"dst_cidr",type:e.readonly?"plaintext":"inputtext",defaulttext:"Any",headername:"Destination",size:20}),n.push({classname:"dst_port",type:e.readonly?"plaintext":"inputtext",defaulttext:"Any",headername:e.include_src_options?"Dst port":"Port",size:10}),e.include_vlan_options&&n.push({classname:"vlan",type:e.readonly?"plaintext":"inputtext",defaulttext:"Any",headername:"VLAN",size:5}),n.push({classname:"comment",type:e.readonly?"plaintext":"inputtext",defaulttext:"Default rule",headername:"Comment",size:25}),e.allows_disable&&n.push({type:e.readonly?"plaintext":"inputselect",classname:"enabled",options:[["Enabled","enabled"],["Disabled","disabled"]],defaulttext:"Enabled",headername:"Enabled"}),e.has_syslog&&n.push({classname:"logging",type:e.readonly?"plaintext":"inputselect",options:[["Enabled","true"],["Disabled","false"]],render_value_fn:e.readonly?function(e){switch(e.toLowerCase()){case"true":return"Enabled";case"false":return"Disabled"}return e}:null,defaulttext:null===e.default_rule_logging||e.default_rule_logging?"true":"false",defaulteditable:e.default_rule_editable||!1,headername:"Logging"}),e.has_firewall_counters&&n.push({classname:"counter",type:"custom",defaulttext:'<span class="data">0</span>',custom_cell_func:function(e,t,n){return e.defaulttext},headername:"Hits",size:25}),e.readonly||n.push({classname:"actions",type:"actions",defaulttext:"&nbsp;",headername:"Actions"});t=!0;e.no_default_allow_all&&(t=!1),_.each(e.rules,function(e){_.contains(["tcp","udp","icmp","any"],e.proto)||(e.custom_proto=e.proto,e.proto="cust")}),$(this).flex_editor({columns:n,row_create_callback:firewall_row_create_callback,rendered_callback:e.rendered_callback,add_text:e.add_text||"Add a rule",sortable:!0,hide_headers_when_empty:!1,initialize_tracking:!0,has_add_link:e.has_add_link||!e.readonly,has_default_row:t,is_config_template:!!e.is_config_template,is_templated_vpn_firewall:!!e.is_templated_vpn_firewall,wired_vlans:e.wired_vlans,templates_vlans_hash:e.templates_vlans_hash,rows:e.rules})},function(n){n.fn.chosen_small=function(e){var e=this.wrap(n("<span>",{class:"chosen-small"})).chosen(e),t=this;return e.select_all=function(){t.find("option").prop("selected",!0),t.trigger("chosen:updated"),t.trigger("change")},e}}(jQuery),function(t){t.fn.chosen_vertical=function(e){return this.wrap(t("<span>",{class:"chosen-vertical"})).chosen(e)}}(jQuery),$("body").on("click",".dropdown-widget, .search-choice-close",function(e){e.stopPropagation()});var MKI={};function match_serial(e,t,n,r){var a=[];return(e=e.replace(/[_\s\"]/,"")).match(/^[-0-9a-f]+$/i)&&a.push(r.index_of_match("x.serial",e,t,!1)),e.match(/^[-2-9A-HJ-NP-Z]+$/i)&&a.push(r.index_of_match("x.serial",e.toUpperCase(),t,!0)),a.length||a.push("false"),"x.serial && "+a.join("||")}function show_changes_hash(e){var r=$("#changes_hash tbody").empty();_.each(e,function(t){var n=$("<tr>").appendTo(r);_(["label","old_text","new_text"]).each(function(e){$("<td>").text(t[e]).appendTo(n)})}),$("#changes_hash").show()}function render_safe_html(e,t){return e.html_safe&&e.html_safe[t]?e[t]:_.escape(e[t])}function smartcmp(e,t){var n,r;if(null==e&&(e=""),null==t&&(t=""),t+="",(e+="").match(/^-?\d+(?:\.\d+)?$/)&&t.match(/^-?\d+(?:\.\d+)?$/))return numcmp(e,t);if((n=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/))&&(r=t.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/))){n[1],n[2],n[3],n[4],r[1],r[2],r[3],r[4];return numcmp(+n[1],+r[1])||numcmp(+n[2],+r[2])||numcmp(+n[3],+r[3])||numcmp(+n[4],+r[4])}return strcmp(e,t)}function node_is_dedicated_air_marshal(e){return e&&e.tags&&e.tags.match(/ airmarshal /i)&&!e.has_scanning_radio}function get_tags(e){return"string"==typeof e?_.compact($.trim(e).split(/\s+/)):e||[]}function get_tag_string(e){return 0==(e||[]).length?"":" "+update_tags(e).join(" ")+" "}function update_tags(e){return _.uniq(_.compact(e||[]).sort())}function add_tag(e,t){return add_tags([e],t)}function add_tags(e,t){return update_tags(_.union(e,t))}function delete_tag(e,t){return delete_tags([e],t)}function delete_tags(t,e){return update_tags(_.reject(e,function(e){return 0<=_.indexOf(t,e)}))}MKI.mtunnel_state_lookup={0:"UNREACHABLE",1:"REACHABLE",2:"NODE_GOOD",3:"NODE_BAD_GW",4:"GATEWAY_GOOD",5:"GATEWAY_BAD",6:"NODE_CHECK",7:"GATEWEAY_IPCONFLICT",8:"GATEWAY_ASYMMETRIC",9:"NODE_ASYMMETRIC",10:"PCC_GOOD",11:"PCC_OFF",12:"PCC_NO_AP",13:"PCC_NO_IP",14:"PCC_NO_INET",15:"PCC_NO_DNS",16:"PCC_SUSPENDED",17:"GATEWAY_BAD_STATIC",18:"GATEWAY_DNS_DOWN",19:"NODE_BOOT_REBOOT",20:"UPGRADE_REBOOT",21:"DORMANT",22:"GATEWAY_BAD_VLAN"},MKI.node_healthy={UNREACHABLE:!1,REACHABLE:!0,NODE_GOOD:!0,NODE_BAD_GW:!1,GATEWAY_GOOD:!0,GATEWAY_BAD:!1,NODE_CHECK:!1,GATEWEAY_IPCONFLICT:!1,GATEWAY_ASYMMETRIC:!1,NODE_ASYMMETRIC:!1,PCC_GOOD:!0,PCC_OFF:!1,PCC_NO_AP:!1,PCC_NO_IP:!1,PCC_NO_INET:!1,PCC_NO_DNS:!1,PCC_SUSPENDED:!1,GATEWAY_BAD_STATIC:!1,GATEWAY_DNS_DOWN:!1,NODE_BOOT_REBOOT:!1,UPGRADE_REBOOT:!1,DORMANT:null,GATEWAY_BAD_VLAN:!1},MKI.node_health_status={UNREACHABLE:0,REACHABLE:1,NODE_GOOD:1,NODE_BAD_GW:2,GATEWAY_GOOD:1,GATEWAY_BAD:2,NODE_CHECK:2,GATEWEAY_IPCONFLICT:2,GATEWAY_ASYMMETRIC:2,NODE_ASYMMETRIC:2,PCC_GOOD:1,PCC_OFF:2,PCC_NO_AP:2,PCC_NO_IP:2,PCC_NO_INET:2,PCC_NO_DNS:2,PCC_SUSPENDED:2,GATEWAY_BAD_STATIC:2,GATEWAY_DNS_DOWN:2,NODE_BOOT_REBOOT:2,UPGRADE_REBOOT:2,DORMANT:3,GATEWAY_BAD_VLAN:2},_.mixin({nilCompact:function(e){return _.filter(e,function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))})},ids:function(e){return _.pluck(e,"id")},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},downcase:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},checked:function(e){return _.where(e,{checked:!0})},chunk:function(n,r){return[].concat.apply([],n.map(function(e,t){return t%r?[]:[n.slice(t,t+r)]}))},clamp:function(e,t,n){return Math.min(Math.max(e,t),n)},to_i:function(e){return _.isArray(e)?_.map(e,function(e){return parseInt(e,10)}):parseInt(e,10)},objMap:function(r,a,i){return _.reduce(r,function(e,t,n){return e[n]=a.call(i,t,n,r),e},{},i)},objFilter:function(r,a,i){return _.reduce(r,function(e,t,n){return a.call(i,t,n,r)&&(e[n]=t),e},{},i)},objReject:function(r,a,i){return _.reduce(r,function(e,t,n){return a.call(i,t,n,r)||(e[n]=t),e},{},i)},sum:function(e){return _.reduce(e,function(e,t){return e+t},0)}});var make_flash=function(){var a=0;return function(e,t){var n=(t=t||{}).element_id||"notice_"+a++,r=t.message_class||"success",t=$("<div/>");return t.attr("id",n).addClass("alert alert-"+r).html(e),$("#sidetabs_body_container").prepend(t),t}}();function optionValue(e,t){return"value="+e+((_.isArray(t)?_.contains(t,e):e==t)?" selected":"")}function tag_display_name(t){if(null!=Mkiconf.available_tags){var e=_.find(Mkiconf.available_tags,function(e){return e.tag==t});if(e&&void 0!==e.display_name)return e.display_name}return t}function network_types_and_names(e){var t="wireless";return e.has_wireless?t="wireless":e.has_pcc?t="systems manager":e.has_vm_concentrator?t="vm concentrator":e.has_switch?t="switch":e.has_wired&&(t="appliance"),t}function strip_punctuation_and_spaces(e){return e.replace(/[\.,\/!$%\^;:=`\s+]/g,"_")}function set_default_color_palette(){void 0!==Mkiconf.color_blind_modes&&$("body").removeClass(_.keys(Mkiconf.color_blind_modes).join(" "));var e=$.color.named_color;e("mki_green",[122,192,67]),e("mki_dark_green",[109,200,109]),e("mki_light_green",[156,183,104]),e("mki_dark_green_high_contrast",[88,205,45]),e("mki_light_green_high_contrast",[103,171,81]),e("mki_light_gray",[238,233,233]),e("mki_dark_gray",[139,137,137]),e("mki_orange",[203,114,19]),e("mki_red",[221,0,0]),e("mki_yellow",[203,176,19]),e("mki_bright_yellow",[255,207,0]),e("mki_bright_red",[255,9,0])}function set_color_palette(e){var t;"undefined"!=typeof $&&void 0!==$.color&&(set_default_color_palette(),t=$.color.named_color,"color_blind_red_green"==e&&($("body").addClass(e),t("mki_green",[103,178,252]),t("mki_dark_green",[100,134,229]),t("mki_light_green",[173,216,270]),t("mki_dark_green_high_contrast",[90,124,219]),t("mki_light_green_high_contrast",[183,226,280])))}set_color_palette(Mkiconf.enabled_colorblind_mode);var BackgroundJobUtils={is_finished:function(e){return e&&e.status&&("complete"==e.status||"failed"==e.status)},is_active:function(e){return e&&e.status&&"complete"!=e.status&&"failed"!=e.status}};function m_to_local_date(e){var t=moment(),t=e.utcOffset()-t.utcOffset();return moment(e).add(t,"m").toDate()}!function(){var a;window.lazy_load_all_users=function(){var t,n,r;_.isEmpty(Mkiconf.all_users)&&!a&&($(Mkiconf).data("loaded:all_users",!1),$(Mkiconf).data("xhr_attempts:all_users",0),t=url_for({controller:"configure",action:"guests.json"}),n=function(e){Mkiconf.all_users=e,$(Mkiconf).data("loaded:all_users",!0),$(Mkiconf).trigger("change:all_users")},r=function(){var e=$(Mkiconf).data("xhr_attempts:all_users");1<=e?$.top_status({box_class:"bad",content:"Failed to load network user data. Please try again later."}):($(Mkiconf).data("xhr_attempts:all_users",e+1),console.log("reattempting guests"),a=$.getJSON(t).done(n).fail(r))},a=$.getJSON(t).done(n).fail(r))}}();