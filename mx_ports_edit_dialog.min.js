/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
!function(p){var v,c,l,u,m={enabled:{},is_trunk:{},access_vlan_guid:{},native_vlan_guid:{},allowed_vlans:{}},h="Multiple values";function t(){u.removeData("native_vlan_opt"),u.removeData("native_vlan_opt_was_user_selected");var e,t,a=p("<div/>"),l=p("<select/>"),o=p("<option/>");for(idx in o.attr("value",h),o.text("Multiple values"),l.append(o),Mkijson.mx_configured_vlans)e=Mkijson.mx_configured_vlans[idx],(o=p("<option/>")).attr("value",e.guid),o.text(e.desc),l.append(o);for(t in a.append(l),p(u).find("#mx_ports_edit_access_vlan_guid_container").html(a.html()),p(u).find("#mx_ports_edit_access_vlan_guid_container select").attr("id","mx_ports_edit_access_vlan_guid").attr("name","access_vlan_guid"),p(u).find("#mx_ports_edit_native_vlan_guid_container").html(a.html()),p(u).find("#mx_ports_edit_native_vlan_guid_container select").attr("id","mx_ports_edit_native_vlan_guid").attr("name","native_vlan_guid").find("option:first-child").after(p('<option value="0">Drop untagged traffic</option>')),a.find("select").attr("multiple",!0),p(u).find("#mx_ports_edit_allowed_vlans_container").html(a.html()),p(u).find("#mx_ports_edit_allowed_vlans_container select").attr("id","mx_ports_edit_allowed_vlans").attr("name","allowed_vlans").attr("data-placeholder","Choose one or more VLANs...").find("option:first-child").after(p('<option value="all">All VLANs</option>')),p(u).find("#hidden_vlans_select").empty(),Mkijson.mx_ports_has_auths&&(m.access_policy_type={}),m){var n,s,i,d=p("#mx_ports_edit_"+t),r=m[t];for(n in v)void 0!==v[n]&&(s=null===v[n][t]?"":v[n][t],i=Array.isArray(s)?s.join(", "):s,void 0===r.str_value?(r.str_value=i,r.value=s):r.str_value!=i&&(r.str_value=r.value=h));d.is("select")&&r.str_value!==h?d.find("option[value='"+h+"']").attr("disabled","disabled"):d.find("option[value='"+h+"']").attr("disabled",!1),Array.isArray(r.value)?(d.find("option").attr("selected",!1),_.each(r.value,function(e){d.find("option[value='"+e+"']").attr("selected","selected")})):d.val(r.value),r.value=r.str_value=void 0}p(u).find("#mx_ports_edit_allowed_vlans select").chosen(),p("#mx_ports_edit_enabled").change(f).change(),p("#mx_ports_edit_is_trunk").change(g).change(),p("#mx_ports_edit_native_vlan_guid").change(x).change(),p("#mx_ports_edit_allowed_vlans").change(w).change(),Mkijson.mx_ports_has_auths&&p("#mx_ports_edit_access_policy_type").change(y).change(),p("#mx_ports_edit_allowed_vlans").chosen(),p(u).find("#mx_ports_edit_allowed_vlans_chosen").css({width:"100%"}),Mkijson.mx_ports_has_auths&&p("#per_port_vlan_radius_servers").data().set_rows(c)}function a(e){var t=p(this),a={};e.preventDefault(),"disabled"!==t.attr("disabled")&&(p.each(m,function(e){var t=p("#mx_ports_edit_"+e).val();t!==h&&(a[e]=t)}),"true"!==a.enabled||"true"!==a.is_trunk||a.allowed_vlans?(t="[]",Mkijson.mx_ports_has_auths&&(t=p("#per_port_vlan_radius_servers").data().to_obj()),l(a,t,v),u.modal("hide")):alert("Choose one or more VLANs to connect to this trunk port, or disable the port."))}function f(){var e=p(this).val();u.toggleClass("not_enabled","true"!==e)}function g(){var e=p(this).val();u.toggleClass("not_access_port","false"!==e).toggleClass("not_trunk_port","true"!==e)}function x(){var e=p(this).val(),t=u.find("#mx_ports_edit_allowed_vlans option[value='"+e+"']"),a=(t=0<!t.length?u.find("#hidden_vlans_select option[value='"+e+"']"):t).attr("selected"),_=u.data("native_vlan_opt"),e=u.data("native_vlan_opt_was_user_selected");_&&0<_.length&&!e&&_.attr("selected",!1),u.data("native_vlan_opt",t),u.data("native_vlan_opt_was_user_selected",a),0<t.length&&t.attr("selected",!0),jQuery("#mx_ports_edit_allowed_vlans").trigger("chosen:updated")}function w(){var e;u.find("#mx_ports_edit_allowed_vlans option[value='all']").attr("selected")?((e=u.find("#mx_ports_edit_allowed_vlans option").not("option[value='all']")).detach(),u.find("#hidden_vlans_select").html(e)):(t=u.find("#hidden_vlans_select").children().detach(),u.find("#mx_ports_edit_allowed_vlans").append(t));var t=u.data("native_vlan_opt");t&&t.attr("selected",!0),jQuery("#mx_ports_edit_allowed_vlans").trigger("chosen:updated")}function y(){"open"===p(this).val()?u.removeClass("access_policy_type_not_open").addClass("access_policy_type_open"):u.removeClass("access_policy_type_open").addClass("access_policy_type_not_open")}window.mx_ports_edit_dialog={},mx_ports_edit_dialog.init=function(e){(u=p(e).modal({keyboard:!0,backdrop:!0,show:!1}).on("shown.bs.modal",t)).find(".btn-primary").on("click",a),e="#mx_ports_edit_modal .field label",dashhelp("mx_port_type",{trigger_selector:e+"[for='mx_ports_edit_is_trunk']"}),dashhelp("mx_port_vlan",{trigger_selector:e+"[for='mx_ports_edit_vid']"}),dashhelp("mx_port_native_vlan",{trigger_selector:e+"[for='mx_ports_edit_native_vlan_guid']"}),dashhelp("mx_port_allowed_vlans",{trigger_selector:e+"[for='mx_ports_edit_allowed_vlans']"}),dashhelp("mx_port_access_policy_type",{trigger_selector:e+"[for='mx_ports_edit_access_policy_type']"})},mx_ports_edit_dialog.show=function(e,t,a){e&&e!=={}?(v=e,c=t,l=a,u.modal("show")):log_error("mx_ports_edit_dialog:Invalid params")}}(jQuery);