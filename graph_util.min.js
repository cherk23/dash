/* Some or all contents Copyright (c) 2010-2025 Cisco Systems, Inc., all rights reserved */
var mkigraph=function(G){var f,m,u=4,n=[1,1.5,2,2.5,3,4,5,8,10],i={},s={};function g(e,t){for(var r,a=e/(t=t||u),o=1;0<a&&a<1;)a*=10,o/=10;for(;10<=a;)a/=10,o*=10;for(r=0;r<n.length&&!(n[r]>=a);r++);return n[r]*o*t}function r(e,t){var r,a,o,n,i=0,l=1,s="b/s";for(t=t||u,s=1099511627776<e.max?(i=g(e.max/(l=1099511627776),t),"Tb/s"):1073741824<e.max?(i=g(e.max/(l=1073741824),t),"Gb/s"):1048576<e.max?(i=g(e.max/(l=1048576),t),"Mb/s"):512<e.max?(l=1024,i=g(Math.max(e.max/l,1),t),"Kb/s"):(l=1,i=g(e.max,t),"b/s"),r=i/t,a=[],o=0;o<=i;o+=r)n=o.toFixed(2).replace(/\.?0*$/,"")+" "+s,a.push([o*l,n]);return a}function e(l,s,c){return function(e,t){t=t||s||u;if(e.max<e.min)return[0];var r,a,o=g(e.max,t),n=o/t,i=[];for(c&&(n=Math.ceil(o/t)),r=0;r<=o;r+=n)a=r.toFixed(2).replace(/\.?0*$/,"")+l,i.push([r,a]);return i}}function t(r){return function(e,t){return e.toFixed(2).replace(/\.?0*$/,"")+r}}function a(e,t=1){const r=getComputedStyle(document.documentElement);var e=r.getPropertyValue(e).trim();return t=t,e=(e=e).replace("#",""),`rgba(${(e=parseInt(e,16))>>16&255}, ${e>>8&255}, ${255&e}, ${t})`}function c(e){return e.name?e=e.name:"string"!=typeof e&&(e=e[0]),i[e]||[]}function S(e,t,r,a){for(var o,n=c(e),i=0,l=0;l<n.length&&n[l].o<1e3;++l)if(o=n[l].f(e,t,r,a)){if("stop"==o)return}else++i;return 0==n.length||i}function C(e){return"string"==typeof e||e.nodeType||e.jquery?{canvas:e}:e}function p(e,t,r){return t.dont_retry?$j.noop:function(){o(e,t,r)}}function l(e,t){t?G("<img>").attr("src",Mkiconf.images+"spinner.gif").appendTo(e).addClass("spinner").css({position:"absolute",top:"10px",right:"10px"}):G(e).find("img.spinner").remove()}function d(e){var t=G.extend({xaxis:{mode:"time",timezone:Mkiconf.tz_name||"browser"},yaxis:{min:0,ticks:s.tick_generators.bpsTickGenerator},lines:{show:!0,fill:!0},colors:Mkiconf.using_beta_colors?s.beta_line_color:[s.line_color,s.gold_line_color,s.green_line_color],points:{show:!1},bars:{show:!1},shadowSize:0},e);data=e.data||[];e=G(e.canvas);0<e.height()&&0<e.width()&&G.plot(e,data,t)}function o(e,t,r){var a,o,n,i,l;if(t=C(t),!(a=G(t.canvas)).length)return null;if(t.skip_invisible&&!a.is(":visible"))return null;if(r=r||0,o=a.width(),l=a.height(),(0==o||0==l)&&r<=10)return setTimeout(p(e,t,r+1),250),null;if((0==o||0==l)&&10<r)return null;if(l=G.extend({xaxis:{mode:"time",timezone:Mkiconf.tz_name||"browser"},yaxis:{min:0,ticks:s.tick_generators.bpsTickGenerator},lines:{show:!0,fill:!0,fillColor:s.fill_color},points:{show:!1},bars:{show:!1},shadowSize:0,canvasWidth:o,canvasHeight:l},t),!S(e,n=t.data||[],l,p(e,t)))return!1;for(void 0!==l.xaxis.min&&void 0!==l.xaxis.max&&void 0===l.xaxis.tickSize&&(l.xaxis.tickSize=s.time_ticksize(l.xaxis.min,l.xaxis.max,a,l.xaxis.minTickSize)),i=0;i<n.length;++i)n[i].data&&n[i].data.length||(n.splice(i,1),--i);return a.width(o),function(e,t){for(var r=c(e),a=0;a<r.length;++a)1e3<=r[a].o&&r[a].f(e,t)}(e,l=G.plot(a,n,l)),l}s.time_ticksize=function(e,t,r,a){for(var o=400,n=(o=(r=r&&"string"==typeof r?G(r):r)&&r.length?r.width()||400:o)/((t-e)/36e5),i=[[1e5,5,"second"],[3e4,10,"second"],[12e3,30,"second"],[6e3,2,"minute"],[1200,5,"minute"],[300,15,"minute"],[150,30,"minute"],[100,1,"hour"],[30,2,"hour"],[12.5,4,"hour"],[1.77,1,"day"],[.6,3,"day"],[.2,7,"day"],[-1/0,1,"month"]],l=0;;++l)if(n>=i[l][0]||l==i.length-1){tickSize=i[l].slice(1,3);break}return a?_.max([tickSize,a],function(e){return parse_time(e.join(" "),"s")}):tickSize},s.make_tick_generator=e,s.tick_generators={basicTickGenerator:e(""),intTickGenerator:e("",u,!0),bpsTickGenerator:r,bytesTickGenerator:function(e){for(var t,r=0,a=1,o="B",o=1099511627776<e.max?(r=g(e.max/(a=1099511627776)),"TB"):1073741824<e.max?(r=g(e.max/(a=1073741824)),"GB"):1048576<e.max?(r=g(e.max/(a=1048576)),"MB"):512<e.max?(a=1024,r=g(Math.max(e.max/a,1)),"KB"):(a=1,r=g(e.max),"B"),n=r/u,i=[],l=0;l<=r;l+=n)t=l.toFixed(2).replace(/\.?0*$/,"")+" "+o,i.push([l*a,t]);return i},msTickGenerator:e(" ms"),msTickGenerator3:e(" ms",3),rsrpTickGenerator:e(" dBm"),rsrqTickGenerator:e(" dB"),lossTickGenerator:e("%"),clientCountsTickGenerator:function(e,t){var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(n=new Date(e)).getUTCMonth()]+" "+n.getUTCDate(),a=1e3*(Mkijson.n.allmeta.t0||meta.t0),o=1e3*(Mkijson.main.meta.grapht1||Mkijson.main.meta.t1||Mkijson.n.allmeta.t1),n="";return e!=a&&e<a?n="<br>from "+(a=new Date(a)).getUTCHours()+":"+(a.getUTCMinutes()<=9?"0":"")+a.getUTCMinutes():e!=o&&o<e+864e5&&(n="<br>to "+(o=new Date(o)).getUTCHours()+":"+(o.getUTCMinutes()<=9?"0":"")+o.getUTCMinutes()),r+n}},s.tick_formatters={voltsTickFormatter:t(" V"),ampsTickFormatter:t(" A"),amphoursTickFormatter:t(" Ah"),degcTickFormatter:t("&deg;C")},s.line_color=a("--accent-a-default"),s.fill_color=a("--accent-a-default",.4),s.fill_color_transparent="rgba(222,231,236,0.5)",s.gold_line_color="rgb(180,161,126)",s.gold_fill_color="rgb(218,212,190)",s.gold_fill_color_transparent="rgba(218,212,190,0.6)",s.red_line_color="rgb(214,51,0)",s.green_line_color="rgb(29,119,11)",s.green_fill_color="rgb(200,218,209)",s.green_fill_color_transparent="rgba(200,218,209,0.5)",s.highlight_line_color={search:"rgb(210,214,0)",0:"rgb(210,214,0)",hover:"rgb(214,136,0)",1:"rgb(214,136,0)",check:"rgb(214,51,0)",2:"rgb(214,51,0)",length:3},s.highlight_fill_color={search:"rgba(234,236,151,0.5)",0:"rgba(234,236,151,0.5)",hover:"rgba(236,208,151,0.5)",1:"rgba(236,208,151,0.5)",check:"rgba(236,183,151,0.5)",2:"rgba(236,183,151,0.5)",length:3},s.beta_line_color=["rgb(20,110,170)","rgb(105,159,224)","rgb(220,210,100)"],s.beta_fill_color=["rgba(80,140,180,0.4)","rgba(188,217,232,0.4)","rgba(240,220,180,0.4)"],s.status_line_color=["rgb(76,173,0)","rgb(255,210,0)","rgb(255,0,0)","rgb(191,191,194)","rgb(191,191,194)","rgb(87,108,234)","rgb(246,147,60)","rgb(255,195,203)","rgb(166,124,189)"],s.status_fill_color=["rgba(76,173,0,0.5)","rgba(255,210,0,0.5)","rgba(255,0,0,0.5)","rgba(191,191,194,0.5)","rgba(191,191,194,0.5)","rgba(87,108,234,0.5)","rgba(246,147,60,0.5)","rgba(255,195,203,0.5)","rgba(166,124,189,0.5)"],s.add_plugin=function(e,t,r){var a,o=i[e];for(r=r||0,o||(i[e]=o=[]),a=o.length;0<a&&o[a-1].o>r;--a);o.splice(a,0,{f:t,o:r})},s.remove_plugins=function(e){i[e]=[]},s.map_color=function(e){return e.match(/^rgb/)?e:f[e]?f[e].c:"rgb(128,128,128)"};var h=0;function D(e,t){var r,a,o,n,i,l,s,c,u,g=0,p=e.length,d=null,_={};function h(e,t){var r=e.xgroup,a=t.xgroup;return e.is_catchall!=t.is_catchall?e.is_catchall?1:-1:r!=a?_[a]-_[r]||strcasecmp(r,a):e.is_group_catchall!=t.is_group_catchall?e.is_group_catchall?1:-1:t.value-e.value||strcasecmp(e.name,t.name)}for(r=p-1;0<=r;--r)g+=(o=e[r]).value,l=o.xgroup=t.grouped?o.group||o.name:"",_[l]=(_[l]||0)+o.value;if(e.sort(h),n=t.min_slice){for(n=g*n/360,r=p-1;0<=r&&!d;--r)e[r].is_catchall&&(d=G.extend({},e.splice(r,1)[0]),_[d.xgroup]-=d.value,--p);for(d=d||{name:"Other",xgroup:"",is_catchall:!0,value:0,rcvd:0,sent:0,color:"othergrey",rule_ids:[]},(i=t.max_catchall_slice)&&(i=g*i/360+d.value),r=p-1;0<=r&&(o=e[r],!(_[o.xgroup]>=n||d.value+_[o.xgroup]>=i));)for(l=o.xgroup;0<=r&&(o=e[r]).xgroup==l;)d.rule_ids.push.apply(d.rule_ids,o.rule_ids),d.value+=o.value,d.rcvd+=o.rcvd,d.sent+=o.sent,--r;for(d.value&&(e.splice(r+1,p-r-1,d),p=e.length,_[d.xgroup]=(_[d.xgroup]||0)+d.value),e.sort(h),r=p-1;0<=r;--r)if(!((o=e[r]).is_catchall||o.value>=n&&!o.is_group_catchall)){for(d=G.extend({},o),a=r-1;0<=a&&(o=e[a]).value<n&&o.xgroup==d.xgroup;)d.rule_ids.push.apply(d.rule_ids,o.rule_ids),d.color=o.color||d.color,d.value+=o.value,d.rcvd+=o.rcvd,d.sent+=o.sent,--a;r-a!=1&&(a<0||o.xgroup!=d.xgroup?d.name=d.group:d.is_group_catchall||(d.name="Other"),e.splice(a+1,r-a,d),p-=r-a-1,r=a+1)}}for(!function(e,t){for(var r,a,o,n,i,l,s,c,u=[],g=0;g<t;++g)r=e[g],a&&r.xgroup==a.xgroup||(a=r,u.push(a)),(o=r.color)&&(o=(n=f[o])?n.c:(n=G.color.parse(o))?n.toString():null,r.color=o),o&&!a.color&&(a.color=o);for(l=m.length,t=u.length,g=i=0;g<t;++g)if((r=u[g]).color)r.color==m[i%l].c&&++i;else{for(o=m[i%l].c,s=g-3;s<g+4;++s)0<=s&&s!=g&&(c=u[s])&&c.color==o&&(o=m[++i%l].c,s=g-4);r.color=o,++i}}(e,p),s=(c=2*Math.PI)+c/4,r=l=0;r<p;++r)(o=e[r]).angle2=s,o.angle1=s-=c*o.value/g,0!=r&&e[l].xgroup==o.xgroup||(l=r,u=o.color),o.color=G.color.interpolate("#fff",Math.min(.2*(r-l),.8),u).toString();return t.save_rule_color&&function(e,t){for(var r,a,o,n,i,l=(Mkiconf.counter_sets[t.csid]||{}).rules,s=t.save_rule_color,c=e.length-1;0<=c;--c)if((i=(a=e[c]).color)&&(o=a.rule_ids))for(r=o.length-1;0<=r;--r)(n=l[o[r]])&&(n[s]=i)}(e,t),t.save_catchall_rules&&function(e,t){for(var r,a=0;a<e.length;a++)(r=e[a]).is_catchall&&(Mkiconf.counter_sets[t.csid].catchall_rules=r.rule_ids)}(e,t),g}function O(s,c,u,g,p,d){return[function(){var e,t,r=[colored_bullet(c.color)+" "],a=2*Math.PI,o=Math.PI,n=a-o/2,i=c.angle1,l=c.angle2;c.group&&c.group!=c.name&&r.push(JSTemplate.escape(c.group),"&mdash;"),r.push("<b>",JSTemplate.escape(c.name),"</b><br />",unparse_size(1024*c.value,1,"B",!1),"&nbsp;(","<span title='Received/downloaded' style='font-size:.95em'>↓<span class='thinsp'></span>",unparse_size(1024*c.rcvd,1,"B",!1),"</span>,&nbsp;",'<span title="Sent/uploaded" style="font-size:.95em">↑<span class=\'thinsp\'></span>',unparse_size(1024*c.sent,1,"B",!1),"</span>)"),Mkiconf.is_acting_admin&&Mkijson.n.all.rusage_src&&(e=Mkiconf.user_dashboard_prefs.clients_rusage.csid,t=c.is_catchall?"catchall":c.rule_ids[0],r.push("<br/><span class='adminhighlight'>sourced from ",Mkijson.n.all.rusage_src[e][t]||"none","</span>")),e=a<l&&a-i<l-a||i<o&&l-o<o-i,t=l-i<=o/6?(i+l)/2:n<l&&i<n?Math.min(Math.max(n,i+o/12),l-o/12):(e?a<l:l<=n)?l-o/12:i+o/12,n={left:(a=G(s).offset()).left+u+(p-4)*Math.cos(t),top:a.top+g-(p-4)*Math.sin(t)},l={left:a.left+u+15*Math.cos((i+l)/2),top:a.top+g-15*Math.sin((i+l)/2)},n=e?[n,n,l,n]:[l,n,n,n],hohelp(this,r.join(""),{offset:n,above:e,atleft:4*o/5<t&&t<6*o/5,atright:9*o/5<t&&t<11*o/5,className:"notranslate"}),d.onhover&&d.onhover.call(this,c)},function(){hohelp(this),d.onhover&&d.onhover.call(this,null)}]}function j(e,r){var t,a,o,n,i,l,s,c,u,g,p,d,_,h,f,m,b,v,k,x,y,w,M,T=[],z=[];if(r=C(r),!S(e,T,d=G.extend({legend_size:3},r),(f=e,m=r,function(){j(f,m)})))return!0;if(g=D(T,r),Mkiconf.top_rules=Mkiconf.top_rules||{},Mkiconf.top_rules[r.csid]=[],G.each(T,function(e,t){t.is_catchall||G.each(t.rule_ids,function(e,t){Mkiconf.top_rules[r.csid].push(t)})}),Mkiconf.top_rules_sorted=Mkiconf.top_rules_sorted||{},Mkiconf.top_rules_sorted[r.csid]={sorted_by_sent:T.sort(function(e,t){return t.sent-e.sent}),sorted_by_received:T.sort(function(e,t){return t.rcvd-e.rcvd}),sorted_by_total:T.sort(function(e,t){return t.value-e.value})},e=G(r.canvas).html(""),t=Raphael(e.attr("id"),e.width(),e.width()),o=n=1+(a=Math.floor(e.width()/2)-1),0==T.length)t.circle(o,n,a).attr({fill:"#eee"});else if(1==T.length)z[0]=t.circle(o,n,a).attr({fill:T[0].color});else for(i=T.length-1;0<=i;--i)z[i]=t.path((b=T[i],v=o,k=n,x=a,M=w=y=void 0,y=Math.cos,w=Math.sin,M=b.angle1,b=b.angle2,["M",v,k,"L",v+x*y(M),k-x*w(M),"A",x,x,0,+(b-M>=Math.PI),0,v+x*y(b),k-x*w(b),"z"])).attr({fill:T[i].color,stroke:"#fff"});if(t.circle(o,n,a-.5).attr({stroke:"#545454","stroke-width":1.75}),d.legend_cont&&T.length){for(p=[],i=l=0;l<d.legend_size&&i<T.length;++l){for(slice=T[i],s=Raphael.getRGB(slice.color).hex,_=slice.group||slice.name,h=slice.value,++i;i<T.length&&((slice=T[i]).group||slice.name)==_;++i)h+=slice.value;_=_.replace(/\s+\(.*\)\s*$/,""),p.push("<tr class='base'><td style='white-space:nowrap'>",colored_bullet(s)," </td><td style='padding:0 0.5em 0 0'>",JSTemplate.escape(_),"</td><td style='text-align:right;white-space:nowrap'>",unparse_fraction_as_percent(h,g),"</td></tr>")}G(d.legend_cont).html("<table style='width:100%' class='lean'><col width='0*' /><col /><col width='0*' />"+p.join("")+"</table>")}else d.legend_cont&&G(d.legend_cont).html("");if(d.hover&&T.length)for(i=0;i<z.length;++i)c=O(r.canvas,T[i],o,n,a,r),z[i].mouseover(c[0]).mouseout(c[1]);if(u=d.click)for(i=0;i<z.length;++i)z[i].click(u).attr("cursor","pointer");return T}return s.random_color=function(){return m[h++%m.length].c},f={lblue:{c:"rgb(173,212,235)",o:0},lred:{c:"rgb(240,139,128)",o:1},lgreen:{c:"rgb(162,230,170)",o:2},lyellow:{c:"rgb(251,237,157)",o:3},lpurple:{c:"rgb(229,173,235)",o:4},mtan:{c:"rgb(216,162,126)",o:5},laqua:{c:"rgb(144,236,220)",o:6},mblue:{c:"rgb(111,140,219)",o:7},lpink:{c:"rgb(249,203,203)",o:8},mpurple:{c:"rgb(208,108,197)",o:9},mgreen:{c:"rgb(105,185,63)",o:10},othergrey:{c:"rgb(190,190,198)"}},function(){var e,t;for(e in m=[],f)null!=(t=f[e].o)&&(m[t]=f[e])}(),s.loading_graph=function(e){var t=r({min:0,max:1363148.8});d(G.extend({xaxis:{mode:"time",timezone:Mkiconf.tz_name||"browser",ticks:[0],min:-1,max:-1},yaxis:{min:0,ticks:t},data:[[[0,0]]]},e)),e.no_spinner||l(e.canvas,!0)},s.toggle_spinner=l,s.simple_timeseries=d,s.async_timeseries=function(a){var o,n={};function i(){var t=[],r=!1;_.each(o,function(e){e.data&&(e.data.done?r=!0:0<e.data.length&&t.push(e))});var e=_.extend({data:t},a);d(e),l(a.canvas,r),a.on_render&&a.on_render.call(n,e,r)}return n.data=function(r){o=r,_.each(r,function(t){t.data&&t.data.done&&t.data.done(function(e){t.data=e,o===r&&i()})}),i()},n},s.timeseries=o,s.piechart=j,s.stats_graph=function(e,t,r){var a,o=t.options;if(G(e).length){o.xaxis.hasOwnProperty("timezone")||(o.xaxis.timezone=Mkiconf.tz_name||"browser"),(a=o.yaxis.tickFormatter)&&(o.yaxis.tickFormatter=s.tick_formatters[a]),"string"==typeof o.yaxis.ticks&&(o.yaxis.ticks=s.tick_generators[o.yaxis.ticks]),r&&r.upseries&&(o.grid=_.extend({},o.grid,G(e).outage_graph(r,{background:!0})));try{"multiSeries"in o&&o.multiSeries?G.plot(G(e),t.data,o):G.plot(G(e),[t.data],o)}catch(e){window.console&&window.console.log&&window.console.log(e)}}},s}(window.jQuery);function graph_stats(e){var t,r="";for(t in e.id&&(r="_"+e.id),e)e.hasOwnProperty(t)&&e[t]&&e[t].options&&mkigraph.stats_graph("#"+t+"_graph_canvas"+r,e[t],e);e.upseries&&$j("#outage_graph_canvas"+r).outage_graph(e)}!function(i){function l(e,t,r,a){var o="";return e<=r?o+=" (ending <var date>"+unparse_date(t/1e3,"%b %-d %H:%M",1)+"</var>)":a<=t?o+=" (starting <var date>"+unparse_date(e/1e3,"%b %-d %H:%M",1)+"</var>)":(r=unparse_date(e/1e3,"%b %-d %H:%M",1),a=unparse_date(t/1e3,"%b %-d %H:%M",1),t-e<864e5&&(x=a.lastIndexOf(" "),r.substring(0,x)==a.substring(0,x)&&(a=a.substring(x+1))),o+=" (<var start_date>"+r+"</var>&ndash;<var end_date>"+a+"</var>)"),o}window.OutageGraph={},OutageGraph.color_map={0:"mki_red",1:"mki_light_green",2:"mki_light_green",3:"mki_orange",4:"mki_dark_green",5:"mki_yellow",6:"mki_orange",7:"mki_yellow",8:"mki_yellow",9:"mki_orange",10:"mki_dark_green",11:"mki_light_gray",12:"mki_dark_gray",13:"mki_red",14:"mki_red",15:"mki_yellow",16:"mki_light_gray",17:"mki_yellow",18:"mki_yellow",19:"mki_red",20:"mki_red",22:"mki_yellow",23:"mki_red",24:"mki_red"},OutageGraph.priority=[0,13,14,19,20,23,24,3,6,9,5,7,8,15,17,18,22],OutageGraph.status={0:"No connectivity",1:"Connected",2:"Connected repeater",3:"Disabled repeater (unable to mesh to a working gateway)",4:"Connected gateway",5:"Disabled gateway (bad connectivity)",6:"Repeater looking for gateway",7:"Gateway warning (IP address conflict on uplink)",8:"Gateway warning (bad connectivity to Dashboard, possible firewall or NAT issue)",9:"Repeater warning (bad connectivity to Dashboard, possible firewall or NAT issue)",10:"Full connectivity",11:"Disconnected",12:"Disassociated",13:"DHCP failure",14:"No Internet connectivity",15:"DNS failure",16:"Client suspended",17:"Disabled gateway (bad IP assignment)",18:"Disabled gateway (bad DNS)",19:"Reboot (Lost power)",20:"Reboot (Firmware upgrade)",22:"DHCP failure on management VLAN",23:"Planned reboot",24:"Unplanned reboot"},window.getTimeRangeText=l,i.fn.outage_graph=function(e,a){(a=_.extend({},a)).colorMap&&(OutageGraph.color_map=a.colorMap),a.priorityMap&&(OutageGraph.priority=a.priorityMap),a.statusMap&&(OutageGraph.status=a.statusMap);var o=e.t0||1e3*Mkiconf.t0,n=e.t1||1e3*Mkiconf.t1;return this.fill_graph(_.extend(a,{t0:o,t1:n,default_state:11,color_map:OutageGraph.color_map,combine_colors:!1,hover:function(e){var t=i(this).offset();t.left+=Math.max(e.midpoint,0)+e.offset.left;var r=OutageGraph.status[e.item[1]]||"Offline";"string"==typeof a.connected_noun&&(r=a.textReplace&&"function"==typeof a.textReplace?a.textReplace(r):r.replace("gateway",a.connected_noun)),r+=l(e.start,e.end,o,n),i(this).hohelp(r,{offset:t,nostack:!0,above:!0})},priority:OutageGraph.priority,data:e[a.data_field]||e.upseries||[]}))}}(jQuery);